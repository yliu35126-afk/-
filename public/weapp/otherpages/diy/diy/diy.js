(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["otherpages/diy/diy/diy"],{"0bd0":function(t,e,n){"use strict";(function(t){var i=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n("2eee")),a=i(n("c973")),r=i(n("7c6e")),s=(n("77ef"),i(n("0f13"))),u=t.getSystemInfoSync(),c={components:{uniPopup:function(){n.e("components/uni-popup/uni-popup").then(function(){return resolve(n("9ecd"))}.bind(null,n)).catch(n.oe)},diyBottomNav:function(){n.e("components/diy-bottom-nav/diy-bottom-nav").then(function(){return resolve(n("8627"))}.bind(null,n)).catch(n.oe)},nsNavbar:function(){n.e("components/ns-navbar/ns-navbar").then(function(){return resolve(n("456e"))}.bind(null,n)).catch(n.oe)},diyIndexPage:function(){n.e("components/diy-index-page/diy-index-page").then(function(){return resolve(n("9aea"))}.bind(null,n)).catch(n.oe)},diyGroup:function(){n.e("components/diy-group/diy-group").then(function(){return resolve(n("c3ea"))}.bind(null,n)).catch(n.oe)},nsCopyRight:function(){n.e("components/ns-copyright/ns-copyright").then(function(){return resolve(n("0415"))}.bind(null,n)).catch(n.oe)}},data:function(){return{diyData:{global:{title:"",popWindow:{imageUrl:"",count:-1,link:{}}}},navTitle:"",webSiteInfo:null,memberId:0,name:"",city:"",city_first:0,siteId:0,isIphoneX:!1,pageHeight:"0",headerHeight:"0",bottomHeight:"0",topIndexValue:null,statusBarHeight:u.statusBarHeight,collectTop:44,showTip:!1,mpCollect:!1,websiteInfoStatus:1,isChangeCity:0}},mixins:[s.default],computed:{top:function(){var t=0;return t=this.isIphoneX?180:140,t},bgColor:function(){var t="";return this.diyData&&this.diyData.global&&(t=this.diyData.global.bgColor),t},bgImg:function(){var t="";return this.diyData&&this.diyData.global&&(t=this.diyData.global.topNavbg?"url("+this.$util.img(this.diyData.global.bgUrl)+")":this.diyData.global.bgColor),t},bgUrl:function(){var t="";return this.diyData&&this.diyData.global&&(t=this.diyData.global.topNavbg?"transparent":this.diyData.global.bgUrl),t},bgNav:function(){return this.diyData.global.topNavColor?{background:this.diyData.global.topNavColor}:{background:"#ffffff"}},backgroundUrl:function(){var t=this.bgUrl?"background:url("+this.$util.img(this.bgUrl)+") no-repeat 0 0/100%":"";return t},scrollHeight:function(){return void 0!=this.pageHeight&&void 0!=this.headerHeight&&void 0!=this.bottomHeight?"calc("+this.pageHeight+"px - "+this.headerHeight+" - "+this.bottomHeight+")":"100vh"},scrollTopHeight:function(){return void 0!=this.pageHeight&&void 0!=this.headerHeight&&void 0!=this.bottomHeight?"calc("+this.pageHeight+"px - "+this.headerHeight+" - "+this.bottomHeight+" - 80rpx)":"100vh"},textNavColor:function(){return this.diyData.global.textNavColor?this.diyData.global.textNavColor:"#ffffff"},openBottomNav:function(){var t=!1;return this.diyData&&this.diyData.global&&(t=this.diyData.global.openBottomNav),t},minHeight:function(){return void 0!=this.pageHeight&&void 0!=this.headerHeight&&void 0!=this.bottomHeight?"calc(100vh - "+this.headerHeight+" - "+this.bottomHeight+" - 80rpx)":"100vh"},globalS:function(){return this.diyData.global}},onPullDownRefresh:function(){var t=this;return(0,a.default)(o.default.mark((function e(){return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getDiyInfo();case 2:case"end":return e.stop()}}),e)})))()},onLoad:function(e){var n=this;return(0,a.default)(o.default.mark((function i(){var a;return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(t.hideTabBar(),n.name=e.name||"",n.siteId=e.site_id||0,n.isIphoneX=n.$util.uniappIsIPhoneX(),"DIY_VIEW_CITY_INDEX"==n.name&&n.siteId&&!n.city_first&&n.getCityId(n.siteId),n.name?(e.suid&&t.setStorageSync("suid",e.suid),e.scene&&(a=decodeURIComponent(e.scene),a=a.split("&"),a.length&&a.forEach((function(e){-1!=e.indexOf("suid")&&t.setStorageSync("suid",e.split("-")[1])})))):n.$util.redirectTo("/pages/index/index/index",{},"reLaunch"),"DIY_VIEW_CITY_INDEX"!=n.name){i.next=9;break}return i.next=9,n.refresh();case 9:case"end":return i.stop()}}),i)})))()},onHide:function(){this.$store.commit("setDiySeckillInterval",null),this.isChangeCity=0},onShow:function(){var e=this;return(0,a.default)(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("DIY_VIEW_CITY_INDEX"!=e.name||!e.city_first){n.next=6;break}return n.next=3,e.refresh();case 3:t.getStorageSync("websiteInfoStatus")&&(e.websiteInfoStatus=t.getStorageSync("websiteInfoStatus")),n.next=9;break;case 6:if("DIY_VIEW_CITY_INDEX"==e.name){n.next=9;break}return n.next=9,e.refresh();case 9:e.getHeight(),e.$store.commit("setDiySeckillInterval",1);case 11:case"end":return n.stop()}}),n)})))()},onPageScroll:function(t){this.$refs.topNav&&(t.scrollTop>=20?this.$refs.topNav.navTopBg():this.$refs.topNav.unSetnavTopBg())},onUnload:function(){},methods:{getCityId:function(t){var e=this;this.$api.sendRequest({url:"/api/website/getWebsiteInfo",data:{site_id:t},success:function(t){t.code>=0&&e.selectCity({id:t.data.site_area_id})}})},selectCity:function(e){var n=this;return(0,a.default)(o.default.mark((function i(){return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:n.$api.sendRequest({url:"/api/website/getWebsiteidByAddress",data:{web_city:e.id},success:function(){var e=(0,a.default)(o.default.mark((function e(i){return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(i.code>=0)){e.next=12;break}if(!i.data){e.next=10;break}return t.setStorage({key:"city",data:{id:i.data.site_area_id,title:i.data.site_area_name},success:function(){}}),t.setStorage({key:"website_id",data:i.data.site_id,success:function(){}}),e.next=6,n.refresh();case 6:n.city_first=1,n.websiteInfoStatus=i.data.status,e.next=12;break;case 10:n.$util.showToast({title:"该城市暂无站点，即将切换成全国"}),setTimeout((function(){t.setStorage({key:"city",data:{id:0,title:"全国"},success:function(){n.$util.goBack()}}),t.setStorage({key:"website_id",data:0,success:function(){}})}),1500);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 1:case"end":return i.stop()}}),i)})))()},refresh:function(){var e=this;return(0,a.default)(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.$langConfig.refresh(),t.getStorageSync("token")&&e.getMemberId(),e.siteId=t.getStorageSync("website_id")||0,0==e.siteId?"DIY_VIEW_CITY_INDEX"==e.name?e.name="DIY_VIEW_INDEX":e.name=e.name:e.name="DIY_VIEW_CITY_INDEX",e.$store.dispatch("defaultImg"),e.$store.dispatch("getThemeStyle"),e.getWebSitefo(),t.getStorageSync("city")?e.city=t.getStorageSync("city").title:(t.setStorageSync("city",{id:0,title:"全国"}),e.city="全国",e.getLocation()),n.next=10,e.getDiyInfo();case 10:case"end":return n.stop()}}),n)})))()},getHeight:function(){var e=this;t.getSystemInfo({success:function(t){e.pageHeight=t.screenHeight}}),this.$nextTick((function(){var n=t.createSelectorQuery().in(e);n.select(".page-header").boundingClientRect((function(t){e.headerHeight=t.height+"px"})).exec()})),this.$nextTick((function(){var n=t.createSelectorQuery().in(e);n.select(".page-bottom").boundingClientRect((function(t){e.bottomHeight="55px"})).exec()}))},getDiyInfo:function(){var e=this;return(0,a.default)(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$api.sendRequest({url:"/api/diyview/info",data:{name:e.name,website_id:e.siteId},async:!0,success:function(n){if(0!=n.code||!n.data)return e.$refs.loadingCover&&e.$refs.loadingCover.hide(),void(e.diyData={});var i=n.data;if(i.value=i.value.replace(/\@/g,"'"),i.value){e.diyData=JSON.parse(i.value),e.isChangeCity=1,e.$langConfig.title(e.diyData.global.title),e.navTitle=e.diyData.global.title,e.mpCollect=e.diyData.global.mpCollect,e.diyData.global.popWindow&&e.diyData.global.popWindow.imageUrl&&setTimeout((function(){if(1==e.diyData.global.popWindow.count){var n=t.getStorageSync("diy_popwindow_count");(e.$refs.uniPopupWindow&&""==n||e.$refs.uniPopupWindow&&1==n)&&(e.$refs.uniPopupWindow.open(),t.setStorageSync("diy_popwindow_count",1))}else 0==e.diyData.global.popWindow.count&&(e.$refs.uniPopupWindow.open(),t.setStorageSync("diy_popwindow_count",0))}),500);for(var o=0;o<e.diyData.value.length;o++)"TopCategory"==e.diyData.value[o].controller&&(e.topIndexValue=e.diyData.value[o]);!t.getStorageSync("isCollect")&&e.diyData.global.mpCollect&&(e.$refs.collectPopupWindow.open(),e.showTip=!0)}t.stopPullDownRefresh(),e.$refs.loadingCover&&e.$refs.loadingCover.hide()},fail:function(n){t.stopPullDownRefresh(),e.$refs.loadingCover&&e.$refs.loadingCover.hide()}});case 1:case"end":return n.stop()}}),n)})))()},closePopupWindow:function(){this.$refs.uniPopupWindow.close(),t.setStorageSync("diy_popwindow_count",-1)},closeCollectPopupWindow:function(){this.$refs.collectPopupWindow.close(),t.setStorageSync("isCollect",!0)},redirectTo:function(t){this.$util.diyRedirectTo(t)},getMemberId:function(){var t=this;this.$api.sendRequest({url:"/api/member/id",success:function(e){e.code>=0&&(t.memberId=e.data)}})},getWebSitefo:function(){var e=this;this.webSiteInfo=t.getStorageSync("web_site_info"),this.webSiteInfo&&(this.webSiteInfo=JSON.parse(this.webSiteInfo)),this.$api.sendRequest({url:"/api/website/info",success:function(n){var i=n.data;if(i){if(e.webSiteInfo=i,e.webSiteInfo.wap_status)return;e.$refs.uniPopupClose.open(),t.setStorageSync("web_site_info",JSON.stringify(e.webSiteInfo))}}})},getLocation:function(){var e=this,n=new r.default({key:this.$config.mpKey});t.getLocation({type:"gcj02",success:function(i){n.reverseGeocoder({location:{latitude:i.latitude,longitude:i.longitude},success:function(n){e.$api.sendRequest({url:"/api/address/citybyname",data:{city:n.result.address_component.city},success:function(n){n.data&&(e.city=n.data.title,t.setStorageSync("city",n.data))}})},fail:function(t){}})}})},onShareTimeline:function(){var t="";return this.memberId&&(t="suid="+this.memberId),{title:"",query:t,imageUrl:""}}},onShareAppMessage:function(t){var e="";this.webSiteInfo&&(e=this.webSiteInfo.title);var n="/otherpages/diy/diy/diy?name="+this.name;return this.memberId&&(n+="&suid="+this.memberId),{title:e,path:n,success:function(t){},fail:function(t){}}},onReady:function(){}};e.default=c}).call(this,n("543d")["default"])},2495:function(t,e,n){"use strict";n.r(e);var i=n("5c2a"),o=n("83ad");for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("ef66"),n("b342");var r=n("f0c5"),s=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"31675674",null,!1,i["a"],void 0);e["default"]=s.exports},"57c0":function(t,e,n){"use strict";(function(t,e){var i=n("4ea4");n("3a80");i(n("66fd"));var o=i(n("2495"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"5c2a":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}));var i={nsNavbar:function(){return n.e("components/ns-navbar/ns-navbar").then(n.bind(null,"456e"))},diyIndexPage:function(){return n.e("components/diy-index-page/diy-index-page").then(n.bind(null,"9aea"))},diyGroup:function(){return n.e("components/diy-group/diy-group").then(n.bind(null,"c3ea"))},nsCopyright:function(){return n.e("components/ns-copyright/ns-copyright").then(n.bind(null,"0415"))},uniPopup:function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"9ecd"))},diyBottomNav:function(){return n.e("components/diy-bottom-nav/diy-bottom-nav").then(n.bind(null,"8627"))},loadingCover:function(){return n.e("components/loading-cover/loading-cover").then(n.bind(null,"5203"))}},o=function(){var t=this.$createElement,e=(this._self._c,this.$util.img(this.diyData.global.popWindow.imageUrl)),n=this.showTip?this.$util.img("/upload/uniapp/collect2.png"):null;this.$mp.data=Object.assign({},{$root:{g0:e,g1:n}})},a=[]},"83ad":function(t,e,n){"use strict";n.r(e);var i=n("0bd0"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},"8a98":function(t,e,n){},b342:function(t,e,n){"use strict";var i=n("ebb2"),o=n.n(i);o.a},ebb2:function(t,e,n){},ef66:function(t,e,n){"use strict";var i=n("8a98"),o=n.n(i);o.a}},[["57c0","common/runtime","common/vendor"]]]);