(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/diy-coupon/diy-coupon"],{"0c4c":function(t,o,e){"use strict";var n=e("0edc"),i=e.n(n);i.a},"0edc":function(t,o,e){},"63a33":function(t,o,e){"use strict";e.d(o,"b",(function(){return i})),e.d(o,"c",(function(){return u})),e.d(o,"a",(function(){return n}));var n={nsLogin:function(){return Promise.all([e.e("common/vendor"),e.e("components/ns-login/ns-login")]).then(e.bind(null,"3584"))}},i=function(){var t=this,o=t.$createElement,e=(t._self._c,t.computedCouponList.length),n=e>0&&"1"==t.value.style?t.__map(t.computedCouponList,(function(o,e){var n=t.__get_orig(o),i=t.$util.img("/upload/uniapp/coupon/style1-bg.png"),u=o.discount&&"0.00"!=o.discount?null:Number(o.money),s=o.discount&&"0.00"!=o.discount?Number(o.discount):null,c=o.at_least>0?Number(o.at_least):null;return{$orig:n,g1:i,m0:u,m1:s,m2:c}})):null,i=e>0&&"2"==t.value.style?t.__map(t.computedCouponList,(function(o,e){var n=t.__get_orig(o),i=t.$util.img("/upload/uniapp/coupon/"+t.themeStyleScore+"_coupon.png"),u=o.discount&&"0.00"!=o.discount?null:Number(o.money),s=o.discount&&"0.00"!=o.discount?Number(o.discount):null,c=o.at_least>0?Number(o.at_least):null;return{$orig:n,g2:i,m3:u,m4:s,m5:c}})):null,u=e>0&&"3"==t.value.style?t.__map(t.computedCouponList,(function(o,e){var n=t.__get_orig(o),i=t.$util.img("/upload/uniapp/coupon/coupon_shu.png"),u=o.discount&&"0.00"!=o.discount?null:Number(o.money),s=o.discount&&"0.00"!=o.discount?Number(o.discount):null,c=o.at_least>0?Number(o.at_least):null;return{$orig:n,g3:i,m6:u,m7:s,m8:c}})):null;t.$mp.data=Object.assign({},{$root:{g0:e,l0:n,l1:i,l2:u}})},u=[]},"7f69":function(t,o,e){"use strict";e.r(o);var n=e("63a33"),i=e("aa1e");for(var u in i)["default"].indexOf(u)<0&&function(t){e.d(o,t,(function(){return i[t]}))}(u);e("0c4c"),e("b553");var s=e("f0c5"),c=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"257be914",null,!1,n["a"],void 0);o["default"]=c.exports},aa1e:function(t,o,e){"use strict";e.r(o);var n=e("eeba"),i=e.n(n);for(var u in n)["default"].indexOf(u)<0&&function(t){e.d(o,t,(function(){return n[t]}))}(u);o["default"]=i.a},b553:function(t,o,e){"use strict";var n=e("f55d"),i=e.n(n);i.a},eeba:function(t,o,e){"use strict";(function(t){var n=e("4ea4");Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=n(e("0f13")),u={name:"diy-coupon",props:{value:{type:Object,default:function(){return{}}},siteId:{type:[Number,String],default:0}},mixins:[i.default],data:function(){return{token:"",couponList:[],isHave:!0,couponBtnSwitch:!1,couponTab:1}},created:function(){this.getCanReceiveCouponQuery()},computed:{computedCouponList:function(){var t=[];return this.couponList.filter((function(o){o.count!=o.lead_count&&t.push(o)})),t}},methods:{couponTap:function(t,o){t.count!=t.lead_count?0==t.useState?this.receiveCoupon(t,o):this.toGoodList(t):this.$util.showToast({title:"该优惠券已抢光"})},getCanReceiveCouponQuery:function(){var t,o=this;this.couponTab=this.siteId?0:1,t=0==this.couponTab?"/coupon/api/coupon/typepagelists":"/platformcoupon/api/platformcoupon/typepagelists";"diy"==this.value.sources&&(0,this.value.couponIds&&this.value.couponIds.split(",")),this.$api.sendRequest({url:t,data:{page:1,page_size:10,site_id:this.siteId,coupon_type_id_arr:this.value.couponIds},success:function(t){var e=t.data;null!=e&&(o.couponList=e.list,o.couponList.forEach((function(t){t.useState=0})))}})},receiveCoupon:function(o,e){var n=this;if(!this.couponBtnSwitch){this.couponBtnSwitch=!0;var i=t.getStorageSync("token");if(""!=i){var u,s={site_id:o.site_id,get_type:2};0==this.couponTab?(u="/coupon/api/coupon/receive",s.coupon_type_id=o.coupon_type_id):(u="/platformcoupon/api/platformcoupon/receive",s.platformcoupon_type_id=o.platformcoupon_type_id),this.$api.sendRequest({url:u,data:s,success:function(t){t.data;var e=t.message;0==t.code&&(e="领取成功");var i=n.couponList;if(0==n.couponTab)if(1==t.data.is_exist)for(var u=0;u<i.length;u++)i[u].coupon_type_id==o.coupon_type_id&&(i[u].useState=1);else for(var s=0;s<i.length;s++)i[s].coupon_type_id==o.coupon_type_id&&(i[s].useState=2);else if(1==t.data.is_exist)for(var c=0;c<i.length;c++)i[c].platformcoupon_type_id==o.platformcoupon_type_id&&(i[c].useState=1);else for(var a=0;a<i.length;a++)i[a].platformcoupon_type_id==o.platformcoupon_type_id&&(i[a].useState=2);n.$util.showToast({title:e}),n.couponBtnSwitch=!1,n.$forceUpdate()},fail:function(t){n.couponBtnSwitch=!1}})}else this.couponBtnSwitch=!1,this.$util.redirectTo("/pages/login/login/login")}},toGoodList:function(t){0==this.couponTab?1!=t.goods_type?this.$util.redirectTo("/otherpages/shop/list/list",{couponId:t.coupon_type_id,site_id:t.site_id}):this.$util.redirectTo("/otherpages/shop/list/list",{site_id:t.site_id}):1!=t.use_scenario?this.$util.redirectTo("/pages/goods/list/list",{platformcouponTypeId:t.platformcoupon_type_id}):this.$util.redirectTo("/pages/goods/list/list",{})}}};o.default=u}).call(this,e("543d")["default"])},f55d:function(t,o,e){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/diy-coupon/diy-coupon-create-component',
    {
        'components/diy-coupon/diy-coupon-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("7f69"))
        })
    },
    [['components/diy-coupon/diy-coupon-create-component']]
]);
