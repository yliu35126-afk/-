(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["promotionpages/wholesale/detail/detail","components/ns-goods-sku/ns-goods-sku"],{"00f8":function(t,e,i){"use strict";var o=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;o(i("06cf"));var s=o(i("3a8a")),n=o(i("8f49")),a=o(i("0f13")),u={components:{nsGoodsAction:function(){i.e("components/ns-goods-action/ns-goods-action").then(function(){return resolve(i("31e9"))}.bind(null,i)).catch(i.oe)},nsGoodsActionIcon:function(){i.e("components/ns-goods-action-icon/ns-goods-action-icon").then(function(){return resolve(i("3197"))}.bind(null,i)).catch(i.oe)},nsGoodsActionButton:function(){i.e("components/ns-goods-action-button/ns-goods-action-button").then(function(){return resolve(i("05d3"))}.bind(null,i)).catch(i.oe)},uniPopup:function(){i.e("components/uni-popup/uni-popup").then(function(){return resolve(i("9ecd"))}.bind(null,i)).catch(i.oe)},nsGoodsRecommend:function(){i.e("components/ns-goods-recommend/ns-goods-recommend").then(function(){return resolve(i("63b7"))}.bind(null,i)).catch(i.oe)},uniCountDown:function(){i.e("components/uni-count-down/uni-count-down").then(function(){return resolve(i("e48e"))}.bind(null,i)).catch(i.oe)},toTop:function(){i.e("components/toTop/toTop").then(function(){return resolve(i("be3c"))}.bind(null,i)).catch(i.oe)},uParse:function(){Promise.all([i.e("common/vendor"),i.e("components/u-parse/u-parse")]).then(function(){return resolve(i("8e04"))}.bind(null,i)).catch(i.oe)}},data:function(){return{kefuConfig:{weapp:"",system:"",open:"",open_url:""}}},mixins:[s.default,n.default,a.default],onShareAppMessage:function(t){var e="/promotionpages/wholesale/detail/detail?goods_id="+this.goodsId;return this.memberId&&(e+="&suid="+this.memberId),{title:this.goodsSkuDetail.sku_name,imageUrl:this.$util.img(this.goodsSkuDetail.sku_image,{size:"big"}),path:e,success:function(t){},fail:function(t){}}},onShareTimeline:function(){var t="goods_id="+this.goodsId;return this.memberId&&(t+="&suid="+this.memberId),{title:this.goodsSkuDetail.sku_name,query:t,imageUrl:this.$util.img(this.goodsSkuDetail.sku_image,{size:"big"})}}};e.default=u},"0539":function(t,e,i){"use strict";i.r(e);var o=i("e6f7"),s=i("9e13");for(var n in s)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(n);i("0df9"),i("6fb0");var a=i("f0c5"),u=Object(a["a"])(s["default"],o["b"],o["c"],!1,null,"a1339c16",null,!1,o["a"],void 0);e["default"]=u.exports},"06cf":function(t,e,i){"use strict";i.r(e);var o=i("883a"),s=i("7ec6");for(var n in s)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(n);i("6ee5"),i("5e36");var a=i("f0c5"),u=Object(a["a"])(s["default"],o["b"],o["c"],!1,null,"3358e1f8",null,!1,o["a"],void 0);e["default"]=u.exports},"0df9":function(t,e,i){"use strict";var o=i("6f8c"),s=i.n(o);s.a},3550:function(t,e,i){"use strict";(function(t,e){var o=i("4ea4");i("3a80");o(i("66fd"));var s=o(i("0539"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(s.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},"5e36":function(t,e,i){"use strict";var o=i("e723"),s=i.n(o);s.a},"6ee5":function(t,e,i){"use strict";var o=i("a8ff"),s=i.n(o);s.a},"6f8c":function(t,e,i){},"6fb0":function(t,e,i){"use strict";var o=i("d0d0"),s=i.n(o);s.a},"7ec6":function(t,e,i){"use strict";i.r(e);var o=i("b527"),s=i.n(o);for(var n in o)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(n);e["default"]=s.a},"883a":function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return o}));var o={uniPopup:function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"9ecd"))},nsLogin:function(){return Promise.all([i.e("common/vendor"),i.e("components/ns-login/ns-login")]).then(i.bind(null,"3584"))}},s=function(){var t=this,e=t.$createElement,i=(t._self._c,"point"==t.type&&t.goodsDetail.type&&1!=t.goodsDetail.type&&2==t.goodsDetail.type&&t.goodsDetail.image?t.$util.img(t.goodsDetail.image):null),o="point"==t.type&&t.goodsDetail.type&&1!=t.goodsDetail.type&&2==t.goodsDetail.type&&!t.goodsDetail.image?t.$util.img("upload/uniapp/point/coupon.png"):null,s="point"==t.type&&t.goodsDetail.type&&1!=t.goodsDetail.type&&3==t.goodsDetail.type&&t.goodsDetail.image?t.$util.img(t.goodsDetail.image):null,n="point"==t.type&&t.goodsDetail.type&&1!=t.goodsDetail.type&&3==t.goodsDetail.type&&!t.goodsDetail.image?t.$util.img("upload/uniapp/point/hongbao.png"):null,a="point"==t.type&&t.goodsDetail.type&&1!=t.goodsDetail.type?null:t.$util.img(t.goodsDetail.sku_image,{size:"mid"}),u="point"==t.type&&1==t.goodsDetail.type&&"0.00"!=t.goodsDetail.exchange_price&&t.goodsDetail.pay_type>0?t.$lang("common.currencySymbol"):null,d=t.__map(t.goodsDetail.goods_spec_format,(function(e,i){var o=t.__get_orig(e),s=t.__map(e.value,(function(e,i){var o=t.__get_orig(e),s=e.image?t.$util.img(e.image,{size:"small"}):null;return{$orig:o,g5:s}}));return{$orig:o,l0:s}}));t.$mp.data=Object.assign({},{$root:{g0:i,g1:o,g2:s,g3:n,g4:a,m0:u,l1:d}})},n=[]},"9e13":function(t,e,i){"use strict";i.r(e);var o=i("00f8"),s=i.n(o);for(var n in o)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(n);e["default"]=s.a},a8ff:function(t,e,i){},b527:function(t,e,i){"use strict";(function(t){var o=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;o(i("16e3"));var s={name:"ns-goods-sku",components:{uniPopup:function(){i.e("components/uni-popup/uni-popup-sku").then(function(){return resolve(i("bb3a"))}.bind(null,i)).catch(i.oe)}},props:{goodsDetail:{type:Object,default:null},disabled:{type:Boolean,default:!1},pointLimit:{type:[Number,String]},maxBuy:{type:Number,default:0},minBuy:{type:Number,default:0},isFirstBuy:{type:Number,default:0}},data:function(){return{isIphoneX:!1,systemInfo:{},number:1,btnSwitch:!1,type:"",callback:null,skuId:0,pintuanId:0,limitNumber:0,minNumber:0,preview:0,cartNumber:0}},created:function(){this.isIphoneX=this.$util.uniappIsIPhoneX(),this.systemInfo=t.getSystemInfoSync()},watch:{pointLimit:function(t,e){this.limitNumber=Number(t)},goodsDetail:function(t,e){this.skuId=t.sku_id,this.keyInput(!1)},minBuy:function(t,e){this.minBuy>1&&(this.number=Number(this.minBuy))}},computed:{balance:function(){var t=this.goodsDetail.member_price&&this.goodsDetail.member_price>0?this.goodsDetail.member_price:this.goodsDetail.price,e=parseFloat(t)-parseFloat(this.goodsDetail.presale_price);return e=e<0?0:e,e.toFixed(2)}},methods:{show:function(t,e){this.callback=e,this.$refs.skuPopup.open(e),this.type=t,this.skuId=this.goodsDetail.sku_id,this.preview=this.goodsDetail.preview||0,"pintuan"==this.type&&this.goodsDetail.pintuan_id?this.limitNumber=this.goodsDetail.buy_num:"groupbuy"==this.type&&this.goodsDetail.groupbuy_id?(this.number=this.goodsDetail.buy_num,this.minNumber=this.goodsDetail.buy_num):"bargain"==this.type&&this.goodsDetail.bargain_id?(this.number=1,this.minNumber=1):"wholesale_join_cart"!=this.type&&"wholesale_buy_now"!=this.type||!this.goodsDetail.wholesale_sku_id||(this.number=this.goodsDetail.min_num,this.minNumber=this.goodsDetail.min_num),"join_cart"==this.type&&this.getCartData(),this.$forceUpdate()},hide:function(){this.$refs.skuPopup.close()},change:function(t,e){if(!this.disabled){this.btnSwitch=!1,this.skuId=t;for(var i=0;i<this.goodsDetail.goods_spec_format.length;i++)for(var o=this.goodsDetail.goods_spec_format[i],s=0;s<o.value.length;s++)e==this.goodsDetail.goods_spec_format[i].value[s].spec_id&&(this.goodsDetail.goods_spec_format[i].value[s].selected=!1);this.goodsDetail.pintuan_id?this.getPintuanGoodsSkuInfo():this.goodsDetail.groupbuy_id?this.getGroupbuyGoodsSkuInfo():this.goodsDetail.bargain_id?this.getBargainGoodsSkuInfo():this.goodsDetail.seckill_id?this.getSeckillGoodsSkuInfo():this.goodsDetail.topic_id?this.getTopicsGoodsSkuInfo():this.goodsDetail.exchange_id?this.getPointGoodsSkuInfo():this.goodsDetail.wholesale_sku_id?this.getWholeSaleGoodsSkuInfo():"presale"==this.type&&this.goodsDetail.presale_id?this.getPresaleGoodsSkuInfo():this.getGoodsSkuInfo()}},getGoodsSkuInfo:function(){var t=this;this.$api.sendRequest({url:"/api/goodssku/info",data:{sku_id:this.skuId},success:function(e){var i=e.data;null!=i?("presale"==i.promotion_type&&t.$util.redirectTo("/promotionpages/presale/detail/detail",{id:i.presale_id,sku_id:t.skuId},"reLaunch"),i.unit=i.unit||"件",t.goodsSkuDetail=i,t.dealData(),1==t.goodsSkuDetail.promotion_type&&(t.goodsSkuDetail.discountTimeMachine=t.$util.countDown(t.goodsSkuDetail.end_time-e.timestamp)),1==t.goodsSkuDetail.promotion_type&&t.goodsSkuDetail.discountTimeMachine&&(t.goodsSkuDetail.show_price=t.goodsSkuDetail.discount_price),1==t.goodsSkuDetail.promotion_type&&t.goodsSkuDetail.discountTimeMachine?t.goodsSkuDetail.show_price=t.goodsSkuDetail.discount_price:t.goodsSkuDetail.member_price>0?t.goodsSkuDetail.show_price=t.goodsSkuDetail.member_price:t.goodsSkuDetail.show_price=t.goodsSkuDetail.price,t.btnSwitch=!1,t.$emit("refresh",t.goodsSkuDetail)):t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},fail:function(e){t.btnSwitch=!1,t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}})},getPintuanGoodsSkuInfo:function(){var t=this;this.$api.sendRequest({url:"/pintuan/api/goods/info",data:{sku_id:this.skuId,pintuan_id:this.goodsDetail.pintuan_id},success:function(e){var i=e.data;if(null!=i){if("again"==i.type)return t.skuId=i.sku_id,void t.getPintuanGoodsSkuInfo();i.unit=i.unit||"件",t.goodsSkuDetail=i,t.dealData(),t.goodsSkuDetail.show_price=0==t.goodsDetail.group_id?t.goodsSkuDetail.promotion_price:t.goodsSkuDetail.pintuan_price,t.goodsSkuDetail.save_price=t.goodsSkuDetail.price-t.goodsSkuDetail.show_price>0?(t.goodsSkuDetail.price-t.goodsSkuDetail.show_price).toFixed(2):0,t.goodsSkuDetail.end_time-e.timestamp>0?t.goodsSkuDetail.timeMachine=t.$util.countDown(t.goodsSkuDetail.end_time-e.timestamp):(t.$util.showToast({title:"活动已结束"}),setTimeout((function(){t.$util.redirectTo("/pages/goods/detail/detail",{sku_id:t.goodsSkuDetail.sku_id},"redirectTo")}),1e3)),t.btnSwitch=!1,t.$emit("refresh",t.goodsSkuDetail)}else t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},fail:function(e){t.btnSwitch=!1,t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}})},getBargainGoodsSkuInfo:function(){var t=this;this.$api.sendRequest({url:"/bargain/api/goods/info",data:{sku_id:this.skuId,bargain_id:this.goodsDetail.bargain_id},success:function(e){var i=e.data;if(null!=i){if("again"==i.type)return t.skuId=i.sku_id,void t.getBargainGoodsSkuInfo();i.unit=i.unit||"件",t.goodsSkuDetail=i,t.dealData(),t.goodsSkuDetail.show_price=t.goodsDetail.bargain_id>0?t.goodsSkuDetail.floor_price:t.goodsSkuDetail.price,t.goodsSkuDetail.stock=t.goodsSkuDetail.bargain_stock,t.goodsSkuDetail.save_price=t.goodsSkuDetail.price-t.goodsSkuDetail.show_price>0?(t.goodsSkuDetail.price-t.goodsSkuDetail.show_price).toFixed(2):0,t.goodsSkuDetail.end_time-e.timestamp>0?t.goodsSkuDetail.timeMachine=t.$util.countDown(t.goodsSkuDetail.end_time-e.timestamp):(t.$util.showToast({title:"活动已结束"}),setTimeout((function(){t.$util.redirectTo("/pages/goods/detail/detail",{sku_id:t.goodsSkuDetail.sku_id},"redirectTo")}),1e3)),t.btnSwitch=!1,t.$emit("refresh",t.goodsSkuDetail)}else t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},fail:function(e){t.btnSwitch=!1,t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}})},getTopicsGoodsSkuInfo:function(){var t=this;this.$api.sendRequest({url:"/topic/api/topicgoods/info",data:{sku_id:this.skuId,topic_id:this.goodsDetail.topic_id},success:function(e){var i=e.data;if(null!=i){if("again"==i.type)return t.skuId=i.sku_id,void t.getTopicsGoodsSkuInfo();i.unit=i.unit||"件",t.goodsSkuDetail=i.goods_sku_detail,t.dealData(),t.goodsSkuDetail.show_price=t.goodsDetail.topic_id>0?t.goodsSkuDetail.topic_price:t.goodsSkuDetail.price,t.goodsSkuDetail.save_price=t.goodsSkuDetail.price-t.goodsSkuDetail.show_price>0?(t.goodsSkuDetail.price-t.goodsSkuDetail.show_price).toFixed(2):0,t.goodsSkuDetail.end_time-e.timestamp>0?t.goodsSkuDetail.timeMachine=t.$util.countDown(t.goodsSkuDetail.end_time-e.timestamp):(t.$util.showToast({title:"活动已结束"}),setTimeout((function(){t.$util.redirectTo("/pages/goods/detail/detail",{sku_id:t.goodsSkuDetail.sku_id},"redirectTo")}),1e3)),t.btnSwitch=!1,t.$emit("refresh",t.goodsSkuDetail)}else t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},fail:function(e){t.btnSwitch=!1,t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}})},getGroupbuyGoodsSkuInfo:function(){var t=this;this.$api.sendRequest({url:"/groupbuy/api/goods/info",data:{sku_id:this.skuId,groupbuy_id:this.goodsDetail.groupbuy_id},success:function(e){var i=e.data;null!=i?(i.unit=i.unit||"件",t.goodsSkuDetail=i,t.dealData(),t.goodsSkuDetail.show_price=t.goodsDetail.groupbuy_price,t.goodsSkuDetail.save_price=t.goodsSkuDetail.price-t.goodsSkuDetail.show_price>0?(t.goodsSkuDetail.price-t.goodsSkuDetail.show_price).toFixed(2):0,t.goodsSkuDetail.end_time-e.timestamp>0?t.goodsSkuDetail.timeMachine=t.$util.countDown(t.goodsSkuDetail.end_time-e.timestamp):(t.$util.showToast({title:"活动已结束"}),setTimeout((function(){t.$util.redirectTo("/pages/goods/detail/detail",{sku_id:t.goodsSkuDetail.sku_id},"redirectTo")}),1e3)),t.btnSwitch=!1,t.$emit("refresh",t.goodsSkuDetail)):t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},fail:function(e){t.btnSwitch=!1,t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}})},getSeckillGoodsSkuInfo:function(){var t=this;this.$api.sendRequest({url:"/seckill/api/seckillgoods/info",data:{sku_id:this.skuId,seckill_id:this.goodsDetail.seckill_id},success:function(e){var i=e.data;if(null!=i){if("again"==i.type)return t.skuId=i.sku_id,void t.getSeckillGoodsSkuInfo();i.unit=i.unit||"件",t.goodsSkuDetail=i.goods_sku_detail,t.dealData(),t.goodsSkuDetail.show_price=t.goodsSkuDetail.seckill_price,t.goodsSkuDetail.price-t.goodsSkuDetail.show_price>0&&(t.goodsSkuDetail.price-t.goodsSkuDetail.show_price).toFixed(2),t.goodsSkuDetail.end_time-e.timestamp>0?t.goodsSkuDetail.timeMachine=t.$util.countDown(t.goodsSkuDetail.end_time-e.timestamp):(t.$util.showToast({title:"活动已结束"}),setTimeout((function(){t.$util.redirectTo("/pages/goods/detail/detail",{sku_id:t.goodsSkuDetail.sku_id},"redirectTo")}),1e3)),t.btnSwitch=!1,t.$emit("refresh",t.goodsSkuDetail)}else t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},fail:function(e){t.btnSwitch=!1,t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}})},getPointGoodsSkuInfo:function(){var t=this;this.$api.sendRequest({url:"/pointexchange/api/goods/info",data:{sku_id:this.skuId,exchange_id:this.goodsDetail.exchange_id},success:function(e){var i=e.data;if(null!=i){if("again"==i.type)return t.skuId=i.sku_id,void t.getPointGoodsSkuInfo();i.unit=i.unit||"件",t.goodsSkuDetail=i,t.dealData(),t.btnSwitch=!1,t.$emit("refresh",t.goodsSkuDetail)}else t.$util.redirectTo("/promotionpages/point/list/list",{},"redirectTo")},fail:function(e){t.btnSwitch=!1,t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}})},getWholeSaleGoodsSkuInfo:function(){var t=this;this.$api.sendRequest({url:"/wholesale/api/goods/info",data:{sku_id:this.skuId},success:function(e){var i=e.data;null!=i?(i.unit=i.unit||"件",t.goodsSkuDetail=i,t.number=t.goodsSkuDetail.min_num,t.minNumber=t.goodsSkuDetail.min_num,t.dealData(),t.btnSwitch=!1,t.$emit("refresh",t.goodsSkuDetail)):t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},fail:function(e){t.btnSwitch=!1,t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}})},getPresaleGoodsSkuInfo:function(){var t=this;this.$api.sendRequest({url:"/presale/api/goods/info",data:{sku_id:this.skuId,id:this.goodsDetail.presale_id},success:function(e){var i=e.data;if(i){if("again"==i.type)return t.skuId=i.sku_id,void t.getPresaleGoodsSkuInfo();i.unit=i.unit||"件",t.goodsSkuDetail=i,t.dealData(),t.btnSwitch=!1,t.$emit("refresh",t.goodsSkuDetail)}else t.$util.redirectTo("/pages/goods/detail/detail",{sku_id:t.skuId},"redirectTo")},fail:function(e){t.btnSwitch=!1,t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}})},dealData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.goodsSkuDetail;if(t.sku_images?t.sku_images=t.sku_images.split(","):t.sku_images=[],t.goods_spec_format&&t.goods_image&&(t.goods_image=t.goods_image.split(","),t.sku_images=t.sku_images.concat(t.goods_image)),t.sku_spec_format&&(t.sku_spec_format=JSON.parse(t.sku_spec_format)),t.goods_attr_format){var e=JSON.parse(t.goods_attr_format);t.goods_attr_format=this.$util.unique(e,"attr_id");for(var i=0;i<t.goods_attr_format.length;i++)for(var o=0;o<e.length;o++)t.goods_attr_format[i].attr_id==e[o].attr_id&&t.goods_attr_format[i].attr_value_id!=e[o].attr_value_id&&(t.goods_attr_format[i].attr_value_name+="、"+e[o].attr_value_name)}t.goods_spec_format&&(t.goods_spec_format=JSON.parse(t.goods_spec_format)),this.goodsDetail.unit=this.goodsDetail.unit||"件",this.keyInput(!0),this.$langConfig.title(t.goods_name)},changeNum:function(t){if(0!=this.goodsDetail.stock){var e=this.goodsDetail.stock,i=1;if(this.maxBuy>0&&this.maxBuy<e&&(e=this.maxBuy),this.maxBuy>0&&this.goodsDetail.purchased_num>0&&(e=this.maxBuy-this.goodsDetail.purchased_num),this.minBuy>1&&(i=this.minBuy),"pintuan"==this.type&&this.goodsDetail.pintuan_id?e=this.goodsDetail.buy_num>this.goodsDetail.stock?this.goodsDetail.stock:this.goodsDetail.buy_num:"groupbuy"==this.type&&this.goodsDetail.groupbuy_id?(e=(this.goodsDetail.buy_num,this.goodsDetail.stock,this.goodsDetail.stock),i=this.goodsDetail.buy_num):"seckill"==this.type&&this.goodsDetail.seckill_id&&this.goodsDetail.num>0&&this.goodsDetail.num<this.goodsDetail.stock?e=this.goodsDetail.num:"presale"==this.type&&this.goodsDetail.presale_id&&this.goodsDetail.presale_num<this.goodsDetail.stock?e=0==this.goodsDetail.is_buy&&0==this.goodsDetail.sure_buy_num?this.goodsDetail.stock:this.goodsDetail.sure_buy_num:"bargain"==this.type&&this.goodsDetail.bargain_id&&(e=1),"+"==t)if(this.number<e)this.number++;else{if(this.maxBuy>0&&this.goodsDetail.purchased_num>0)return void this.$util.showToast({title:"该商品每人限购"+this.maxBuy+this.goodsDetail.unit+"，您已购买了"+this.goodsDetail.purchased_num+this.goodsDetail.unit});if(this.maxBuy>0&&this.cartNumber>0&&this.cartNumber+this.number>this.maxBuy){var o=this.maxBuy-this.cartNumber;return void(o>0?this.$util.showToast({title:"该商品每人限购"+this.maxBuy+this.goodsDetail.unit+"，购物车已加入了"+this.cartNumber+this.goodsDetail.unit+"，还能购买"+o+this.goodsDetail.unit}):this.$util.showToast({title:"该商品每人限购"+this.maxBuy+this.goodsDetail.unit}))}if("seckill"==this.type&&this.goodsDetail.seckill_id&&this.goodsDetail.num>0)return void this.$util.showToast({title:"该商品每人限购"+this.goodsDetail.num+this.goodsDetail.unit});if("spesale"==this.type&&this.goodsDetail.spesale_id&&this.goodsDetail.num>0)return void this.$util.showToast({title:"该商品每人限购"+this.goodsDetail.presale_num})}else if("-"==t){if(!(this.number>i))return void(this.minBuy>1&&this.$util.showToast({title:"该商品"+this.minBuy+this.goodsDetail.unit+"起售"}));this.number-=1}this.number>this.limitNumber&&this.limitNumber&&(this.number=this.limitNumber)}},blur:function(){var t=this;if((!this.number||this.number<=0)&&(this.number=1),this.number>this.limitNumber&&this.limitNumber&&(this.number=this.limitNumber),this.number<this.minNumber&&this.minNumber&&(this.number=this.minNumber),this.maxBuy>0&&this.number>this.maxBuy&&(this.number=this.maxBuy),this.maxBuy>0&&this.goodsDetail.purchased_num>0){var e=this.maxBuy-this.goodsDetail.purchased_num;e>0&&this.number>e&&(this.number=e)}this.number<this.minBuy&&this.minBuy>0&&(this.number=this.minBuy);var i=parseInt(this.number);this.number=0,setTimeout((function(){t.number=i}),0)},keyInput:function(t,e){var i=this;setTimeout((function(){var o=i.goodsDetail.stock;0!=i.goodsDetail.stock||"groupbuy"!=i.type?0!=i.goodsDetail.stock||"groupbuy"!=i.type?(t&&0==i.number.length&&(i.number=1),t&&(i.number<=0||isNaN(i.number))&&(i.number=1),"pintuan"==i.type&&i.goodsDetail.pintuan_id&&i.number>i.goodsDetail.buy_num||"groupbuy"==i.type&&i.goodsDetail.groupbuy_id&&(i.number<i.goodsDetail.buy_num||i.goodsDetail.buy_num>o)?i.number=i.goodsDetail.buy_num:"seckill"==i.type&&i.goodsDetail.seckill_id&&i.goodsDetail.max_buy>0&&i.number>i.goodsDetail.max_buy?i.number=i.goodsDetail.max_buy:"bargain"==i.type&&i.goodsDetail.bargain_id?i.number=1:i.number>o&&(i.number=o),i.minBuy>1&&i.number<i.minBuy&&(i.number=i.minBuy),t&&(i.number=parseInt(i.number)),e&&e()):i.number=0:i.number=i.goodsDetail.buy_num}),0)},confirm:function(){var e=this;t.removeStorageSync("delivery"),this.preview?this.$util.showToast({title:"预览商品无法购买"}):t.getStorageSync("token")?this.keyInput(!0,(function(){if(0!=e.goodsDetail.stock)if(0!=e.number.length&&0!=e.number){if(e.number>e.goodsDetail.stock)e.$util.showToast({title:"库存不足"});else if(e.maxBuy>0&&e.goodsDetail.purchased_num>0&&e.number>e.maxBuy-e.goodsDetail.purchased_num)e.$util.showToast({title:"该商品每人限购"+e.maxBuy+e.goodsDetail.unit+"，您已购买了"+e.goodsDetail.purchased_num+e.goodsDetail.unit});else if(e.maxBuy>0&&e.cartNumber>0&&e.cartNumber+e.number>e.maxBuy){var i=e.maxBuy-e.cartNumber;i>0?e.$util.showToast({title:"该商品每人限购"+e.maxBuy+e.goodsDetail.unit+"，购物车已加入了"+e.cartNumber+e.goodsDetail.unit+"，还能购买"+i+e.goodsDetail.unit}):e.$util.showToast({title:"该商品每人限购"+e.maxBuy+e.goodsDetail.unit})}else if(!e.btnSwitch)if(e.btnSwitch=!0,"join_cart"==e.type)e.$api.sendRequest({url:"/api/cart/add",data:{site_id:e.goodsDetail.site_id,sku_id:e.skuId,num:e.number},success:function(t){var i=t.data;i>0&&(e.$util.showToast({title:"加入购物车成功"}),e.callback&&e.callback()),e.$refs.skuPopup.close(),e.btnSwitch=!1},fail:function(t){e.$refs.skuPopup.close(),e.btnSwitch=!1}});else if("buy_now"==e.type){var o={sku_id:e.skuId,num:e.number};t.setStorage({key:"orderCreateData",data:o,success:function(){e.$util.redirectTo("/pages/order/payment/payment"),e.btnSwitch=!1}})}else if("seckill"==e.type){o={seckill_id:e.goodsDetail.seckill_id,num:e.number,sku_id:e.skuId};t.setStorage({key:"seckillOrderCreateData",data:o,success:function(){e.$util.redirectTo("/promotionpages/seckill/payment/payment"),e.btnSwitch=!1}})}else if("pintuan"==e.type){o={pintuan_goods_id:e.goodsDetail.id,group_id:e.goodsDetail.group_id,num:e.number};t.setStorage({key:"pintuanOrderCreateData",data:o,success:function(){e.$util.redirectTo("/promotionpages/pintuan/payment/payment"),e.btnSwitch=!1}})}else if("topic"==e.type){o={topic_goods_id:e.goodsDetail.id,num:e.number};t.setStorage({key:"topicOrderCreateData",data:o,success:function(){e.$util.redirectTo("/promotionpages/topics/payment/payment"),e.btnSwitch=!1}})}else if("groupbuy"==e.type){o={groupbuy_id:e.goodsDetail.groupbuy_id,sku_id:e.skuId,num:e.number};t.setStorage({key:"groupbuyOrderCreateData",data:o,success:function(){e.$util.redirectTo("/promotionpages/groupbuy/payment/payment"),e.btnSwitch=!1}})}else if("presale"==e.type){o={presale_id:e.goodsDetail.presale_id,sku_id:e.skuId,num:e.number,site_id:e.goodsDetail.site_id};t.setStorage({key:"presaleOrderCreateData",data:o,success:function(){e.$util.redirectTo("/promotionpages/presale/payment/payment"),e.btnSwitch=!1}})}else if("bargain"==e.type)e.$api.sendRequest({url:"/bargain/api/bargain/launch",data:{id:e.goodsDetail.id},success:function(t){e.btnSwitch=!1,0==t.code?e.$util.redirectTo("/promotionpages/bargain/launch/launch",{id:t.data},"redirectTo"):e.$util.showToast({title:t.message})}});else if("point"==e.type){o={id:e.goodsDetail.exchange_id,sku_id:e.skuId,num:e.number};t.setStorage({key:"exchangeOrderCreateData",data:o,success:function(){e.$util.redirectTo("/promotionpages/point/payment/payment"),e.btnSwitch=!1}})}else if("wholesale_join_cart"==e.type)e.$api.sendRequest({url:"/wholesale/api/cart/add",data:{site_id:e.goodsDetail.site_id,sku_id:e.skuId,num:e.number},success:function(t){var i=t.data;i>0&&(e.$util.showToast({title:"加入进货单成功"}),e.callback&&e.callback(),e.$store.dispatch("getWholeSaleNumber")),e.$refs.skuPopup.close(),e.btnSwitch=!1},fail:function(t){e.$refs.skuPopup.close(),e.btnSwitch=!1}});else if("wholesale_buy_now"==e.type){o={sku_id:e.skuId,num:e.number};t.setStorage({key:"wholesaleOrderCreateData",data:o,success:function(){e.$util.redirectTo("/promotionpages/wholesale/payment/payment"),e.btnSwitch=!1}})}}else e.$util.showToast({title:"购买数量不能为0"});else e.$util.showToast({title:"商品已售罄"})})):this.$refs.login.open()},closeSkuPopup:function(){this.$refs.skuPopup.close()},imgError:function(){this.goodsDetail.sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},valueImgError:function(t,e){this.goodsDetail.goods_spec_format[t].value[e].image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},getCartData:function(){var t=this;this.$api.sendRequest({url:"/api/cart/goodslists",success:function(e){if(e.code>=0)for(var i=e.data,o=0;o<i.length;o++)if(i[o].sku_id==t.goodsDetail.sku_id){t.cartNumber=i[o].num;break}}})},toOrderDetail:function(){this.$util.redirectTo("/promotionpages/presale/order_list/order_list")}}};e.default=s}).call(this,i("543d")["default"])},d0d0:function(t,e,i){},e6f7:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return o}));var o={uniPopup:function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"9ecd"))},uParse:function(){return Promise.all([i.e("common/vendor"),i.e("components/u-parse/u-parse")]).then(i.bind(null,"8e04"))},nsGoodsSku:function(){return Promise.resolve().then(i.bind(null,"06cf"))},loadingCover:function(){return i.e("components/loading-cover/loading-cover").then(i.bind(null,"5203"))},nsLogin:function(){return Promise.all([i.e("common/vendor"),i.e("components/ns-login/ns-login")]).then(i.bind(null,"3584"))},nsGoodsAction:function(){return i.e("components/ns-goods-action/ns-goods-action").then(i.bind(null,"31e9"))},nsGoodsActionIcon:function(){return i.e("components/ns-goods-action-icon/ns-goods-action-icon").then(i.bind(null,"3197"))},nsGoodsActionButton:function(){return i.e("components/ns-goods-action-button/ns-goods-action-button").then(i.bind(null,"05d3"))}},s=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__map(t.goodsSkuDetail.sku_images,(function(e,i){var o=t.__get_orig(e),s=t.$util.img(e,{size:"big"});return{$orig:o,g0:s}}))),o=t.goodsSkuDetail.sku_images?t.goodsSkuDetail.sku_images.length:null,s=t.$util.img(t.goodsSkuDetail.video_url),n=t.$util.img(t.goodsSkuDetail.sku_image,{size:"big"}),a=""!=t.goodsSkuDetail.video_url?t.$lang("video"):null,u=""!=t.goodsSkuDetail.video_url?t.$lang("image"):null,d=t.$util.img(t.goodsSkuDetail.video_url),l=t.$util.img(t.goodsSkuDetail.sku_image,{size:"big"}),r=t.$lang("common.currencySymbol"),c=t.goodsSkuDetail.price>0?t.$lang("common.currencySymbol"):null,g=t.$lang("common.currencySymbol"),m=t.goodsSkuDetail.goods_attr_format&&t.goodsSkuDetail.goods_attr_format.length>0,p=t.goodsSkuDetail.goods_service.length,h=t.$lang("service"),f=t.Development&&t.shopInfo.avatar?t.$util.img(t.shopInfo.avatar):null,_=t.Development&&!t.shopInfo.avatar?t.$util.getDefaultImage():null,k=1==t.evaluateConfig.evaluate_show&&t.goodsEvaluate.content&&t.goodsEvaluate.member_headimg?t.$util.img(t.goodsEvaluate.member_headimg):null,D=1==t.evaluateConfig.evaluate_show&&t.goodsEvaluate.content&&!t.goodsEvaluate.member_headimg?t.$util.getDefaultImage():null,b=1==t.evaluateConfig.evaluate_show&&t.goodsEvaluate.content?t.$util.timeStampTurnTime(t.goodsEvaluate.create_time):null,S=1==t.evaluateConfig.evaluate_show&&t.goodsEvaluate.content&&t.goodsEvaluate.images?t.__map(t.goodsEvaluate.images,(function(e,i){var o=t.__get_orig(e),s=t.$util.img(e);return{$orig:o,g13:s}})):null,y="-1"!=t.poster?t.$util.img(t.poster):null;t._isMounted||(t.e0=function(e){t.switchMedia="video"},t.e1=function(e){t.switchMedia="img"},t.e2=function(e){t.shopInfo.avatar=t.$util.getDefaultImage().default_shop_img},t.e3=function(e){t.goodsEvaluate.member_headimg=t.$util.getDefaultImage().default_headimg},t.e4=function(e){t.detailTab=0}),t.$mp.data=Object.assign({},{$root:{l0:i,g1:o,g2:s,g3:n,m0:a,m1:u,g4:d,g5:l,m2:r,m3:c,m4:g,g6:m,g7:p,m5:h,g8:f,g9:_,g10:k,g11:D,g12:b,l1:S,g14:y}})},n=[]},e723:function(t,e,i){}},[["3550","common/runtime","common/vendor"]]]);