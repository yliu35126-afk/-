(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["promotionpages/bargain/launch/launch"],{"02b2":function(n,i,t){"use strict";t.d(i,"b",(function(){return a})),t.d(i,"c",(function(){return o})),t.d(i,"a",(function(){return e}));var e={uniCountDown:function(){return t.e("components/uni-count-down/uni-count-down").then(t.bind(null,"e48e"))},uniPopup:function(){return t.e("components/uni-popup/uni-popup").then(t.bind(null,"9ecd"))},loadingCover:function(){return t.e("components/loading-cover/loading-cover").then(t.bind(null,"5203"))}},a=function(){var n=this,i=n.$createElement,t=(n._self._c,n.$util.img("upload/uniapp/bargain/bargain_background1.png")),e=n.$util.img("upload/uniapp/bargain/bargain_background.png"),a=""==n.info.headimg?n.$util.img(n.$util.getDefaultImage().default_headimg):null,o=""!=n.info.headimg?n.$util.img(n.info.headimg):null,r=n._f("cover")(n.info.nickname),u=n.$util.img(n.info.sku_image),g=n.$lang("common.currencySymbol"),c=n.$lang("common.currencySymbol"),l=n._f("moneyFormat")(n.info.curr_price),s=n.$util.img("upload/uniapp/bargain/bargain_progress.png"),d=n.bargainRecord.length,p=d?n.__map(n.bargainRecord,(function(i,t){var e=n.__get_orig(i),a=t<4&&""==i.headimg?n.$util.img(n.$util.getDefaultImage().default_headimg):null,o=t<4&&""!=i.headimg?n.$util.img(i.headimg):null;return{$orig:e,g7:a,g8:o}})):null,f=d?n.bargainRecord.length:null,h=d&&f<5?n.bargainRecord.length:null,m=d?n.bargainRecord.length:null,b=d?n.bargainRecord.length:null,_=n.$util.img("upload/uniapp/bargain/bargain_left.png"),$=n.$util.img("upload/uniapp/bargain/bargain_right.png"),v=n.$util.img("upload/uniapp/bargain/bargain_kanjia.png"),y=n.$util.img("upload/uniapp/bargain/bargain_friend.png"),w=n.$util.img("upload/uniapp/bargain/bargain_good.png"),R=n.$util.img("upload/uniapp/bargain/bargain_left.png"),k=n.$util.img("upload/uniapp/bargain/bargain_right.png"),I=n.bargainRecord.length,P=I?n.__map(n.bargainRecord,(function(i,t){var e=n.__get_orig(i),a=""==i.headimg?n.$util.img(n.$util.getDefaultImage().default_headimg):null,o=""!=i.headimg?n.$util.img(i.headimg):null,r=n._f("cover")(i.nickname);return{$orig:e,g21:a,g22:o,f2:r}})):null,S=n.$util.img("upload/uniapp/bargain/coin.png");n._isMounted||(n.e0=function(i){return n.$util.redirectTo("/promotionpages/bargain/list/list")},n.e1=function(i){return n.$util.redirectTo("/promotionpages/bargain/list/list")},n.e2=function(i){return n.$util.redirectTo("/promotionpages/bargain/list/list")},n.e3=function(i){return n.$util.redirectTo("/promotionpages/bargain/list/list")}),n.$mp.data=Object.assign({},{$root:{g0:t,g1:e,g2:a,g3:o,f0:r,g4:u,m0:g,m1:c,f1:l,g5:s,g6:d,l0:p,g9:f,g10:h,g11:m,g12:b,g13:_,g14:$,g15:v,g16:y,g17:w,g18:R,g19:k,g20:I,l1:P,g23:S}})},o=[]},"0a3b":function(n,i,t){"use strict";t.r(i);var e=t("02b2"),a=t("15b3");for(var o in a)["default"].indexOf(o)<0&&function(n){t.d(i,n,(function(){return a[n]}))}(o);t("9797"),t("19b3");var r=t("f0c5"),u=Object(r["a"])(a["default"],e["b"],e["c"],!1,null,"5f625fd3",null,!1,e["a"],void 0);i["default"]=u.exports},"15b3":function(n,i,t){"use strict";t.r(i);var e=t("c26a"),a=t.n(e);for(var o in e)["default"].indexOf(o)<0&&function(n){t.d(i,n,(function(){return e[n]}))}(o);i["default"]=a.a},"19b3":function(n,i,t){"use strict";var e=t("c2f4"),a=t.n(e);a.a},"71d3":function(n,i,t){"use strict";(function(n,i){var e=t("4ea4");t("3a80");e(t("66fd"));var a=e(t("0a3b"));n.__webpack_require_UNI_MP_PLUGIN__=t,i(a.default)}).call(this,t("bc2e")["default"],t("543d")["createPage"])},9797:function(n,i,t){"use strict";var e=t("ab53"),a=t.n(e);a.a},ab53:function(n,i,t){},c26a:function(n,i,t){"use strict";(function(n){var e=t("4ea4");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=e(t("0f13")),o={components:{LTime:function(){Promise.all([t.e("common/vendor"),t.e("components/l-time/l-time")]).then(function(){return resolve(t("904d"))}.bind(null,t)).catch(t.oe)},uniPopup:function(){t.e("components/uni-popup/uni-popup").then(function(){return resolve(t("9ecd"))}.bind(null,t)).catch(t.oe)}},data:function(){return{windowHeight:0,id:0,info:{headimg:""},bargainRecord:[],page:1,totalPage:1,load:!1,timeMachine:null,memberId:0,bargainMoney:"0.00"}},onLoad:function(n){this.getHeight(),n.id&&(this.id=n.id)},computed:{cutMoney:function(){return this.info.price-this.info.curr_price},surplusMoney:function(){return this.info.curr_price-this.info.floor_price},progress:function(){var n=this.info.price-this.info.floor_price,i=parseInt(this.cutMoney/n*100);return isNaN(i)?0:i}},onShow:function(){var i=this;this.$langConfig.refresh(),this.$store.dispatch("getAddonIsexit").then((function(t){if(t.bargain)if(i.getBargainInfo(),n.getStorageSync("token"))i.getMemberId();else{var e=encodeURIComponent("/promotionpages/bargain/launch/launch?id="+i.id);i.$util.redirectTo("/pages/login/login/login",{back:e},"redirectTo")}else i.$util.showToast({title:"砍价未开启",mask:!0}),setTimeout((function(){i.$util.redirectTo("/pages/index/index/index",{},"redirectTo")}),1e3)}))},mixins:[a.default],methods:{getHeight:function(){var i=this;n.getSystemInfo({success:function(n){i.windowHeight=n.windowHeight-44,i.iphoneX&&(i.windowHeight=i.windowHeight-33)}})},getBargainInfo:function(){var i=this;this.$api.sendRequest({url:"/bargain/api/bargain/info",data:{id:this.id},success:function(t){0==t.code?(i.info=t.data,0==i.info.status?n.setNavigationBarTitle({title:"砍价进行中"}):1==i.info.status?n.setNavigationBarTitle({title:"砍价成功"}):2==i.info.status&&n.setNavigationBarTitle({title:"砍价失败"}),i.getBargainRecord(1),0==i.info.status&&(i.timeMachine=i.$util.countDown(i.info.end_time-t.timestamp)),i.$refs.loadingCover&&i.$refs.loadingCover.hide()):n.getStorageSync("token")&&i.$util.redirectTo("/promotionpages/bargain/my_bargain/my_bargain")},fail:function(n){i.$refs.loadingCover&&i.$refs.loadingCover.hide()}})},getBargainRecord:function(n){var i=this;this.load||(this.load=!0,this.$api.sendRequest({url:"/bargain/api/bargain/record",data:{page:n,id:this.info.launch_id},success:function(t){i.load=!1,i.totalPage=t.data.page_count,i.page=n,0==t.code&&t.data.list.length&&(i.bargainRecord=1==n?t.data.list:i.bargainRecord.concat(t.data.list))}}))},scrolltolower:function(){var n=this.page+1;!this.load&&n<=this.totalPage&&this.getBargainRecord(n)},buyNow:function(){var i=this;n.setStorage({key:"bargainOrderCreateData",data:{launch_id:this.info.launch_id},success:function(n){i.$util.redirectTo("/promotionpages/bargain/payment/payment")}})},bargain:function(){var i=this;n.getStorageSync("token")?this.$api.sendRequest({url:"/bargain/api/bargain/bargain",data:{id:this.info.launch_id},success:function(n){0==n.code&&(i.bargainMoney=parseFloat(n.data.bargain_money).toFixed(2),i.$refs.uniPopup.open(),i.getBargainInfo())}}):this.$refs.login.open("/promotionpages/bargain/launch/launch?id="+this.id)},getMemberId:function(){var i=this;this.$api.sendRequest({url:"/api/member/id",success:function(t){t.code>=0&&(i.memberId=t.data,i.token=n.getStorageSync("token"))}})},closePopup:function(){this.$refs.uniPopup.close()},openSharePopup:function(){this.$refs.sharePopup.open()},closeSharePopup:function(){this.$refs.sharePopup.close()},copyUrl:function(){},closeNum:function(){this.$refs.sharePopup.close()},toBargainRecode:function(){var i=n.createSelectorQuery().select(".bargin_introduction");i.boundingClientRect((function(i){n.pageScrollTo({duration:100,scrollTop:i.top+100})})).exec()}},filters:{moneyFormat:function(n){return parseFloat(n).toFixed(2)},cover:function(n){return"string"==typeof n&&n.length>0?n.substr(0,1)+"******"+n.substr(-1):""}},onShareAppMessage:function(){var n="/promotionpages/bargain/launch/launch?id="+this.id;return this.memberId&&(n+="&suid="+this.memberId),{title:"嘿！朋友就差你这一刀了，帮一下忙呗~",imageUrl:this.$util.img(this.info.sku_image,{size:"big"}),path:n,success:function(n){},fail:function(n){}}},onReachBottom:function(){this.scrolltolower()}};i.default=o}).call(this,t("543d")["default"])},c2f4:function(n,i,t){}},[["71d3","common/runtime","common/vendor"]]]);