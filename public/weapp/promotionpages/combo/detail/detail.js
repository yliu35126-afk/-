(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["promotionpages/combo/detail/detail"],{"0460":function(e,n,t){"use strict";t.r(n);var o=t("b1be"),i=t.n(o);for(var u in o)["default"].indexOf(u)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(u);n["default"]=i.a},"0c42":function(e,n,t){"use strict";(function(e,n){var o=t("4ea4");t("3a80");o(t("66fd"));var i=o(t("c576"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(i.default)}).call(this,t("bc2e")["default"],t("543d")["createPage"])},"1dd4":function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return u})),t.d(n,"a",(function(){return o}));var o={loadingCover:function(){return t.e("components/loading-cover/loading-cover").then(t.bind(null,"5203"))},nsLogin:function(){return Promise.all([t.e("common/vendor"),t.e("components/ns-login/ns-login")]).then(t.bind(null,"3584"))}},i=function(){var e=this,n=e.$createElement,t=(e._self._c,e.$lang("common.currencySymbol")),o=e.__map(e.combo.bundling_goods,(function(n,t){var o=e.__get_orig(n),i=e.$util.img(n.sku_image,{size:"mid"});return{$orig:o,g0:i}})),i=e.$lang("common.currencySymbol");e.$mp.data=Object.assign({},{$root:{m0:t,l0:o,m1:i}})},u=[]},"3b5b":function(e,n,t){},"55af":function(e,n,t){},9564:function(e,n,t){"use strict";var o=t("3b5b"),i=t.n(o);i.a},b1be:function(e,n,t){"use strict";(function(e){var o=t("4ea4");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(t("2eee")),u=o(t("c973")),a=o(t("0f13")),r={components:{uniNumberBox:function(){t.e("components/uni-number-box/uni-number-box").then(function(){return resolve(t("ce42"))}.bind(null,t)).catch(t.oe)}},data:function(){return{num:1,blId:0,combo:[],packagePrice:[],saveThePrice:0,isDisabled:!1,isGoodSale:!1}},mixins:[a.default],onLoad:function(e){this.blId=e.bl_id||0},onShow:function(){var e=this;this.$langConfig.refresh(),this.$store.dispatch("getAddonIsexit").then((function(n){n.bundling?e.getList():(e.$util.showToast({title:"组合套餐未开启",mask:!0}),setTimeout((function(){e.$util.redirectTo("/pages/index/index/index",{},"redirectTo")}),1e3))}))},onHide:function(){this.btnSwitch=!0},computed:{themeStyle:function(){return"theme-"+this.$store.state.themeStyle}},methods:{getList:function(){var e=this;this.$api.sendRequest({url:"/bundling/api/bundling/detail",data:{bl_id:this.blId},success:function(n){n.data?(e.combo=n.data,e.numberChange()):(e.$util.showToast({title:"该活动已被删除"}),setTimeout((function(){e.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500)),e.$refs.loadingCover&&e.$refs.loadingCover.hide()},fail:function(n){e.$refs.loadingCover&&e.$refs.loadingCover.hide()}})},toGoodsDetail:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},numberChange:function(e,n){var t=this;setTimeout((function(){var o=0;e&&0==t.num.length&&(t.num=1,o++),e&&(t.num<=0||isNaN(t.num))&&(t.number=1,o++),e&&(t.num=parseInt(t.num));for(var i=0,u=0;u<t.combo.bundling_goods.length;u++)i+=parseFloat(t.combo.bundling_goods[u].price),t.combo.bundling_goods[u].stock<t.num&&o++;t.isDisabled=!(o>0),t.saveThePrice=((i-t.combo.bl_price)*t.num).toFixed(2),t.packagePrice=(t.combo.bl_price*t.num).toFixed(2),n&&n()}),0)},comboBuy:function(){var n=this;return(0,u.default)(i.default.mark((function t(){var o,u,a;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.isDisabled){t.next=2;break}return t.abrupt("return");case 2:for(a in o=n,u="",n.combo.bundling_goods)0==n.combo.bundling_goods[a].goods_state&&(u=u+","+n.combo.bundling_goods[a].sku_name);if(!u.substr(1)){t.next=8;break}return o.$util.showToast({title:u.substr(1)+"已下架"}),t.abrupt("return");case 8:setTimeout((function(){o.numberChange(!0,(function(){if(e.getStorageSync("token")){if(0!=o.btnSwitch){o.btnSwitch=!1;var n={bl_id:o.blId,num:o.num};e.setStorage({key:"comboOrderCreateData",data:n,success:function(){o.$util.redirectTo("/promotionpages/combo/payment/payment"),o.btnSwitch=!1}})}}else o.$refs.login.open("/promotionpages/combo/detail/detail?bl_id="+o.blId)}))}),1e3);case 9:case"end":return t.stop()}}),t)})))()},imgError:function(e){this.combo.bundling_goods[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()}},onShareAppMessage:function(e){var n="/promotionpages/combo/detail/detail?bl_id="+this.blId;return{title:"购买套餐，优惠多多哦",path:n,success:function(e){},fail:function(e){}}}};n.default=r}).call(this,t("543d")["default"])},ba8c:function(e,n,t){"use strict";var o=t("55af"),i=t.n(o);i.a},c576:function(e,n,t){"use strict";t.r(n);var o=t("1dd4"),i=t("0460");for(var u in i)["default"].indexOf(u)<0&&function(e){t.d(n,e,(function(){return i[e]}))}(u);t("ba8c"),t("9564");var a=t("f0c5"),r=Object(a["a"])(i["default"],o["b"],o["c"],!1,null,"d61f45d0",null,!1,o["a"],void 0);n["default"]=r.exports}},[["0c42","common/runtime","common/vendor"]]]);