(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2643b68c"],{"08f9":function(t,s,e){"use strict";e.d(s,"e",(function(){return a})),e.d(s,"a",(function(){return o})),e.d(s,"d",(function(){return l})),e.d(s,"b",(function(){return n})),e.d(s,"c",(function(){return r})),e.d(s,"f",(function(){return d}));var i=e("751a");function a(t){return Object(i["a"])({url:"/seckill/api/ordercreate/payment",data:t,forceLogin:!0})}function o(t){return Object(i["a"])({url:"/seckill/api/ordercreate/calculate",data:t,forceLogin:!0})}function l(t){return Object(i["a"])({url:"/seckill/api/ordercreate/create",data:t,forceLogin:!0})}function n(t){return Object(i["a"])({url:"/seckill/api/seckillgoods/page",data:t})}function r(t){return Object(i["a"])({url:"/seckill/api/seckillgoods/detail",data:t})}function d(t){return Object(i["a"])({url:"/seckill/api/seckill/lists",data:t})}},"981b":function(t,s,e){},ab4a:function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"goods-detail"},[s("div",{staticClass:"preview-wrap"},[""!=t.goodsSkuDetail.video_url?s("div",{staticClass:"video-player-wrap",class:{show:"video"==t.switchMedia}},[""!=t.goodsSkuDetail.video_url?s("video-player",{ref:"videoPlayer",attrs:{playsinline:!0,options:t.playerOptions},on:{play:function(s){return t.onPlayerPlay(s)},pause:function(s){return t.onPlayerPause(s)},ended:function(s){return t.onPlayerEnded(s)},waiting:function(s){return t.onPlayerWaiting(s)},playing:function(s){return t.onPlayerPlaying(s)},loadeddata:function(s){return t.onPlayerLoadeddata(s)},timeupdate:function(s){return t.onPlayerTimeupdate(s)},canplay:function(s){return t.onPlayerCanplay(s)},canplaythrough:function(s){return t.onPlayerCanplaythrough(s)},statechanged:function(s){return t.playerStateChanged(s)},ready:t.playerReadied}}):t._e(),""!=t.goodsSkuDetail.video_url?s("div",{staticClass:"media-mode"},[s("span",{class:{"ns-bg-color":"video"==t.switchMedia},on:{click:function(s){t.switchMedia="video"}}},[t._v("视频")]),s("span",{class:{"ns-bg-color":"img"==t.switchMedia},on:{click:function(s){t.switchMedia="img"}}},[t._v("图片")])]):t._e()],1):t._e(),s("div",{staticClass:"magnifier-wrap"},[s("pic-zoom",{ref:"PicZoom",attrs:{url:t.$img(t.picZoomUrl),scale:2}})],1),s("div",{staticClass:"spec-items"},[s("span",{staticClass:"left-btn iconfont iconarrow-left-copy",class:{move:t.moveThumbLeft},on:{click:function(s){return t.changeThumbImg("prev")}}}),s("span",{staticClass:"right-btn iconfont iconarrow-right",class:{move:t.moveThumbRight},on:{click:function(s){return t.changeThumbImg("next")}}}),s("ul",{style:{left:30+t.thumbPosition+"px"}},t._l(t.goodsSkuDetail.sku_images,(function(e,i){return s("li",{key:i,class:{selected:t.picZoomUrl==e},on:{mousemove:function(s){t.picZoomUrl=e}}},[s("img",{attrs:{src:t.$img(e,{size:"small"})},on:{error:function(s){return t.imageErrorSpec(i)}}})])})),0)]),s("div",{staticClass:"share-collect"},[s("div",{on:{click:t.editCollection}},[s("i",{staticClass:"iconfont",class:1==t.whetherCollection?"iconlikefill ns-text-color":"iconlike"}),s("span",{staticClass:"focus-text",attrs:{"data-collects":"0"}},[t._v("关注商品（"+t._s(t.goodsSkuDetail.collect_num)+"）")])]),s("div",{on:{click:t.service_link}},[s("i",{staticClass:"iconfont iconzhanghao"}),s("span",{attrs:{"data-collects":"0"}},[t._v("联系客服")])])])]),s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"basic-info-wrap"},[s("h1",[t._v(t._s(t.goodsSkuDetail.sku_name))]),t.goodsSkuDetail.introduction?s("p",{staticClass:"desc ns-text-color"},[t._v(t._s(t.goodsSkuDetail.introduction))]):t._e(),t.seckillTimeMachine.currentTime?s("div",{staticClass:"discount-banner ns-bg-color"},[t._m(0),s("div",{staticClass:"surplus-time"},[s("span",[t._v(t._s(t.seckillText))]),s("count-down",{staticClass:"count-down",attrs:{currentTime:t.seckillTimeMachine.currentTime,startTime:t.seckillTimeMachine.startTime,endTime:t.seckillTimeMachine.endTime,dayTxt:"天",hourTxt:"小时",minutesTxt:"分钟",secondsTxt:"秒"},on:{start_callback:function(s){return t.countDownS_cb()},end_callback:function(s){return t.countDownE_cb()}}})],1)]):t._e(),s("div",{staticClass:"item-block"},[s("div",{staticClass:"promotion-price"},[s("dl",{staticClass:"item-line"},[s("dt",{staticClass:"ns-text-color-gray"},[t._v("秒杀价")]),s("dd",[s("em",{staticClass:"yuan ns-text-color"},[t._v("¥")]),s("span",{staticClass:"price ns-text-color"},[t._v(t._s(t.goodsSkuDetail.seckill_price))])])]),s("dl",{staticClass:"item-line"},[s("dt",{staticClass:"ns-text-color-gray"},[t._v("原价")]),s("dd",[s("em",{staticClass:"market-yuan"},[t._v("¥")]),s("span",{staticClass:"market-price"},[t._v(t._s(t.goodsSkuDetail.price))])])]),s("div",{staticClass:"statistical"},[s("ul",[s("li",[s("p",[t._v("累计评价")]),s("span",[t._v(t._s(t.goodsSkuDetail.evaluate))])]),s("li",[s("p",[t._v("累计销量")]),s("span",[t._v(t._s(t.goodsSkuDetail.sale_num)+t._s(t.goodsSkuDetail.unit))])])])]),0==t.goodsSkuDetail.is_virtual?s("dl",{staticClass:"item-line"},[s("dt",[t._v("运费")]),s("dd",[t.goodsSkuDetail.is_free_shipping?s("i",{staticClass:"i-activity-flag ns-text-color ns-border-color"},[t._v("快递免邮")]):s("i",{staticClass:"i-activity-flag ns-text-color ns-border-color"},[t._v("快递不免邮")])])]):t._e()])]),0==t.goodsSkuDetail.is_virtual?s("dl",{staticClass:"item-line delivery"},[s("dt",[t._v("配送至")]),s("dd",[s("div",{staticClass:"region-selected ns-border-color-gray"},[s("span",[t.selectedAddress["level_1"]?[t._l(t.selectedAddress,(function(s){return[t._v(" "+t._s(s.name)+" ")]}))]:[t._v(" 请选择配送地址 ")]],2),s("i",{staticClass:"el-icon-arrow-down"})]),s("div",{staticClass:"region-list ns-border-color-gray",class:{hide:t.hideRegion}},[s("ul",{staticClass:"nav-tabs"},[s("li",{class:{active:"province"==t.currTabAddres},on:{click:function(s){t.currTabAddres="province"}}},[s("div",[s("span",[t._v(t._s(t.selectedAddress["level_1"]?t.selectedAddress["level_1"].name:"请选择省"))]),s("i",{staticClass:"el-icon-arrow-down"})])]),s("li",{class:{active:"city"==t.currTabAddres},on:{click:function(s){t.currTabAddres="city"}}},[s("div",[s("span",[t._v(t._s(t.selectedAddress["level_2"]?t.selectedAddress["level_2"].name:"请选择市"))]),s("i",{staticClass:"el-icon-arrow-down"})])]),s("li",{class:{active:"district"==t.currTabAddres},on:{click:function(s){t.currTabAddres="district"}}},[s("div",[s("span",[t._v(t._s(t.selectedAddress["level_3"]?t.selectedAddress["level_3"].name:"请选择区/县"))]),s("i",{staticClass:"el-icon-arrow-down"})])])]),s("div",{staticClass:"tab-content"},[s("div",{staticClass:"tab-pane",class:{active:"province"==t.currTabAddres}},[s("ul",{staticClass:"province"},t._l(t.provinceArr,(function(e,i){return s("li",{key:i,class:{selected:t.selectedAddress["level_"+e.level]&&t.selectedAddress["level_"+e.level].id==e.id}},[s("span",{on:{click:function(s){return t.getAddress("city",e)}}},[t._v(t._s(e.name))])])})),0)]),s("div",{staticClass:"tab-pane",class:{active:"city"==t.currTabAddres}},[s("ul",{staticClass:"city"},t._l(t.cityArr,(function(e,i){return s("li",{key:i,class:{selected:t.selectedAddress["level_"+e.level]&&t.selectedAddress["level_"+e.level].id==e.id}},[s("span",{on:{click:function(s){return t.getAddress("district",e)}}},[t._v(t._s(e.name))])])})),0)]),s("div",{staticClass:"tab-pane",class:{active:"district"==t.currTabAddres}},[s("ul",{staticClass:"district"},t._l(t.districtArr,(function(e,i){return s("li",{key:i,class:{selected:t.selectedAddress["level_"+e.level]&&t.selectedAddress["level_"+e.level].id==e.id}},[s("span",{on:{click:function(s){return t.getAddress("community",e)}}},[t._v(t._s(e.name))])])})),0)])])])])]):t._e(),s("dl",{staticClass:"item-line service"},[s("dt",[t._v("服务")]),s("dd",[s("span",[t._v(" 由 "),s("router-link",{staticClass:"ns-text-color",attrs:{to:"/shop-"+t.shopInfo.site_id}},[t._v(t._s(t.shopInfo.site_name))]),t._v(" 发货并提供售后服务 ")],1)])]),s("hr",{staticClass:"divider"}),t.goodsSkuDetail.goods_spec_format?s("div",{staticClass:"sku-list"},t._l(t.goodsSkuDetail.goods_spec_format,(function(e,i){return s("dl",{key:i,staticClass:"item-line"},[s("dt",[t._v(t._s(e.spec_name))]),s("dd",[s("ul",t._l(e.value,(function(e,i){return s("li",{key:i},[s("div",{class:{"selected ns-border-color":e["selected"]||t.skuId==e.sku_id,disabled:e["disabled"]||!e["selected"]&&e["disabled"]},on:{click:function(s){return t.changeSpec(e.sku_id,e.spec_id)}}},[e.image?s("img",{attrs:{src:t.$img(e.image,{size:"small"})}}):t._e(),s("span",[t._v(t._s(e.spec_value_name))]),s("i",{staticClass:"iconfont iconduigou1 ns-text-color"})])])})),0)])])})),0):t._e(),s("div",{staticClass:"buy-number"},[s("dl",{staticClass:"item-line"},[s("dt",[t._v("数量")]),s("dd",[s("div",{staticClass:"num-wrap"},[s("el-input",{attrs:{placeholder:"0"},on:{input:function(s){return t.keyInput(!1)},blur:t.blur},model:{value:t.number,callback:function(s){t.number=s},expression:"number"}}),s("div",{staticClass:"operation"},[s("span",{staticClass:"increase el-icon-caret-top",on:{click:function(s){return t.changeNum("+")}}}),s("span",{staticClass:"decrease el-icon-caret-bottom",on:{click:function(s){return t.changeNum("-")}}})])],1),s("span",{staticClass:"unit"},[t._v(t._s(t.goodsSkuDetail.unit))]),s("span",{staticClass:"inventory"},[t._v("库存"+t._s(t.goodsSkuDetail.stock)+t._s(t.goodsSkuDetail.unit))])])])]),s("dl",{staticClass:"item-line buy-btn"},[s("dt"),s("dd",[1==t.goodsSkuDetail.goods_state&&1==t.goodsSkuDetail.verify_state?[s("el-button",{attrs:{type:"primary",plain:""},on:{click:t.buyNow}},[t._v("立即抢购")])]:[s("el-button",{attrs:{type:"info",plain:"",disabled:""}},[t._v("该商品已下架")])],s("div",{staticClass:"go-phone",attrs:{href:"javascript:;"}},[s("img",{attrs:{src:e("5d2e")}}),s("div",{staticClass:"qrcode-wrap"},[s("img",{attrs:{src:t.qrcode,alt:"二维码图片"}})])])],2)]),s("dl",{directives:[{name:"show",rawName:"v-show",value:1==t.shopInfo.shop_baozh||1==t.shopInfo.shop_qtian||1==t.shopInfo.shop_zhping||1==t.shopInfo.shop_erxiaoshi||1==t.shopInfo.shop_tuihuo||1==t.shopInfo.shop_shiyong||1==t.shopInfo.shop_shiti||1==t.shopInfo.shop_xiaoxie,expression:"shopInfo.shop_baozh == 1 || shopInfo.shop_qtian == 1 || shopInfo.shop_zhping == 1 || shopInfo.shop_erxiaoshi == 1 || shopInfo.shop_tuihuo == 1 || shopInfo.shop_shiyong == 1 || shopInfo.shop_shiti == 1 || shopInfo.shop_xiaoxie == 1"}],staticClass:"item-line merchant-service"},[s("dt",[t._v("商家服务")]),s("div",[1==t.shopInfo.shop_baozh?s("dd",[s("i",{staticClass:"el-icon-success"}),s("span",{staticClass:"ns-text-color-gray",attrs:{title:"保证服务"}},[t._v("保证服务")])]):t._e(),1==t.shopInfo.shop_qtian?s("dd",[s("i",{staticClass:"el-icon-success"}),s("span",{staticClass:"ns-text-color-gray",attrs:{title:"满足7天无理由退换货申请的前提下，包邮商品需要买家承担退货邮费，非包邮商品需要买家承担发货和退货邮费"}},[t._v("7天退换")])]):t._e(),1==t.shopInfo.shop_zhping?s("dd",[s("i",{staticClass:"el-icon-success"}),s("span",{staticClass:"ns-text-color-gray",attrs:{title:"商品支持正品保障服务"}},[t._v("正品保障")])]):t._e(),1==t.shopInfo.shop_erxiaoshi?s("dd",[s("i",{staticClass:"el-icon-success"}),s("span",{staticClass:"ns-text-color-gray",attrs:{title:"付款后2小时内发货"}},[t._v("两小时发货")])]):t._e(),1==t.shopInfo.shop_tuihuo?s("dd",[s("i",{staticClass:"el-icon-success"}),s("span",{staticClass:"ns-text-color-gray",attrs:{title:"退货承诺"}},[t._v("退货承诺")])]):t._e(),1==t.shopInfo.shop_shiyong?s("dd",[s("i",{staticClass:"el-icon-success"}),s("span",{staticClass:"ns-text-color-gray",attrs:{title:"试用中心"}},[t._v("试用中心")])]):t._e(),1==t.shopInfo.shop_shiti?s("dd",[s("i",{staticClass:"el-icon-success"}),s("span",{staticClass:"ns-text-color-gray",attrs:{title:"实体验证"}},[t._v("实体验证")])]):t._e(),1==t.shopInfo.shop_xiaoxie?s("dd",[s("i",{staticClass:"el-icon-success"}),s("span",{staticClass:"ns-text-color-gray",attrs:{title:"如有商品质量问题、描述不符或未收到货等，您有权申请退款或退货，来回邮费由卖家承担"}},[t._v("消协保证")])]):t._e()])])]),s("div",{staticClass:"shop-wrap"},[s("div",{staticClass:"head-wrap"},[s("div",{staticClass:"img-wrap"},[s("img",{staticClass:"img-responsive center-block",attrs:{src:t.shopInfo.avatar?t.$img(t.shopInfo.avatar):t.$img(t.defaultShopImage),alt:t.shopInfo.site_name},on:{error:function(s){t.shopInfo.avatar=t.defaultShopImage}}})]),s("h5",[s("span",{staticClass:"site-name"},[t._v(t._s(t.shopInfo.site_name))]),1==t.shopInfo.is_own?s("el-tag",{staticClass:"tag",attrs:{size:"small"}},[t._v("自营")]):t._e()],1)]),s("div",{staticClass:"info-wrap"},[s("dl",[s("dt",{staticClass:"site-score"},[t._v("店铺评分")]),s("dd",[s("el-rate",{attrs:{disabled:""},model:{value:t.score,callback:function(s){t.score=s},expression:"score"}})],1),s("dt",[t._v("商品描述：")]),s("dd",[s("span",[t._v(t._s(t.shopInfo.shop_desccredit))]),t._v("分")]),s("dt",[t._v("卖家服务：")]),s("dd",[s("span",[t._v(t._s(t.shopInfo.shop_servicecredit))]),t._v("分")]),s("dt",[t._v("发货速度：")]),s("dd",[s("span",[t._v(t._s(t.shopInfo.shop_deliverycredit))]),t._v("分")])])]),t.shopInfo.telephone?s("div",{staticClass:"info-wrap"},[s("dl",[s("dt",[t._v("联系电话：")]),s("dd",[t._v(t._s(t.shopInfo.telephone))])])]):t._e(),s("div",{staticClass:"operation"},[s("el-button",{staticClass:"btn btn-default",attrs:{size:"medium"},on:{click:function(s){return t.$router.pushToTab("/shop-"+t.shopInfo.site_id)}}},[t._v("进店逛逛")]),t.hasFollow?s("el-button",{attrs:{size:"medium"},on:{click:t.follow}},[t._v("取消关注")]):s("el-button",{attrs:{size:"medium"},on:{click:t.follow}},[t._v("关注店铺")])],1)]),s("div",{staticClass:"detail-wrap"},[s("div",{staticClass:"goods-recommended"},[s("goods-recommend")],1),s("el-tabs",{staticClass:"goods-tab",attrs:{type:"card"},on:{"tab-click":t.tabChange},model:{value:t.tabName,callback:function(s){t.tabName=s},expression:"tabName"}},[s("el-tab-pane",{attrs:{label:"商品详情",name:"detail"}},[s("div",{domProps:{innerHTML:t._s(t.goodsSkuDetail.goods_content)}})]),s("el-tab-pane",{attrs:{label:"商品属性",name:"attr"}},[s("ul",{staticClass:"attr-list"},[t.goodsSkuDetail.goods_attr_format&&t.goodsSkuDetail.goods_attr_format.length>0?t._l(t.goodsSkuDetail.goods_attr_format,(function(e,i){return s("li",{key:i},[t._v(t._s(e.attr_name)+"："+t._s(e.attr_value_name))])})):t._e()],2)]),s("el-tab-pane",{staticClass:"evaluate",attrs:{label:t.goodsSkuDetail.evaluate?"商品评价("+t.goodsSkuDetail.evaluate+")":"商品评价",name:"evaluate"}},[t.goodsEvaluateList.length?[s("nav",[s("li",{staticClass:"selected"},[t._v("全部评价")])]),s("ul",{staticClass:"list"},t._l(t.goodsEvaluateList,(function(e,i){return s("li",{key:i},[s("div",{staticClass:"member-info"},[s("img",{staticClass:"avatar",attrs:{src:t.$img(e.member_headimg)},on:{error:function(s){return t.imageErrorEvaluate(i)}}}),s("span",[t._v(t._s(e.member_name))])]),s("div",{staticClass:"info-wrap"},[s("el-rate",{attrs:{disabled:""},model:{value:e.star,callback:function(s){t.$set(e,"star",s)},expression:"item.star"}}),s("p",{staticClass:"content"},[t._v(t._s(e.content))]),e.images?s("div",{staticClass:"img-list"},t._l(e.images,(function(i,a){return s("el-image",{key:a,attrs:{src:t.$img(i),"preview-src-list":e.imagesFormat}})})),1):t._e(),s("div",{staticClass:"sku-info"},[s("span",[t._v(t._s(e.sku_name))]),s("span",{staticClass:"create-time"},[t._v(t._s(t.$util.timeStampTurnTime(e.create_time)))])]),""!=e.explain_first?s("div",{staticClass:"evaluation-reply"},[t._v("店家回复："+t._s(e.explain_first))]):t._e(),""!=e.again_content?[s("div",{staticClass:"review-evaluation"},[s("span",[t._v("追加评价")]),s("span",{staticClass:"review-time"},[t._v(t._s(t.$util.timeStampTurnTime(e.again_time)))])]),s("p",{staticClass:"content"},[t._v(t._s(e.again_content))]),s("div",{staticClass:"img-list"},t._l(e.again_images,(function(i,a){return s("el-image",{key:a,attrs:{src:t.$img(i),"preview-src-list":e.againImagesFormat}})})),1),""!=e.again_explain?s("div",{staticClass:"evaluation-reply"},[t._v("店家回复："+t._s(e.again_explain))]):t._e()]:t._e()],2)])})),0),s("div",{staticClass:"pager"},[s("el-pagination",{attrs:{background:"","pager-count":5,total:t.total,"prev-text":"上一页","next-text":"下一页","current-page":t.currentPage,"page-size":t.pageSize,"hide-on-single-page":""},on:{"update:currentPage":function(s){t.currentPage=s},"update:current-page":function(s){t.currentPage=s},"update:pageSize":function(s){t.pageSize=s},"update:page-size":function(s){t.pageSize=s},"size-change":t.handlePageSizeChange,"current-change":t.handleCurrentPageChange}})],1)]:s("div",{staticClass:"empty"},[t._v("该商品暂无评价哦")])],2)],1)],1),s("servicerMessage",{ref:"servicerMessage",staticClass:"kefu",attrs:{shop:{shop_id:t.shopInfo.site_id,logo:t.shopInfo.logo,shop_name:t.shopInfo.site_name}}})],1)},a=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"activity-name"},[s("i",{staticClass:"discount-icon iconfont iconicon_naozhong"}),s("span",[t._v("限时秒杀")])])}],o=e("86bd"),l=(e("14d9"),e("a2a9")),n=e("08f9"),r=e("2f84"),d=e("0091"),c=e("2f62"),u=e("0dec"),h=e.n(u),g=e("e692"),_=e("2f94"),p=e("37cb"),m={data:()=>({id:0,skuId:0,loading:!0,picZoomUrl:"",thumbPosition:0,moveThumbLeft:!1,moveThumbRight:!1,goodsSkuDetail:{video_url:""},seckillText:"距离结束仅剩",seckillTimeMachine:{currentTime:0,startTime:0,endTime:0},qrcode:"",shopInfo:{},whetherCollection:0,score:0,currentPage:1,pageSize:10,total:0,goodsEvaluateList:[],service:null,number:1,tabName:"detail",playerOptions:{playbackRates:[.5,1,1.5,2,3],autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{type:"video/mp4",src:""}],poster:"",notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!0,fullscreenToggle:!0}},switchMedia:"img",hasFollow:!1,provinceArr:{},cityArr:{},districtArr:{},currTabAddres:"province",hideRegion:!1,selectedAddress:{},specBtnRepeat:!1,serverType:"disable",serverThird:""}),components:{CountDown:h.a},created(){this.id=this.$route.path.replace("/promotion/seckill-",""),this.addonIsExit&&1!=this.addonIsExit.seckill?this.$message({message:"秒杀插件未安装",type:"warning",duration:2e3,onClose:()=>{this.$route.push("/")}}):this.getGoodsSkuDetail(),this.shopServiceOpen()},computed:{...Object(c["b"])(["token","defaultHeadImage","defaultShopImage","addonIsExit","locationRegion"])},watch:{$route(t){this.id=t.params.pathMatch,this.addonIsExit&&1==this.addonIsExit.seckill?this.getGoodsSkuDetail():this.$message({message:"秒杀插件未安装",type:"warning",duration:2e3,onClose:()=>{this.$route.push("/")}})},addonIsExit(){1!=this.addonIsExit.seckill&&this.$message({message:"秒杀插件未安装",type:"warning",duration:2e3,onClose:()=>{this.$route.push("/")}})}},methods:{shopServiceOpen(){Object(p["i"])().then(t=>{0==t.code&&("third"==t.data.type?(this.serverType=t.data.type,this.serverThird=t.data.third):"system"==t.data.type&&(this.serverType=t.data.type,this.serverThird=""))})},tabChange(t,s){},bundlingChange(t,s){},getGoodsSkuDetail(){Object(n["c"])({seckill_id:this.id}).then(t=>{console.log(t,"res");let s=t.data;if(null!=s.goods_sku_detail){this.goodsSkuDetail=s.goods_sku_detail,this.shopInfo=s.shop_info;let a=(Number(this.shopInfo.shop_desccredit)+Number(this.shopInfo.shop_servicecredit)+Number(this.shopInfo.shop_deliverycredit))/3;this.score=Number(a.toFixed(1)),this.skuId=this.goodsSkuDetail.sku_id;let o=new Date(1e3*t.timestamp),l=60*o.getHours()*60+60*o.getMinutes()+o.getSeconds();if(this.goodsSkuDetail.seckill_start_time<=l&&l<this.goodsSkuDetail.seckill_end_time){let s=parseInt(o.getTime()/1e3)+(this.goodsSkuDetail.seckill_end_time-l);this.seckillTimeMachine={currentTime:t.timestamp,startTime:t.timestamp,endTime:s}}else this.goodsSkuDetail.seckill_start_time>l&&l<this.goodsSkuDetail.seckill_end_time?this.$message({message:"限时秒杀活动还未开始",type:"warning",duration:2e3,onClose:()=>{this.$router.push("/sku-"+this.goodsSkuDetail.sku_id)}}):l<this.goodsSkuDetail.seckill_start_time&&l>this.goodsSkuDetail.seckill_end_time&&this.$message({message:"限时秒杀活动已结束",type:"warning",duration:2e3,onClose:()=>{this.$router.push("/sku-"+this.goodsSkuDetail.sku_id)}});if(this.goodsSkuDetail.sku_images?this.goodsSkuDetail.sku_images=this.goodsSkuDetail.sku_images.split(","):this.goodsSkuDetail.sku_images=[],this.goodsSkuDetail.goods_spec_format&&this.goodsSkuDetail.goods_image&&(this.goodsSkuDetail.goods_image=this.goodsSkuDetail.goods_image.split(","),this.goodsSkuDetail.sku_images=this.goodsSkuDetail.sku_images.concat(this.goodsSkuDetail.goods_image)),this.goodsSkuDetail.video_url&&(this.switchMedia="video",this.playerOptions.poster=img(this.goodsSkuDetail.sku_images[0]),this.playerOptions.sources[0].src=img(this.goodsSkuDetail.video_url)),this.picZoomUrl=this.goodsSkuDetail.sku_images[0],this.goodsSkuDetail.unit=this.goodsSkuDetail.unit||"件",this.goodsSkuDetail.sku_spec_format&&(this.goodsSkuDetail.sku_spec_format=JSON.parse(this.goodsSkuDetail.sku_spec_format)),this.goodsSkuDetail.goods_attr_format){let t=JSON.parse(this.goodsSkuDetail.goods_attr_format);this.goodsSkuDetail.goods_attr_format=this.$util.unique(t,"attr_id");for(var e=0;e<this.goodsSkuDetail.goods_attr_format.length;e++)for(var i=0;i<t.length;i++)this.goodsSkuDetail.goods_attr_format[e].attr_id==t[i].attr_id&&this.goodsSkuDetail.goods_attr_format[e].attr_value_id!=t[i].attr_value_id&&(this.goodsSkuDetail.goods_attr_format[e].attr_value_name+="、"+t[i].attr_value_name)}this.goodsSkuDetail.goods_spec_format&&(this.goodsSkuDetail.goods_spec_format=JSON.parse(this.goodsSkuDetail.goods_spec_format)),window.document.title=`${this.goodsSkuDetail.sku_name} - ${window.document.title}`,this.loading=!1}else this.$router.push("/")}).then(t=>{""!=this.token&&(this.getWhetherCollection(),this.isFollow()),this.modifyGoodsInfo(),this.getGoodsEvaluate(),this.getGoodsQrcode(),this.getAddress("province",null,!0),this.locationRegion||this.$store.commit("app/SET_LOCATION_REGION",{level_1:{id:11e4,pid:0,name:"北京市",shortname:"北京",longitude:"116.40529",latitude:"39.904987",level:1,sort:1,status:1,default_data:1},level_2:{id:110100,pid:11e4,name:"北京市",shortname:"北京",longitude:"116.40529",latitude:"39.904987",level:2,sort:1,status:1,default_data:1},level_3:{id:110101,pid:110100,name:"东城区",shortname:"东城",longitude:"116.418755",latitude:"39.917545",level:3,sort:3,status:1,default_data:1}}),this.selectedAddress=this.locationRegion,this.provinceId=this.selectedAddress.level_1.id,this.getAddress("city",null,!0,()=>{this.cityId=this.selectedAddress.level_2.id,this.cityId&&this.getAddress("district",null,!0)})}).catch(t=>{this.loading=!1,this.$router.push("/")})},changeSpec(t,s){this.specBtnRepeat=!1,this.skuId=t;for(var e=0;e<this.goodsSkuDetail.goods_spec_format.length;e++)for(var i=this.goodsSkuDetail.goods_spec_format[e],a=0;a<i.value.length;a++)s==this.goodsSkuDetail.goods_spec_format[e].value[a].spec_id&&(this.goodsSkuDetail.goods_spec_format[e].value[a].selected=!1);Object(l["g"])({sku_id:this.skuId}).then(t=>{let s=t.data;null!=s?(""!=s.sku_images?(s.sku_images=s.sku_images.split(","),this.picZoomUrl=s.sku_images[0]):s.sku_images=this.goodsSkuDetail.sku_images,s.unit="件",this.playerOptions.poster=img(s.sku_images[0]),s.sku_spec_format&&(s.sku_spec_format=JSON.parse(s.sku_spec_format)),s.goods_spec_format&&(s.goods_spec_format=JSON.parse(s.goods_spec_format)),this.keyInput(!0),1==s.promotion_type&&(this.discountTimeMachine={currentTime:t.timestamp,startTime:t.timestamp,endTime:s.end_time}),this.specBtnRepeat=!1,Object.assign(this.goodsSkuDetail,s)):this.$router.push("/")})},service_link(){this.token?"third"==this.serverType?window.open(this.serverThird,"_blank"):"system"==this.serverType&&this.$refs.servicerMessage.show():this.$message({message:"您还未登录",type:"warning"})},changeThumbImg(t){if(this.goodsSkuDetail.sku_images.length<4)return;let s=this.goodsSkuDetail.sku_images.length%4,e=88;if(0==s)s=this.goodsSkuDetail.sku_images.length-4;else if(0!=s&&1!=s&&s<2)return;"prev"==t?0!=this.thumbPosition&&Math.round(this.thumbPosition,2)!=e&&(this.thumbPosition+=e):"next"==t&&Math.round(this.thumbPosition,2)!=-Math.round(e*s,2)&&(this.thumbPosition-=e)},getWhetherCollection(){Object(r["c"])({goods_id:this.goodsSkuDetail.goods_id}).then(t=>{this.whetherCollection=t.data})},editCollection(){0==this.whetherCollection?Object(r["a"])({sku_id:this.skuId}).then(t=>{var s=t.data;s>0&&(this.whetherCollection=1,this.goodsSkuDetail.collect_num++)}):Object(r["b"])({goods_id:this.goodsSkuDetail.goods_id}).then(t=>{var s=t.data;s>0&&(this.whetherCollection=0,this.goodsSkuDetail.collect_num--)})},getAftersale(){Object(l["b"])({}).then(t=>{if(0==t.code&&t.data){t.data.content;t.data.content&&(this.service=t.data.content)}})},modifyGoodsInfo(){Object(l["j"])({sku_id:this.skuId,site_id:this.goodsSkuDetail.site_id}),Object(l["a"])({sku_id:this.skuId})},getGoodsQrcode(){Object(l["d"])({sku_id:this.skuId}).then(t=>{let s=t.data;s.path.h5.img&&(this.qrcode=img(s.path.h5.img))})},getGoodsEvaluate(){Object(d["a"])({page:this.currentPage,page_size:this.pageSize,goods_id:this.goodsSkuDetail.goods_id}).then(t=>{let s=[];t.message;0==t.code&&t.data&&(s=t.data.list,this.total=t.data.count);for(var e=0;e<s.length;e++){if(1==s[e].explain_type?s[e].star=5:2==s[e].explain_type?s[e].star=3:3==s[e].explain_type&&(s[e].star=1),s[e].images){s[e].images=s[e].images.split(","),s[e].imagesFormat=[];for(var i=0;i<s[e].images.length;i++)s[e].imagesFormat.push(img(s[e].images[i]))}if(s[e].again_images){s[e].again_images=s[e].again_images.split(","),s[e].againImagesFormat=[];for(var a=0;a<s[e].again_images.length;a++)s[e].againImagesFormat.push(img(s[e].again_images[a]))}1==s[e].is_anonymous&&(s[e].member_name=s[e].member_name.replace(s[e].member_name.substring(1,s[e].member_name.length-1),"***"))}this.goodsEvaluateList=s})},imageErrorEvaluate(t){this.goodsEvaluateList[t].member_headimg=this.defaultHeadImage},handlePageSizeChange(t){this.pageSize=t,this.getGoodsEvaluate()},handleCurrentPageChange(t){this.currentPage=t,this.getGoodsEvaluate()},changeNum(t){if(0!=this.goodsSkuDetail.stock){var s=this.goodsSkuDetail.stock,e=1;if("+"==t){if(!(this.number<s))return;this.number++}else if("-"==t){if(!(this.number>e))return;this.number-=1}}},blur(){let t=parseInt(this.number);this.number=0,setTimeout(()=>{this.number=t},0)},keyInput(t,s){setTimeout(()=>{var e=this.goodsSkuDetail.stock;0!=this.goodsSkuDetail.stock?(t&&0==this.number.length&&(this.number=1),t&&(this.number<=0||isNaN(this.number))&&(this.number=1),this.number>e&&(this.number=e),t&&(this.number=parseInt(this.number)),s&&s()):this.number=0},0)},onPlayerPlay(t){},onPlayerPause(t){},onPlayerEnded(t){},onPlayerWaiting(t){},onPlayerPlaying(t){},onPlayerLoadeddata(t){},onPlayerTimeupdate(t){},onPlayerCanplay(t){},onPlayerCanplaythrough(t){},playerStateChanged(t){},playerReadied(t){},buyNow(){this.keyInput(!0,()=>{if(0!=this.goodsSkuDetail.stock)if(0!=this.number.length&&0!=this.number){var t={seckill_id:this.goodsSkuDetail.seckill_id,num:this.number,sku_id:this.skuId};this.$store.dispatch("order/setSeckillOrderCreateData",t),this.$router.push({path:"/promotion/seckill_payment"})}else this.$message({message:"购买数量不能为0",type:"warning"});else this.$message({message:"商品已售罄",type:"warning"})})},countDownS_cb(){},countDownE_cb(){this.seckillText="活动已结束",this.$message({message:"限时秒杀活动已结束",type:"warning",duration:2e3,onClose:()=>{this.$router.push("/sku-"+this.goodsSkuDetail.sku_id)}})},isFollow(){Object(g["c"])({site_id:this.goodsSkuDetail.site_id}).then(t=>{0==t.code&&(this.hasFollow=t.data)})},follow(){this.hasFollow?Object(g["b"])({site_id:this.goodsSkuDetail.site_id}).then(t=>{0==t.code&&t.data&&(this.hasFollow=!this.hasFollow,this.$message({message:"取消成功",type:"success"}))}):Object(g["a"])({site_id:this.goodsSkuDetail.site_id}).then(t=>{0==t.code&&t.data&&(this.hasFollow=!this.hasFollow,this.$message({message:"关注成功",type:"success"}))})},imageErrorSpec(t){this.goodsSkuDetail.sku_images[t]=this.defaultGoodsImage,this.picZoomUrl=this.defaultGoodsImage},getAddress(t,s,e,i){let a=0;switch(t){case"province":a=0;break;case"city":s&&(this.provinceId=s.id),a=this.provinceId,this.cityArr={},this.districtArr={};break;case"district":s&&(this.cityId=s.id),a=this.cityId,this.districtArr={};break}if(s){if(s.level<=2){let t=s.level;for(let s=t;s<=3;s++)delete this.selectedAddress["level_"+s]}this.selectedAddress["level_"+s.level]=s}if(e||this.$store.commit("app/SET_LOCATION_REGION",this.selectedAddress),this.$forceUpdate(),"community"==t)return this.hideRegion=!0,void setTimeout(()=>{this.hideRegion=!1},10);Object(_["a"])({pid:a}).then(s=>{const{code:e,data:a}=s;if(a){switch(t){case"province":this.provinceArr=a;break;case"city":this.cityArr=a;break;case"district":this.districtArr=a;break}this.currTabAddres=t,i&&i()}}).catch(t=>{})}}},v=e("a63f"),k=e("628a"),f={name:"seckill_detail",components:{PicZoom:o["a"],GoodsRecommend:v["a"],servicerMessage:k["a"]},mixins:[m]},b=f,C=(e("f201"),e("2877")),y=Object(C["a"])(b,i,a,!1,null,null,null);s["default"]=y.exports},f201:function(t,s,e){"use strict";e("981b")}}]);
//# sourceMappingURL=chunk-2643b68c.809702ae.js.map