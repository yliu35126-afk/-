(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-551bc906"],{"035f":function(e,t,a){"use strict";a("fcd4d")},4793:function(e,t,a){},a135:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingAd,expression:"loadingAd"}],staticClass:"ns-login-wrap",style:{background:e.backgroundColor}},[t("div",{staticClass:"el-row-wrap el-row-wrap-login",staticStyle:{position:"relative"}},[t("el-col",[t("el-carousel",{staticClass:"ns-login-bg",attrs:{height:"530px"},on:{change:e.handleChange}},e._l(e.adList,(function(a){return t("el-carousel-item",{key:a.adv_id},[t("el-image",{staticStyle:{height:"530px",width:"100%"},attrs:{src:e.$img(a.adv_image),fit:"cover"},on:{click:function(t){return e.$router.pushToTab(a.adv_url.url)}}})],1)})),1)],1),t("el-row",{staticStyle:{position:"absolute",right:"360px","z-index":"999"}},[t("el-col",{staticClass:"ns-login-form",attrs:{span:11}},[t("div",{staticClass:"grid-content bg-purple login_tab"},[t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"账号登录",name:"first"}},["first"==e.activeName?t("el-form",{ref:"ruleForm",attrs:{model:e.formData,rules:e.accountRules}},[t("el-form-item",{attrs:{prop:"account"}},[t("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.formData.account,callback:function(t){e.$set(e.formData,"account",t)},expression:"formData.account"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont iconzhanghao"})])],2)],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入登录密码"},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont iconmima"})])],2)],1),1==e.shop_pc_reception_login?t("el-form-item",{attrs:{prop:"vercode"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入验证码",maxlength:"4"},model:{value:e.formData.vercode,callback:function(t){e.$set(e.formData,"vercode",t)},expression:"formData.vercode"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont iconyanzhengma"})]),t("template",{slot:"append"},[t("img",{staticClass:"captcha",attrs:{src:e.captcha.img,mode:""},on:{click:e.getCaptcha}})])],2)],1):e._e(),t("el-form-item",[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-checkbox",{model:{value:e.formData.checked,callback:function(t){e.$set(e.formData,"checked",t)},expression:"formData.checked"}},[e._v("七天自动登录")])],1),t("el-col",{staticClass:"ns-forget-pass",attrs:{span:12}},[t("router-link",{attrs:{to:"/find_pass"}},[e._v("忘记密码?")])],1)],1)],1),t("el-form-item",[t("el-button",{staticClass:"rule-button",attrs:{type:"primary"},on:{click:function(t){return e.accountLogin("ruleForm")}}},[e._v(" 登录")])],1),t("el-form-item",[t("el-row",[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"bg-purple-light"},[e._v("没有账号？"),t("router-link",{staticClass:"register",attrs:{to:"/register"}},[e._v("立即注册")])],1)])],1)],1)],1):e._e()],1),e.registerConfig.register&&-1!=e.registerConfig.register.indexOf("mobile")?t("el-tab-pane",{attrs:{label:"手机动态码登录",name:"second"}},["second"==e.activeName?t("el-form",{ref:"mobileRuleForm",staticClass:"ns-login-mobile",attrs:{model:e.formData,rules:e.mobileRules}},[t("el-form-item",{attrs:{prop:"mobile"}},[t("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.formData.mobile,callback:function(t){e.$set(e.formData,"mobile",t)},expression:"formData.mobile"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont iconshouji-copy"})])],2)],1),t("el-form-item",{attrs:{prop:"vercode"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入验证码",maxlength:"4"},model:{value:e.formData.vercode,callback:function(t){e.$set(e.formData,"vercode",t)},expression:"formData.vercode"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont iconyanzhengma"})]),t("template",{slot:"append"},[t("img",{staticClass:"captcha",attrs:{src:e.captcha.img,mode:""},on:{click:e.getCaptcha}})])],2)],1),t("el-form-item",{attrs:{prop:"dynacode"}},[t("el-input",{attrs:{maxlength:"4",placeholder:"请输入短信动态码"},model:{value:e.formData.dynacode,callback:function(t){e.$set(e.formData,"dynacode",t)},expression:"formData.dynacode"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont icondongtaima"})]),t("template",{slot:"append"},[t("div",{staticClass:"dynacode",class:120==e.dynacodeData.seconds?"ns-text-color":"ns-text-color-gray",on:{click:function(t){return e.sendMobileCode("mobileRuleForm")}}},[e._v(" "+e._s(e.dynacodeData.codeText)+" ")])])],2)],1),t("el-form-item",[t("el-button",{staticClass:"rule-button",attrs:{type:"primary"},on:{click:function(t){return e.mobileLogin("mobileRuleForm")}}},[e._v("登录")])],1),t("el-form-item",[t("el-row",[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"bg-purple-light"},[t("router-link",{attrs:{to:"/register"}},[t("p",{staticClass:"register"},[e._v("立即注册")])]),t("i",{staticClass:"iconfont iconarrow-right"})],1)])],1)],1)],1):e._e()],1):e._e()],1)],1)])],1)],1)])},i=[],o=(a("d9e2"),a("14d9"),a("7401")),r=a("37cb"),c={data:()=>{var e=(e,t,a)=>{if(!t)return a(new Error("手机号不能为空"));{const e=/^1[3|4|5|6|7|8|9][0-9]{9}$/;e.test(t)?a():a(new Error("请输入正确的手机号"))}};return{loginMode:"account",activeName:"first",formData:{account:"",password:"",vercode:"",mobile:"",dynacode:"",key:"",checked:!1,autoLoginRange:7},captcha:{id:"",img:""},dynacodeData:{seconds:120,timer:null,codeText:"获取动态码",isSend:!1},isSub:!1,registerConfig:{is_enable:1},accountRules:{account:[{required:!0,message:"请输入登录账号",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"}],vercode:[{required:!0,message:"请输入验证码",trigger:"blur"}]},mobileRules:{mobile:[{required:!0,validator:e,trigger:"blur"}],vercode:[{required:!0,message:"请输入验证码",trigger:"blur"}],dynacode:[{required:!0,message:"请输入短信动态码",trigger:"blur"}]},codeRules:{mobile:[{required:!0,validator:e,trigger:"blur"}],vercode:[{required:!0,message:"请输入验证码",trigger:"blur"}]},loadingAd:!0,adList:[],shop_pc_reception_login:0,backgroundColor:""}},created(){this.getAdList(),this.getCaptcha(),this.getRegisterConfig(),this.getCaptchaConfig();let e=this;document.onkeypress=function(t){var a=document.all?event.keyCode:t.which;if(13==a)return"first"==e.activeName?e.accountLogin("ruleForm"):e.mobileLogin("mobileRuleForm"),!1}},watch:{"dynacodeData.seconds":{handler(e,t){0==e&&(clearInterval(this.dynacodeData.timer),this.dynacodeData={seconds:120,timer:null,codeText:"获取动态码",isSend:!1})},immediate:!0,deep:!0}},methods:{getAdList(){Object(r["a"])({keyword:"NS_PC_LOGIN"}).then(e=>{if(0==e.code&&e.data.adv_list){this.adList=e.data.adv_list,console.log(this.adList,"0");for(let e=0;e<this.adList.length;e++)this.adList[e].adv_url&&(this.adList[e].adv_url=JSON.parse(this.adList[e].adv_url));this.backgroundColor=this.adList[0].background}this.loadingAd=!1}).catch(e=>{this.loadingAd=!1})},handleClick(e,t){"first"==this.activeName?this.loginMode="account":this.loginMode="mobile"},handleChange(e,t){this.backgroundColor=this.adList[e].background},accountLogin(e){this.$refs[e].validate(e=>{if(!e)return!1;var t={username:this.formData.account,password:this.formData.password};""!=this.captcha.id&&(t.captcha_id=this.captcha.id,t.captcha_code=this.formData.vercode),this.formData.checked&&(t.autoLoginRange=this.formData.autoLoginRange),this.isSub||(this.isSub=!0,this.$store.dispatch("member/login",t).then(e=>{if(e.code>=0)if(this.$message({message:"登录成功！",type:"success"}),this.$route.query.redirect){this.$route.query.redirect,this.$route.query;this.$router.push(this.$route.query.redirect)}else this.$router.push({name:"member"});else this.isSub=!1,this.getCaptcha(),this.$message({message:e.message,type:"warning"})}).catch(e=>{this.isSub=!1,this.$message.error(e.message),this.getCaptcha()}))})},mobileLogin(e){this.$refs[e].validate(e=>{if(!e)return!1;var t={mobile:this.formData.mobile,key:this.formData.key,code:this.formData.dynacode};""!=this.captcha.id&&(t.captcha_id=this.captcha.id,t.captcha_code=this.formData.vercode),this.isSub||(this.isSub=!0,this.$store.dispatch("member/mobile_login",t).then(e=>{e.code>=0?(this.$message({message:"登录成功！",type:"success"}),this.$route.query.redirect?this.$router.push(this.$route.query.redirect):this.$router.push({name:"member"})):(this.isSub=!1,this.getCaptcha(),this.$message({message:e.message,type:"warning"}))}).catch(e=>{this.isSub=!1,this.$message.error(e.message),this.getCaptcha()}))})},getRegisterConfig(){Object(o["f"])().then(e=>{e.code>=0&&(this.registerConfig=e.data.value,-1!=this.registerConfig.register.indexOf("username")?this.loginMode="account":this.loginMode="mobile")}).catch(e=>{console.log(e.message)})},getCaptcha(){Object(r["b"])({captcha_id:this.captcha.id}).then(e=>{e.code>=0&&(this.captcha.id=e.data.id,this.captcha.img=e.data.img,this.captcha.img=this.captcha.img.replace(/\r\n/g,""))}).catch(e=>{this.$message.error(e.message)})},getCaptchaConfig(){Object(r["c"])().then(e=>{e.code>=0&&(this.shop_pc_reception_login=e.data.value.shop_pc_reception_login)}).catch(e=>{this.$message.error(e.message)})},sendMobileCode(e){120==this.dynacodeData.seconds&&(this.$refs[e].clearValidate("dynacode"),this.$refs[e].validateField("mobile",e=>{if(e)return!1}),this.$refs[e].validateField("vercode",e=>{if(e)return!1;Object(o["b"])({mobile:this.formData.mobile,captcha_id:this.captcha.id,captcha_code:this.formData.vercode}).then(e=>{e.code>=0&&(this.formData.key=e.data.key,120==this.dynacodeData.seconds&&null==this.dynacodeData.timer&&(this.dynacodeData.timer=setInterval(()=>{this.dynacodeData.seconds--,this.dynacodeData.codeText=this.dynacodeData.seconds+"s后可重新获取"},1e3)))}).catch(e=>{this.$message.error(e.message)})}))}}},l={name:"login",mixins:[c]},n=l,d=(a("f63f"),a("035f"),a("2877")),m=Object(d["a"])(n,s,i,!1,null,"4286b6ba",null);t["default"]=m.exports},f63f:function(e,t,a){"use strict";a("4793")},fcd4d:function(e,t,a){}}]);
//# sourceMappingURL=chunk-551bc906.e1c16d65.js.map