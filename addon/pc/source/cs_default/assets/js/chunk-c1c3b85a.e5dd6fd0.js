(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c1c3b85a"],{"295f":function(t,a,e){"use strict";e("bfcc")},"3bc6":function(t,a,e){"use strict";e("a6ad")},"3e0f":function(t,a,e){"use strict";e.d(a,"b",(function(){return i})),e.d(a,"c",(function(){return o})),e.d(a,"a",(function(){return r})),e.d(a,"d",(function(){return n}));var s=e("751a");function i(t){return Object(s["a"])({url:"/api/pay/info",data:t,forceLogin:!0})}function o(t){return Object(s["a"])({url:"/api/pay/type",data:t,forceLogin:!0})}function r(t){return Object(s["a"])({url:"/api/pay/status",data:t,forceLogin:!0})}function n(t){return Object(s["a"])({url:"/api/pay/pay",data:t,forceLogin:!0})}},"7bb3":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t._self._c;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{staticClass:"item-block"},[a("div",{staticClass:"payment-detail"},[a("div",{staticClass:"payment-media"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"media-left"},[a("i",{staticClass:"el-icon-circle-check ns-text-color"})])]),a("el-col",{attrs:{span:16}},[a("div",{staticClass:"media-body"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"payment-text"},[t._v("您的订单已提交成功，正在等待处理！")]),a("div",[a("span",[t._v("应付金额：")]),a("span",{staticClass:"payment-money ns-text-color"},[t._v("￥"+t._s(t.payInfo.pay_money)+"元")])])]),a("el-col",{attrs:{span:12}})],1)],1)]),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"media-right"},[a("div",{staticClass:"el-button--text",on:{click:function(a){t.orderOpen?t.orderOpen=!1:t.orderOpen=!0}}},[t._v(" 订单信息 "),a("i",{staticClass:"el-icon-arrow-down",class:t.orderOpen?"rotate":""})])])])],1)],1),t.orderOpen?a("div",{staticClass:"order-info"},[a("el-row",[a("el-col",{staticClass:"order-info-left",attrs:{span:4}}),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"line"}),a("div",{staticClass:"order-item"},[a("div",{staticClass:"item-label"},[t._v("交易单号：")]),a("div",{staticClass:"item-value"},[t._v(t._s(t.payInfo.out_trade_no))])]),a("div",{staticClass:"order-item"},[a("div",{staticClass:"item-label"},[t._v("订单内容：")]),a("div",{staticClass:"item-value"},[t._v(t._s(t.payInfo.pay_detail))])]),a("div",{staticClass:"order-item"},[a("div",{staticClass:"item-label"},[t._v("订单金额：")]),a("div",{staticClass:"item-value"},[t._v("￥"+t._s(t.payInfo.pay_money))])]),a("div",{staticClass:"order-item"},[a("div",{staticClass:"item-label"},[t._v("创建时间：")]),a("div",{staticClass:"item-value"},[t._v(t._s(t.$timeStampTurnTime(t.payInfo.create_time)))])])])],1)],1):t._e()])]),a("div",{staticClass:"item-block"},[a("div",{staticClass:"block-text"},[t._v("支付方式")]),t.payTypeList.length?a("div",{staticClass:"pay-type-list"},[t._l(t.payTypeList,(function(e,s){return a("div",{key:s,staticClass:"pay-type-item",class:t.payIndex==s?"active":"",on:{click:function(a){t.payIndex=s}}},[t._v(" "+t._s(e.name)+" ")])})),a("div",{staticClass:"clear"})],2):a("div",{staticClass:"no-pay-type"},[a("p",[t._v("商家未配置支付方式")])])]),t.payTypeList.length?a("div",{staticClass:"item-block"},[a("div",{staticClass:"order-submit"},[a("el-button",{staticClass:"el-button--primary",attrs:{type:"primary"},on:{click:t.pay}},[t._v("立即支付")])],1),a("div",{staticClass:"clear"})]):t._e(),a("el-dialog",{staticClass:"confirm-pay-wrap",attrs:{title:"请确认支付是否完成",visible:t.dialogVisible,width:"23%",top:"30vh"},on:{"update:visible":function(a){t.dialogVisible=a}}},[a("div",{staticClass:"info-wrap"},[a("i",{staticClass:"el-message-box__status el-icon-warning"}),a("span",[t._v("完成支付前请根据您的情况点击下面的按钮")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:t.goIndex}},[t._v("返回首页")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.goOrderList}},[t._v("已完成支付")])],1)]),a("el-dialog",{attrs:{title:"请用微信扫码支付",visible:t.openQrcode,width:"300px",center:""},on:{"update:visible":function(a){t.openQrcode=a}}},[a("div",{staticClass:"wechatpay-box"},[a("img",{attrs:{src:t.payQrcode}})])])],1)},i=[],o=(e("14d9"),e("3e0f")),r={name:"pay",components:{},data:()=>({orderOpen:!1,outTradeNo:"",payInfo:{pay_money:0},payIndex:0,payTypeList:[{name:"支付宝支付",icon:"iconzhifubaozhifu-",type:"alipay"},{name:"微信支付",icon:"iconweixinzhifu",type:"wechatpay"}],payUrl:"",timer:null,payQrcode:"",openQrcode:!1,loading:!0,test:null,dialogVisible:!1}),created(){this.$route.query.code?(this.outTradeNo=this.$route.query.code,this.getPayInfo(),this.getPayType(),this.checkPayStatus()):this.$router.push({path:"/"})},methods:{getPayInfo(){Object(o["b"])({out_trade_no:this.outTradeNo,forceLogin:!0}).then(t=>{const{code:a,message:e,data:s}=t;s&&(this.payInfo=t.data),this.loading=!1}).catch(t=>{this.loading=!1,this.$message.error({message:t.message,duration:2e3,onClose:()=>{this.$router.push({path:"/member/order_list"})}})})},getPayType(){Object(o["c"])({}).then(t=>{const{code:a,message:e,data:s}=t;a>=0&&(""==t.data.pay_type?this.payTypeList=[]:this.payTypeList.forEach((a,e)=>{-1==t.data.pay_type.indexOf(a.type)&&this.payTypeList.splice(e,1)}))}).catch(t=>{this.$message.error(t.message)})},checkPayStatus(){this.timer=setInterval(()=>{Object(o["a"])({out_trade_no:this.outTradeNo}).then(t=>{const{code:a,message:e,data:s}=t;a>=0&&(0==a?2==s.pay_status&&(clearInterval(this.timer),this.dialogVisible=!1,this.$router.push({path:"/result?code="+this.payInfo.out_trade_no})):clearInterval(this.timer))}).catch(t=>{clearInterval(this.timer),this.$router.push({path:"/"})})},1e3)},pay(){var t=this.payTypeList[this.payIndex];if(t){if("alipay"==t.type)var a=window.open();Object(o["d"])({out_trade_no:this.payInfo.out_trade_no,pay_type:t.type,app_type:"pc"}).then(e=>{const{code:s,message:i,data:o}=e;if(s>=0)switch(t.type){case"alipay":this.payUrl=e.data.data,a.location.href=this.payUrl,this.open();break;case"wechatpay":this.payQrcode=e.data.qrcode,this.openQrcode=!0;break}else this.$message({message:i,type:"warning"})}).catch(t=>{this.$message.error(t.message)})}},open(){this.dialogVisible=!0},goIndex(){clearInterval(this.timer),this.dialogVisible=!1,this.$router.push({path:"/"})},goOrderList(){clearInterval(this.timer),this.dialogVisible=!1,this.$router.push({path:"/member/order_list"})}}},n=r,c=(e("295f"),e("3bc6"),e("2877")),l=Object(c["a"])(n,s,i,!1,null,"18a4f774",null);a["default"]=l.exports},a6ad:function(t,a,e){},bfcc:function(t,a,e){}}]);
//# sourceMappingURL=chunk-c1c3b85a.e5dd6fd0.js.map