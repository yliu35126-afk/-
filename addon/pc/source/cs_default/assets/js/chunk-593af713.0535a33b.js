(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-593af713"],{"59a5":function(t,e,i){},"6de3":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"box"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.yes,expression:"yes"}],staticClass:"null-page"}),e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("编辑收货地址")])]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"ns-member-address-list"},[e("el-form",{ref:"ruleForm",attrs:{model:t.formData,rules:t.rules,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"姓名",prop:"name"}},[e("el-input",{staticClass:"ns-len-input",attrs:{placeholder:"收货人姓名"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),e("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[e("el-input",{staticClass:"ns-len-input",attrs:{autocomplete:"off",placeholder:"收货人手机号"},model:{value:t.formData.mobile,callback:function(e){t.$set(t.formData,"mobile",e)},expression:"formData.mobile"}})],1),e("el-form-item",{attrs:{label:"电话"}},[e("el-input",{staticClass:"ns-len-input",attrs:{autocomplete:"off",placeholder:"收货人固定电话（选填）"},model:{value:t.formData.telephone,callback:function(e){t.$set(t.formData,"telephone","string"===typeof e?e.trim():e)},expression:"formData.telephone"}})],1),e("el-form-item",{attrs:{label:"地址",prop:"full_address"}},[e("el-select",{attrs:{placeholder:"请选择省"},on:{change:function(e){return t.changeProvice(t.formData.province_id)}},model:{value:t.formData.province_id,callback:function(e){t.$set(t.formData,"province_id",e)},expression:"formData.province_id"}},t._l(t.province,(function(i){return e("el-option",{key:i.id,attrs:{label:i.name,value:i.id}},[t._v(t._s(i.name))])})),1),e("el-select",{attrs:{placeholder:"请选择市"},on:{change:function(e){return t.changeCity(t.formData.city_id)}},model:{value:t.formData.city_id,callback:function(e){t.$set(t.formData,"city_id",e)},expression:"formData.city_id"}},t._l(t.city,(function(i){return e("el-option",{key:i.id,attrs:{label:i.name,value:i.id}},[t._v(t._s(i.name))])})),1),e("el-select",{attrs:{placeholder:"请选择区/县"},on:{change:function(e){return t.changeDistrict(t.formData.district_id)}},model:{value:t.formData.district_id,callback:function(e){t.$set(t.formData,"district_id",e)},expression:"formData.district_id"}},t._l(t.district,(function(i){return e("el-option",{key:i.id,attrs:{label:i.name,value:i.id}},[t._v(t._s(i.name))])})),1)],1),e("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[e("el-input",{staticClass:"ns-len-input",attrs:{autocomplete:"off",placeholder:"定位到小区、街道、写字楼"},model:{value:t.formData.address,callback:function(e){t.$set(t.formData,"address","string"===typeof e?e.trim():e)},expression:"formData.address"}})],1),e("el-form-item",{attrs:{label:"是否默认"}},[e("el-radio-group",{model:{value:t.formData.is_default,callback:function(e){t.$set(t.formData,"is_default",e)},expression:"formData.is_default"}},[e("el-radio",{attrs:{label:1}},[t._v("是")]),e("el-radio",{attrs:{label:0}},[t._v("否")])],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.saveAddress("ruleForm")}}},[t._v("保存")])],1)],1)],1)])],1)},r=[],s=(i("d9e2"),i("14d9"),i("69f9")),l=i("2f94"),d={name:"address_edit",components:{},data(){let t=this;var e=(t,e,i)=>{if(!e)return i(new Error("手机号不能为空"));{const t=/^1[3|4|5|6|7|8|9][0-9]{9}$/;t.test(e)?i():i(new Error("请输入正确的手机号"))}},i=(e,i,a)=>t.formData.province_id?t.formData.city_id?t.formData.district_id?a():a(new Error("请选择区/县")):a(new Error("请选择市")):a(new Error("请选择省"));return{formData:{id:0,name:"",mobile:"",telephone:"",province_id:"",city_id:"",district_id:"",community_id:"",address:"",full_address:"",latitude:0,longitude:0,is_default:1},addressValue:"",flag:!1,defaultRegions:[],rules:{name:[{required:!0,message:"请输入收货人姓名",trigger:"blur"}],mobile:[{required:!0,validator:e,trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"}],full_address:[{required:!0,validator:i,trigger:"blur"}]},province:[],city:[],district:[],pickerValueArray:[],multiIndex:[0,0,0],isInitMultiArray:!1,isLoadDefaultAreas:!1,loading:!0,yes:!0}},created(){this.formData.id=this.$route.query.id,this.getAddressDetail(),this.getDefaultAreas(0,{level:0})},mounted(){let t=this;setTimeout((function(){t.yes=!1}),300)},watch:{defaultRegions:{handler(t,e=[]){3===t.length&&t.join("")!==e.join("")&&this.handleDefaultRegions()},immediate:!0}},computed:{pickedArr(){return this.isInitMultiArray?[this.pickerValueArray[0],this.pickerValueArray[1],this.pickerValueArray[2]]:[this.pickerValueArray[0],this.city,this.district]}},methods:{changeProvice(t){this.getAreas(t,t=>this.city=t);let e={};e=this.province.find(e=>e.id===t),this.formData.city_id="",this.formData.district_id="",this.formData.full_address=e.name},changeCity(t){this.getAreas(t,t=>this.district=t);let e={};e=this.city.find(e=>e.id===t),this.formData.district_id="",this.formData.full_address=this.formData.full_address+"-"+e.name},changeDistrict(t){let e={};e=this.district.find(e=>e.id===t),this.formData.full_address=this.formData.full_address+"-"+e.name},getAddressDetail(){Object(s["d"])({id:this.formData.id}).then(t=>{let e=t.data;null!=e&&(this.formData.name=e.name,this.formData.mobile=e.mobile,this.formData.telephone=e.telephone,this.formData.address=e.address,this.formData.full_address=e.full_address,this.formData.latitude=e.latitude,this.formData.longitude=e.longitude,this.formData.is_default=e.is_default,this.formData.province_id=e.province_id,this.formData.city_id=e.city_id,this.formData.district_id=e.district_id,this.defaultRegions=[e.province_id,e.city_id,e.district_id])}).catch(t=>{})},getAreas(t,e){Object(l["a"])({pid:t}).then(t=>{if(0==t.code){var i=[];t.data.forEach((t,e)=>{i.push(t)}),e&&e(i)}}).catch(t=>{})},getDefaultAreas(t,e){Object(l["a"])({pid:t}).then(t=>{if(0==t.code){var i=[],a=void 0;t.data.forEach((t,r)=>{void 0!=e&&(0==e.level&&void 0!=e.province_id?a=e.province_id:1==e.level&&void 0!=e.city_id?a=e.city_id:2==e.level&&void 0!=e.district_id&&(a=e.district_id)),void 0==a&&0==r&&(a=t.id),i.push(t)}),this.pickerValueArray[e.level]=i,e.level+1<3?(e.level++,this.getDefaultAreas(a,e)):(this.isInitMultiArray=!0,this.isLoadDefaultAreas=!0),this.province=this.pickerValueArray[0]}this.loading=!1}).catch(t=>{this.loading=!1})},handleDefaultRegions(){var t=setInterval(()=>{if(this.isLoadDefaultAreas){this.isInitMultiArray=!1;for(let t=0;t<this.defaultRegions.length;t++)for(let e=0;e<this.pickerValueArray[t].length;e++)this.province=this.pickerValueArray[0],this.defaultRegions[t]==this.pickerValueArray[t][e].id&&(this.$set(this.multiIndex,t,e),this.getAreas(this.pickerValueArray[t][e].id,t=>{this.city=t;for(let i=0;i<this.city.length;i++)if(this.defaultRegions[1]==this.city[i].id){this.$set(this.multiIndex,1,i),this.getAreas(this.city[i].id,t=>{this.district=t;for(let a=0;a<this.district.length;a++)if(this.defaultRegions[2]==this.district[a].id){this.$set(this.multiIndex,2,a),this.handleValueChange({detail:{value:[e,i,a]}});break}});break}}));this.isLoadDefaultAreas&&clearInterval(t)}},100)},handleValueChange(t){let[e,i,a]=t.detail.value,[r,s,l]=this.pickedArr,d=[r[e],s[i],l[a]];this.formData.full_address="";for(let o=0;o<d.length;o++)this.formData.full_address?this.formData.full_address=this.formData.full_address+"-"+d[o].name:this.formData.full_address=this.formData.full_address+d[o].name},saveAddress(t){this.$refs[t].validate(t=>{if(!t)return!1;var e={name:this.formData.name,mobile:this.formData.mobile,telephone:this.formData.telephone,province_id:this.formData.province_id,city_id:this.formData.city_id,district_id:this.formData.district_id,community_id:"",address:this.formData.address,full_address:this.formData.full_address,latitude:this.formData.latitude,longitude:this.formData.longitude,is_default:this.formData.is_default,url:"add"};this.formData.id&&(e.url="edit",e.id=this.formData.id),this.flag||(this.flag=!0,Object(s["m"])(e).then(t=>{0==t.code?this.$router.push({path:"/member/delivery_address"}):(this.flag=!1,this.$message({message:t.message,type:"warning"}))}).catch(t=>{this.flag=!1,this.$message.error(t.message)}))})}}},o=d,n=(i("bfe3"),i("2877")),c=Object(n["a"])(o,a,r,!1,null,"2ac635e2",null);e["default"]=c.exports},bfe3:function(t,e,i){"use strict";i("59a5")}}]);
//# sourceMappingURL=chunk-593af713.0535a33b.js.map