(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c4a4ae4"],{"08f9":function(t,e,i){"use strict";i.d(e,"e",(function(){return n})),i.d(e,"a",(function(){return a})),i.d(e,"d",(function(){return l})),i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return r})),i.d(e,"f",(function(){return c}));var s=i("751a");function n(t){return Object(s["a"])({url:"/seckill/api/ordercreate/payment",data:t,forceLogin:!0})}function a(t){return Object(s["a"])({url:"/seckill/api/ordercreate/calculate",data:t,forceLogin:!0})}function l(t){return Object(s["a"])({url:"/seckill/api/ordercreate/create",data:t,forceLogin:!0})}function o(t){return Object(s["a"])({url:"/seckill/api/seckillgoods/page",data:t})}function r(t){return Object(s["a"])({url:"/seckill/api/seckillgoods/detail",data:t})}function c(t){return Object(s["a"])({url:"/seckill/api/seckill/lists",data:t})}},"0dec":function(t,e,i){t.exports=i("f292")},"12f2a":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"ns-seckill"},[e("el-carousel",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingAd,expression:"loadingAd"}],attrs:{height:"400px"}},t._l(t.adList,(function(i){return e("el-carousel-item",{key:i.adv_id},[e("el-image",{attrs:{src:t.$img(i.adv_image),fit:"cover"},on:{click:function(e){return t.$router.pushToTab(i.adv_url.url)}}})],1)})),1),t.timeList.length>0?e("div",{staticClass:"ns-seckill-time-wrap"},[e("div",{staticClass:"ns-seckill-time-box"},[e("span",{staticClass:"left-btn iconfont iconarrow-left-copy",on:{click:function(e){return t.changeThumbImg("prev")}}}),e("span",{staticClass:"right-btn iconfont iconarrow-right",on:{click:function(e){return t.changeThumbImg("next")}}}),e("div",{ref:"seckillTime",staticClass:"ns-seckill-time-list"},[e("ul",{staticClass:"seckill-time-ul",style:{left:t.thumbPosition+"px"}},t._l(t.timeList,(function(i,s){return e("li",{key:s,staticClass:"seckill-time-li",on:{click:function(e){return t.handleSelected(s)}}},[e("div",{staticClass:"tab-li",class:{"selected-tab":t.seckillId==i.id},attrs:{slot:"label"},slot:"label"},[e("div",[t._v(t._s(i.name))]),e("div",[s>t.index?e("p",[t._v("敬请期待")]):t._e(),s!=t.index||i.isNow?t._e():e("p",[t._v("即将开始")]),s==t.index&&i.isNow?e("p",[t._v("抢购中")]):t._e(),s<t.index?e("p",[t._v("已结束")]):t._e()])])])})),0)])])]):t._e(),t.timeList.length>0&&t.goodsList.length>0?e("div",{ref:"seckillGoods",staticClass:"ns-seckill-box"},[e("div",{staticClass:"ns-seckill-title"},[e("div",[e("i",{staticClass:"iconfont iconmiaosha1"}),e("span",[t._v(t._s(t.seckillName?t.seckillName:"敬请期待"))])]),t.seckillIndex==t.index&&t.isTrue?e("div",{staticClass:"ns-seckill-end"},[t._v(" "+t._s(t.seckillText)+" "),e("count-down",{staticClass:"count-down",attrs:{currentTime:t.seckillTimeMachine.currentTime,startTime:t.seckillTimeMachine.startTime,endTime:t.seckillTimeMachine.endTime,dayTxt:"：",hourTxt:"：",minutesTxt:"：",secondsTxt:""},on:{start_callback:function(e){return t.countDownS_cb()},end_callback:function(e){return t.countDownE_cb()}}})],1):t._e()]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[e("div",{staticClass:"goods-list"},t._l(t.goodsList,(function(i,s){return e("div",{key:s,staticClass:"item"},[e("div",{staticClass:"goods",on:{click:function(e){return t.toGoodsDetail(i.id)}}},[(t.seckillIndex==t.index&&t.timeList[t.index].isNow,e("div",{staticClass:"img"},[e("el-image",{attrs:{fit:"scale-down",src:t.goodsImg(i.goods_image),lazy:""},on:{error:function(e){return t.imageError(t.index)}}})],1)),e("div",{staticClass:"name"},[e("p",{attrs:{title:i.goods_name}},[t._v(t._s(i.goods_name))])]),e("div",{staticClass:"price"},[e("div",[e("p",[e("span",[t._v("秒杀价")]),e("span",[t._v("￥")]),e("span",{staticClass:"main_price"},[t._v(t._s(i.seckill_price))])]),e("span",{staticClass:"primary_price"},[t._v("￥"+t._s(i.price))])])]),t.seckillIndex==t.index&&t.timeList[t.index].isNow?e("el-button",[t._v("立即抢购")]):t._e()],1)])})),0)]),e("div",{staticClass:"pager"},[e("el-pagination",{attrs:{background:"","pager-count":5,total:t.total,"prev-text":"上一页","next-text":"下一页","current-page":t.currentPage,"page-size":t.pageSize,"hide-on-single-page":""},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handlePageSizeChange,"current-change":t.handleCurrentPageChange}})],1)]):t._e(),t.timeList&&t.goodsList?t._e():e("div",{staticClass:"empty-wrap"},[e("div",{staticClass:"ns-text-align"},[t._v("暂无正在进行秒杀的商品，去首页看看吧")])])],1)},n=[],a=(i("14d9"),i("08f9")),l=i("2f62"),o=i("37cb"),r=i("0dec"),c=i.n(r),d={name:"groupbuy",components:{CountDown:c.a},data:()=>({loading:!0,timeList:[],seckillId:null,seckillName:null,seckillIndex:null,goodsList:[],index:null,siteId:0,total:0,currentPage:1,pageSize:10,loadingAd:!0,adList:[],seckillTimeMachine:{currentTime:0,startTime:0,endTime:0},seckillText:"距离结束仅剩",thumbPosition:0,moveThumbLeft:!1,moveThumbRight:!1}),watch:{seckillId(t,e){console.log("dfddddddddddddddddddd"),console.log(t),console.log(e,"oldName"),t&&t!=e&&this.refresh()},addonIsExit(){1!=this.addonIsExit.seckill&&this.$message({message:"秒杀插件未安装",type:"warning",duration:2e3,onClose:()=>{this.$route.push("/")}})}},created(){this.addonIsExit&&1!=this.addonIsExit.seckill?this.$message({message:"秒杀插件未安装",type:"warning",duration:2e3,onClose:()=>{this.$route.push("/")}}):(this.getAdList(),this.getTimeList())},computed:{isTrue(){let t=0;return this.timeList&&this.timeList[this.index]&&(t=this.timeList[this.index].isNow),t},...Object(l["b"])(["defaultGoodsImage","addonIsExit"])},methods:{handleSelected(t){let e=this.timeList[t].name;t<this.index?this.$message.warning(e+"秒杀已结束"):t>this.index&&this.$message.warning(e+"秒杀未开始")},changeThumbImg(t){let e=this.$refs.seckillTime.clientWidth,i=document.querySelector(".seckill-time-ul").style.left.indexOf("px");document.querySelector(".seckill-time-ul").style.left.substring(0,i);if(this.timeList.length<7)return;let s=this.timeList.length%7,n=150;if(0==s)s=this.timeList.length-7;else if(0!=s&&1!=s&&s<2)return;if("prev"==t)0!=this.thumbPosition&&Math.round(this.thumbPosition,2)!=n&&n<Math.abs(this.thumbPosition)?this.thumbPosition+=n:this.thumbPosition=0;else if("next"==t&&Math.round(this.thumbPosition,2)!=-Math.round(n*s,2)){let t=this.timeList.length*n,i=t-e;Math.abs(this.thumbPosition)-i>=0?this.thumbPosition=-i:Math.abs(this.thumbPosition)-i<-150?this.thumbPosition-=n:this.thumbPosition=-i}},countDownS_cb(){},countDownE_cb(){this.seckillText="活动已结束"},getAdList(){Object(o["a"])({keyword:"NS_PC_SECKILL"}).then(t=>{this.adList=t.data.adv_list;for(let e=0;e<this.adList.length;e++)this.adList[e].adv_url&&(this.adList[e].adv_url=JSON.parse(this.adList[e].adv_url));this.loadingAd=!1}).catch(t=>{this.loadingAd=!1})},getTimeList(){Object(a["f"])().then(t=>{let e=t.data;if(!e)return;let i=new Date(1e3*t.timestamp),s=60*i.getHours()*60+60*i.getMinutes()+i.getSeconds();if(console.log(e,"data.list"),e.list.forEach((n,a)=>{if(n.seckill_start_time<=s&&s<n.seckill_end_time){n.isNow=!0,console.log(n,"v"),this.seckillId=n.id,this.seckillName=n.name,this.index=a,this.seckillIndex=a;let e=parseInt(i.getTime()/1e3)+(n.seckill_end_time-s);this.seckillTimeMachine={currentTime:t.timestamp,startTime:t.timestamp,endTime:e}}else this.getGoodsList(e.list[0].id),n.isNow=!1}),this.timeList=e.list,!this.seckillId)for(let n=0;n<e.list.length;n++)(s<e.list[n].seckill_start_time&&0==n||s<e.list[n].seckill_start_time&&s>e.list[n-1].seckill_end_time&&0!=n||n==e.list.length-1&&s>e.list[n].seckill_end_time)&&(this.seckillId=e.list[n].seckill_id,this.index=n,this.seckillIndex=n)}).catch(t=>{console.log(t,"err"),this.$message.error(t.message)})},getGoodsList(t){console.log("sssssssssssssssssssssssssss"),Object(a["b"])({page_size:this.pageSize,page:this.currentPage,seckill_id:t||this.seckillId,site_id:this.siteId}).then(t=>{console.log(t,"djfhsdjkfghsdjkgfkhj"),this.goodsList=t.data.list,this.total=t.data.count,this.loading=!1}).catch(t=>{this.loading=!1,this.$message.warning(t.message)})},toGoodsDetail(t){let e=new Date,i=60*e.getHours()*60+60*e.getMinutes()+e.getSeconds();this.timeList[0].seckill_start_time<=i&&i<this.timeList[0].seckill_end_time?this.timeList[0].isNow=!0:this.timeList[0].isNow=!1,this.timeList[0].isNow?this.$router.pushToTab("/promotion/seckill-"+t):this.$message.warning("秒杀活动还未开启，敬请期待！")},handlePageSizeChange(t){this.pageSize=t,this.refresh()},handleCurrentPageChange(t){this.currentPage=t,this.refresh()},refresh(){this.loading=!0,this.getGoodsList()},goodsImg(t){let e=t.split(",");return e[0]?this.$util.img(e[0],{size:"mid"}):this.defaultGoodsImage},imageError(t){this.goodsList[t].goods_image=this.defaultGoodsImage}}},h={name:"seckill",components:{},mixins:[d]},u=h,m=(i("c27c"),i("eb1d"),i("2877")),g=Object(m["a"])(u,s,n,!1,null,"20bbc722",null);e["default"]=g.exports},"48e5":function(t,e,i){},"66c3":function(t,e,i){},c27c:function(t,e,i){"use strict";i("66c3")},eb1d:function(t,e,i){"use strict";i("48e5")},f292:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",[t.msTime.show?e("p",[t.msTime.day>0?e("span",[e("span",[t._v(t._s(t.msTime.day))]),e("i",[t._v(t._s(t.dayTxt))])]):t._e(),e("span",[t._v(t._s(t.msTime.hour))]),e("i",[t._v(t._s(t.hourTxt))]),e("span",[t._v(t._s(t.msTime.minutes))]),e("i",[t._v(t._s(t.minutesTxt))]),e("span",[t._v(t._s(t.msTime.seconds))]),e("i",[t._v(t._s(t.secondsTxt))])]):t._e()])},n=[],a={replace:!0,data(){return{tipShow:!0,msTime:{show:!1,day:"",hour:"",minutes:"",seconds:""},star:"",end:"",current:""}},watch:{currentTime:function(t,e){this.gogogo()}},props:{tipText:{type:String,default:"距离开始"},tipTextEnd:{type:String,default:"距离结束"},id:{type:String,default:"1"},currentTime:{type:Number},startTime:{type:Number},endTime:{type:Number},endText:{type:String,default:"已结束"},dayTxt:{type:String,default:":"},hourTxt:{type:String,default:":"},minutesTxt:{type:String,default:":"},secondsTxt:{type:String,default:":"},secondsFixed:{type:Boolean,default:!1}},mounted(){console.log(this),this.gogogo()},methods:{gogogo:function(){10==this.startTime.toString().length?this.star=1e3*this.startTime:this.star=this.startTime,10==this.endTime.toString().length?this.end=1e3*this.endTime:this.end=this.endTime,this.currentTime?10==this.currentTime.toString().length?this.current=1e3*this.currentTime:this.current=this.currentTime:this.current=(new Date).getTime(),this.end<this.current?(this.msTime.show=!1,this.end_message()):this.current<this.star?(this.$set(this,"tipShow",!0),setTimeout(()=>{this.runTime(this.star,this.current,this.start_message)},1)):(this.end>this.current&&this.star<this.current||this.star==this.current)&&(this.$set(this,"tipShow",!1),this.msTime.show=!0,this.$emit("start_callback",this.msTime.show),setTimeout(()=>{this.runTime(this.end,this.star,this.end_message,!0)},1))},runTime(t,e,i,s){let n=this.msTime,a=t-e;if(a>0){this.msTime.show=!0,n.day=Math.floor(a/864e5),a-=864e5*n.day,n.hour=Math.floor(a/36e5),a-=36e5*n.hour,n.minutes=Math.floor(a/6e4),a-=6e4*n.minutes,n.seconds=Math.floor(a/1e3).toFixed(0),a-=1e3*n.seconds,n.hour<10&&(n.hour="0"+n.hour),n.minutes<10&&(n.minutes="0"+n.minutes),n.seconds<10&&(n.seconds="0"+n.seconds);let t=Date.now(),l=Date.now(),o=l-t;setTimeout(()=>{s?this.runTime(this.end,e+=1e3,i,!0):this.runTime(this.star,e+=1e3,i)},1e3-o)}else i()},start_message(){this.$set(this,"tipShow",!1),this.$emit("start_callback",this.msTime.show),setTimeout(()=>{this.runTime(this.end,this.star,this.end_message,!0)},1)},end_message(){this.msTime.show=!1,this.currentTime<=0||this.$emit("end_callback",this.msTime.show)}}},l=a,o=i("2877"),r=Object(o["a"])(l,s,n,!1,null,null,null);e["default"]=r.exports}}]);
//# sourceMappingURL=chunk-4c4a4ae4.8dd947c2.js.map