(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-473f1e2d"],{"1d41":function(e,t,r){"use strict";r("240f")},2189:function(e,t,r){},"240f":function(e,t,r){},"6d75":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingAd,expression:"loadingAd"}],staticClass:"ns-register-wrap",style:{background:e.backgroundColor}},[t("div",{staticClass:"el-row-wrap el-row-wrap-register",staticStyle:{position:"relative"}},[t("el-row",[t("el-col",[t("el-carousel",{staticClass:"ns-register-bg",attrs:{height:"500px"},on:{change:e.handleChange}},e._l(e.adList,(function(r){return t("el-carousel-item",{key:r.adv_id},[t("el-image",{staticStyle:{height:"500px",width:"100%"},attrs:{src:e.$img(r.adv_image),fit:"cover"},on:{click:function(t){return e.$router.pushToTab(r.adv_url.url)}}})],1)})),1)],1),t("el-col",{staticClass:"ns-register-form",staticStyle:{position:"absolute",right:"360px","z-index":"999"},attrs:{span:11}},[t("div",{staticClass:"grid-content bg-purple"},[t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"用户注册",name:"first"}},["first"==e.activeName?t("el-form",{ref:"registerRef",attrs:{model:e.registerForm,rules:e.registerRules}},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.registerForm.username,callback:function(t){e.$set(e.registerForm,"username",t)},expression:"registerForm.username"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont iconzhanghao"})])],2)],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入密码"},model:{value:e.registerForm.password,callback:function(t){e.$set(e.registerForm,"password",t)},expression:"registerForm.password"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont iconmima"})])],2)],1),t("el-form-item",{attrs:{prop:"code"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入验证码",maxlength:"4"},model:{value:e.registerForm.code,callback:function(t){e.$set(e.registerForm,"code",t)},expression:"registerForm.code"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont iconyanzhengma"})]),t("template",{slot:"append"},[t("img",{staticClass:"captcha",attrs:{src:e.captcha.img,mode:""},on:{click:e.getCode}})])],2)],1),t("el-form-item",[t("el-row",[t("el-col",{attrs:{span:12}},[t("div",{staticClass:"xy-wrap"},[t("div",{staticClass:"iconfont",class:e.ischecked?"iconxuanze-duoxuan":"iconxuanze",on:{click:e.check}}),t("div",{staticClass:"content"},[e._v(" 阅读并同意 "),t("b",{on:{click:function(t){return t.stopPropagation(),e.getAggrement.apply(null,arguments)}}},[e._v("《服务协议》")])])])])],1)],1),t("el-form-item",[t("el-button",{staticClass:"rule-button",attrs:{type:"primary"},on:{click:function(t){return e.register("registerRef")}}},[e._v(" 注册")])],1),t("el-form-item",[t("el-row",[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"bg-purple-light"},[e._v("已有账号，"),t("router-link",{staticClass:"register",attrs:{to:"/login"}},[e._v("立即登录")])],1)])],1)],1)],1):e._e()],1),e.registerConfig.register&&-1!=e.registerConfig.register.indexOf("mobile")?t("el-tab-pane",{attrs:{label:"手机动态码注册",name:"second"}},["second"==e.activeName?t("el-form",{ref:"mobileRuleForm",staticClass:"ns-register-mobile",attrs:{model:e.registerForm,rules:e.mobileRules}},[t("el-form-item",{attrs:{prop:"mobile"}},[t("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.registerForm.mobile,callback:function(t){e.$set(e.registerForm,"mobile",t)},expression:"registerForm.mobile"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont iconshouji-copy"})])],2)],1),t("el-form-item",{attrs:{prop:"code"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入验证码",maxlength:"4"},model:{value:e.registerForm.code,callback:function(t){e.$set(e.registerForm,"code",t)},expression:"registerForm.code"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont iconyanzhengma"})]),t("template",{slot:"append"},[t("img",{staticClass:"captcha",attrs:{src:e.captcha.img,mode:""},on:{click:e.getCode}})])],2)],1),t("el-form-item",{attrs:{prop:"dynacode"}},[t("el-input",{attrs:{maxlength:"4",placeholder:"请输入短信动态码"},model:{value:e.registerForm.dynacode,callback:function(t){e.$set(e.registerForm,"dynacode",t)},expression:"registerForm.dynacode"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"iconfont icondongtaima"})]),t("template",{slot:"append"},[t("div",{staticClass:"dynacode",class:120==e.dynacodeData.seconds?"ns-text-color":"ns-text-color-gray",on:{click:function(t){return e.sendMobileCode("mobileRuleForm")}}},[e._v(" "+e._s(e.dynacodeData.codeText)+" ")])])],2)],1),t("el-form-item",[t("el-row",[t("el-col",{attrs:{span:12}},[t("div",{staticClass:"xy-wrap"},[t("div",{staticClass:"iconfont",class:e.ischecked?"iconxuanze-duoxuan":"iconxuanze",on:{click:e.check}}),t("div",{staticClass:"content"},[e._v(" 阅读并同意 "),t("b",{on:{click:function(t){return t.stopPropagation(),e.getAggrement.apply(null,arguments)}}},[e._v("《服务协议》")])])])])],1)],1),t("el-form-item",[t("el-button",{staticClass:"rule-button",attrs:{type:"primary"},on:{click:function(t){return e.register("mobileRuleForm")}}},[e._v(" 注册")])],1),t("el-form-item",[t("el-row",[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"bg-purple-light toLogin",on:{click:e.toLogin}},[e._v("已有账号，立即登录")])])],1)],1)],1):e._e()],1):e._e()],1)],1)])],1),t("el-dialog",{attrs:{title:e.agreement.title,visible:e.aggrementVisible,width:"60%","before-close":e.aggrementClose,"lock-scroll":!1,center:""},on:{"update:visible":function(t){e.aggrementVisible=t}}},[t("div",{staticClass:"xyContent",domProps:{innerHTML:e._s(e.agreement.content)}})])],1)])},i=[],a=(r("d9e2"),r("14d9"),r("485b")),o=r("7401"),n=r("37cb"),c={name:"register",components:{},data(){var e=(e,t,r)=>{if(!t)return r(new Error("手机号不能为空"));{const e=/^1[3|4|5|6|7|8|9][0-9]{9}$/;e.test(t)?r():r(new Error("请输入正确的手机号"))}};let t=this;var r=function(e,r,s){let i=t.registerConfig;if(!r)return s(new Error("请输入密码"));if(i.pwd_len>0){if(r.length<i.pwd_len)return s(new Error("密码长度不能小于"+i.pwd_len+"位"));s()}else if(""!=i.pwd_complexity){let e="密码需包含",t="";if(-1!=i.pwd_complexity.indexOf("number")?(t+="(?=.*?[0-9])",e+="数字"):-1!=i.pwd_complexity.indexOf("letter")?(t+="(?=.*?[a-z])",e+="、小写字母"):-1!=i.pwd_complexity.indexOf("upper_case")?(t+="(?=.*?[A-Z])",e+="、大写字母"):-1!=i.pwd_complexity.indexOf("symbol")?(t+="(?=.*?[#?!@$%^&*-])",e+="、特殊字符"):(t+="",e+=""),t.test(r))return s(new Error(e));s()}};return{activeName:"first",registerForm:{username:"",password:"",checkPass:"",code:"",dynacode:""},registerRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,validator:r,trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}],dynacode:[{required:!0,message:"请输入短信动态码",trigger:"blur"}]},mobileRules:{mobile:[{required:!0,validator:e,trigger:"blur"}],vercode:[{required:!0,message:"请输入验证码",trigger:"blur"}],dynacode:[{required:!0,message:"请输入短信动态码",trigger:"blur"}]},codeRules:{mobile:[{required:!0,validator:e,trigger:"blur"}],vercode:[{required:!0,message:"请输入验证码",trigger:"blur"}]},ischecked:!1,agreement:"",aggrementVisible:!1,captcha:{id:"",img:""},dynacodeData:{seconds:120,timer:null,codeText:"获取动态码",isSend:!1},adList:[],loadingAd:!0,registerConfig:{},backgroundColor:""}},created(){this.getCode(),this.getAdList(),this.regisiterAggrement(),this.getRegisterConfig();let e=this;document.onkeypress=function(t){var r=document.all?event.keyCode:t.which;if(13==r)return"first"==e.activeName?e.accountLogin("ruleForm"):e.mobileLogin("mobileRuleForm"),!1}},watch:{"dynacodeData.seconds":{handler(e,t){0==e&&(clearInterval(this.dynacodeData.timer),this.dynacodeData={seconds:120,timer:null,codeText:"获取动态码",isSend:!1})},immediate:!0,deep:!0}},methods:{getAdList(){Object(n["a"])({keyword:"NS_PC_REGISTER"}).then(e=>{if(0==e.code&&e.data.adv_list){this.adList=e.data.adv_list;for(let e=0;e<this.adList.length;e++)this.adList[e].adv_url&&(this.adList[e].adv_url=JSON.parse(this.adList[e].adv_url));this.backgroundColor=this.adList[0].background}this.loadingAd=!1}).catch(e=>{this.loadingAd=!1})},handleChange(e,t){this.backgroundColor=this.adList[e].background},handleClick(e,t){"first"==this.activeName?this.registerMode="account":this.registerMode="mobile"},check(){this.ischecked=!this.ischecked},toLogin(){this.$router.push("/login")},getRegisterConfig(){Object(a["c"])().then(e=>{e.code>=0&&(this.registerConfig=e.data.value,""==this.registerConfig.register&&this.$message({message:"平台未启用注册",type:"warning",duration:2e3,onClose:()=>{this.$router.push("/")}}))}).catch(e=>{console.log(e.message)})},register(e){this.$refs[e].validate(e=>{if(!e)return!1;if(!this.ischecked)return this.$message({message:"请先阅读协议并勾选",type:"warning"});var t={username:this.registerForm.username.trim(),password:this.registerForm.password};""!=this.captcha.id&&(t.captcha_id=this.captcha.id,t.captcha_code=this.registerForm.code),this.$store.dispatch("member/register_token",t).then(e=>{e.code>=0&&this.$router.push("/member/index")}).catch(e=>{this.$message.error(e.message),this.getCode()})})},aggrementClose(){this.aggrementVisible=!1},regisiterAggrement(){Object(a["a"])().then(e=>{e.code>=0&&(this.agreement=e.data)}).catch(e=>{console.log(e.message)})},getAggrement(){this.aggrementVisible=!0},getCode(){Object(n["b"])({captcha_id:"this.captcha.id"}).then(e=>{e.code>=0&&(this.captcha=e.data,this.captcha.img=this.captcha.img.replace(/\r\n/g,""))}).catch(e=>{this.$message.error(e.message)})},sendMobileCode(e){120==this.dynacodeData.seconds&&(this.$refs[e].clearValidate("dynacode"),this.$refs[e].validateField("mobile",e=>{if(e)return!1}),this.$refs[e].validateField("code",e=>{if(e)return!1;Object(o["b"])({mobile:this.registerForm.mobile,captcha_id:this.captcha.id,captcha_code:this.registerForm.code}).then(e=>{e.code>=0&&(this.registerForm.key=e.data.key,120==this.dynacodeData.seconds&&null==this.dynacodeData.timer&&(this.dynacodeData.timer=setInterval(()=>{this.dynacodeData.seconds--,this.dynacodeData.codeText=this.dynacodeData.seconds+"s后可重新获取"},1e3)))}).catch(e=>{this.$message.error(e.message)})}))}}},l=c,d=(r("1d41"),r("8094"),r("2877")),g=Object(d["a"])(l,s,i,!1,null,"d0ad23b6",null);t["default"]=g.exports},8094:function(e,t,r){"use strict";r("2189")}}]);
//# sourceMappingURL=chunk-473f1e2d.db7d4b41.js.map