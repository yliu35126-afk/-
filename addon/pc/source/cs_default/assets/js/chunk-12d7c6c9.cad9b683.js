(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12d7c6c9"],{"0bad8":function(t,s,e){"use strict";e.r(s);e("14d9");var i=function(){var t=this,s=t._self._c;return s("div",[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"shop-index"},[s("div",{staticClass:"shop-left"},[s("div",{staticClass:"shop-wrap"},[s("div",{staticClass:"head-wrap"},[s("div",{staticClass:"img-wrap"},[s("img",{staticClass:"img-responsive center-block",attrs:{src:t.shopInfo.avatar?t.$img(t.shopInfo.avatar):t.$img(t.defaultShopImage),alt:t.shopInfo.site_name},on:{error:function(s){t.shopInfo.avatar=t.defaultShopImage}}})]),s("h5",[s("span",{staticClass:"ns-text-color"},[t._v(t._s(t.shopInfo.site_name))]),1==t.shopInfo.is_own?s("el-tag",{staticClass:"tag",attrs:{size:"small"}},[t._v("自营")]):t._e()],1)]),s("div",{staticClass:"info-wrap"},[s("div",{staticClass:"item"},[t._v(" 描述相符 "),s("b",[t._v(t._s(t.shopInfo.shop_desccredit))]),t._v("分 ")]),s("div",{staticClass:"item"},[t._v(" 服务态度 "),s("b",[t._v(t._s(t.shopInfo.shop_servicecredit))]),t._v("分 ")]),s("div",{staticClass:"item"},[t._v(" 发货速度 "),s("b",[t._v(t._s(t.shopInfo.shop_deliverycredit))]),t._v("分 ")])]),s("div",{staticClass:"other-info"},[t.shopInfo.telephone?s("div",{staticClass:"tell"},[s("div",{staticClass:"tell-name"},[t._v("电话:")]),s("div",{staticClass:"tell-detail"},[t._v(t._s(t.shopInfo.telephone))])]):t._e(),t.shopInfo.full_address?s("div",{staticClass:"item-info"},[s("div",{staticClass:"item-name"},[t._v("地址:")]),s("div",{staticClass:"item-detail"},[t._v(t._s(t.shopInfo.full_address)+t._s(t.shopInfo.address))])]):t._e()]),s("div",{staticClass:"operation"},[t.hasFollow?s("el-button",{attrs:{size:"medium"},on:{click:t.getIsFollow}},[t._v("取消关注")]):s("el-button",{attrs:{size:"medium"},on:{click:t.getIsFollow}},[t._v("关注店铺")])],1)]),s("div",{staticClass:"shop-goods-search"},[s("el-input",{staticClass:"input-with-select",attrs:{placeholder:"搜索 商品",size:"medium",maxlength:"50",clearable:""},model:{value:t.keyword,callback:function(s){t.keyword=s},expression:"keyword"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.goGoodsList},slot:"append"})],1)],1),s("div",{staticClass:"shop-goods-cate",class:{border:t.categoryList.length}},t._l(t.categoryList,(function(e){return s("div",{key:e.category_id,staticClass:"item"},[s("div",{staticClass:"menu-name",on:{click:function(s){return t.$router.push({path:"/shop_list",query:{site_id:t.id,shop_category_id:e.category_id}})}}},[t._v(t._s(e.category_name))]),t._l(e.child_list,(function(i){return s("div",{key:i.category_id,staticClass:"submenu",on:{click:function(s){return t.$router.push({path:"/shop_list",query:{site_id:t.id,shop_category_id:e.category_id}})}}},[t._v(t._s(i.category_name))])}))],2)})),0)]),s("div",{staticClass:"shop-right"},[s("div",{staticClass:"content"},[s("div",{staticClass:"shop-banner"},[s("el-carousel",{attrs:{height:"406px"}},t._l(t.adList,(function(e){return s("el-carousel-item",{key:e.adv_id},[s("el-image",{attrs:{src:t.$img(e.adv_image),fit:"cover"},on:{click:function(s){return t.$router.pushToTab(e.adv_url.url)}}})],1)})),1)],1),t.goodsList.length?s("div",{staticClass:"tj"},[s("h5",[t._v("本店推荐")])]):t._e(),s("div",{staticClass:"goods-info"},t._l(t.goodsList,(function(e,i){return s("div",{key:e.goods_id,staticClass:"item",on:{click:function(s){return t.$router.pushToTab({path:"/sku-"+e.sku_id})}}},[s("img",{staticClass:"img-wrap",attrs:{src:t.$img(e.sku_image,{size:"mid"})},on:{error:function(s){return t.imageError(i)}}}),s("div",{staticClass:"goods-name"},[t._v(t._s(e.goods_name))]),s("div",{staticClass:"price-wrap"},[s("div",{staticClass:"price"},[s("p",[t._v("￥")]),t._v(" "+t._s(e.discount_price)+" ")]),s("div",{staticClass:"market-price"},[t._v("￥"+t._s(e.market_price))])]),1==e.promotion_type?s("div",{staticClass:"promotion_type"},[t._v("限时折扣")]):t._e()])})),0),s("div",{staticClass:"pager"},[s("el-pagination",{attrs:{background:"","pager-count":5,total:t.total,"prev-text":"上一页","next-text":"下一页","current-page":t.currentPage,"page-size":t.pageSize,"hide-on-single-page":""},on:{"update:currentPage":function(s){t.currentPage=s},"update:current-page":function(s){t.currentPage=s},"update:pageSize":function(s){t.pageSize=s},"update:page-size":function(s){t.pageSize=s},"size-change":t.handlePageSizeChange,"current-change":t.handleCurrentPageChange}})],1)])])])])},a=[],o=e("8dd4"),r=e("a2a9"),d=e("2f62"),n=e("37cb"),c={name:"shop_index",components:{},data:()=>({id:0,currentPage:1,pageSize:12,shopInfo:{},hasFollow:!1,searchContent:"",categoryList:[],goodsList:[],total:0,loading:!0,keyword:"",adList:[]}),computed:{...Object(d["b"])(["token","defaultShopImage","addonIsExit","defaultGoodsImage"])},created(){this.id=this.$route.path.replace("/shop-",""),this.getAdList(),this.getShopInfo(),this.getCategoryList(),this.getGoodsList(),this.getfollow()},watch:{$route(t){this.id=t.params.pathMatch,this.getAdList(),this.getShopInfo(),this.getCategoryList(),this.getGoodsList(),this.getfollow()}},methods:{getAdList(){Object(n["a"])({keyword:"NS_PC_SHOP_INDEX"}).then(t=>{this.adList=t.data.adv_list;for(let s=0;s<this.adList.length;s++)this.adList[s].adv_url&&(this.adList[s].adv_url=JSON.parse(this.adList[s].adv_url))}).catch(t=>t)},getShopInfo(){Object(o["c"])({site_id:this.id}).then(t=>{0==t.code&&(this.shopInfo=t.data)}).catch(t=>{this.loading=!1,this.$message.error(t.message)})},getCategoryList(){Object(o["d"])({site_id:this.id}).then(t=>{this.categoryList=t.data}).catch(t=>{this.loading=!1,this.$message.error(t.message)})},getGoodsList(){const t={page:this.currentPage,page_size:this.pageSize,site_id:this.id,keyword:this.keyword,sort:"desc"};Object(r["h"])(t||{}).then(t=>{if(0==t.code&&t.data){let s=t.data;this.goodsList=s.list,this.total=t.data.count,this.loading=!1}}).catch(t=>{this.loading=!1,this.$message.error(t.message)})},getfollow(){Object(o["b"])({site_id:this.id}).then(t=>{this.hasFollow=t.data}).catch(t=>{})},getIsFollow(){this.hasFollow?Object(o["e"])({site_id:this.id}).then(t=>{0==t.code&&t.data&&(this.hasFollow=!this.hasFollow,this.$message({message:"取消关注成功",type:"success"}))}).catch(t=>{console.log(this.shopInfo,"this.shopInfo"),"token不存在"==t.message?this.$router.push({path:"/login",query:{redirect:"/shop-"+this.shopInfo.site_id}}):this.$message.error(t.message)}):Object(o["a"])({site_id:this.id}).then(t=>{0==t.code&&(this.hasFollow=!this.hasFollow,this.$message({message:"关注成功",type:"success"}))}).catch(t=>{"token不存在"==t.message?this.$router.push({path:"/login",query:{redirect:"/shop-"+this.shopInfo.site_id}}):this.$message.error(t.message)})},goGoodsList(){this.$router.push({path:"/shop_list",query:{site_id:this.id,keyword:this.keyword}})},handlePageSizeChange(t){this.pageSize=t,this.getGoodsList()},handleCurrentPageChange(t){this.currentPage=t,this.getGoodsList()},imageError(t){this.goodsList[t].sku_image=this.defaultGoodsImage}}},h=c,l=(e("5d12"),e("2877")),g=Object(l["a"])(h,i,a,!1,null,"2c8b208c",null);s["default"]=g.exports},"5d12":function(t,s,e){"use strict";e("8d83")},"8d83":function(t,s,e){}}]);
//# sourceMappingURL=chunk-12d7c6c9.cad9b683.js.map