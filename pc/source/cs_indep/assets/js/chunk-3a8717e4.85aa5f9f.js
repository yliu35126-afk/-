(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a8717e4"],{"334f":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e._self._c;return e.orderCreateData?t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.fullscreenLoading,expression:"fullscreenLoading"}]},[0==e.orderPaymentData.is_virtual?t("div",{staticClass:"item-block"},[t("div",{staticClass:"block-text"},[e._v("收货地址")]),t("div",{attrs:{clsas:"address-list"}},[t("div",{staticClass:"address-item",on:{click:e.addAddressShow}},[e._m(0)]),e._l(e.memberAddress,(function(i,s){return s<3||e.addressShow&&s>=3?t("div",{key:i.id,staticClass:"address-item",class:e.addressId==i.id?"active":""},[t("div",{staticClass:"address-info"},[t("div",{staticClass:"options"},[t("div",{on:{click:function(t){return e.editAddress(i.id)}}},[e._v("编辑")]),0==i.is_default?[t("el-popconfirm",{attrs:{title:"确定要删除该地址吗？"},on:{onConfirm:function(t){return e.deleteMemberAddress(i.id)}}},[t("div",{attrs:{slot:"reference"},slot:"reference"},[e._v("删除")])])]:e._e()],2),t("div",{staticClass:"address-name"},[e._v(e._s(i.name))]),t("div",{staticClass:"address-mobile",on:{click:function(t){return e.setMemberAddress(i.id)}}},[e._v(e._s(i.mobile))]),t("div",{staticClass:"address-desc",on:{click:function(t){return e.setMemberAddress(i.id)}}},[e._v(e._s(i.full_address)+" "+e._s(i.address))])])]):e._e()})),e.memberAddress.length>3&&!e.addressShow?t("div",{staticClass:"el-button--text address-open",on:{click:function(t){e.addressShow=!0}}},[t("i",{staticClass:"el-icon-arrow-down"}),e._v(" 更多收货地址 ")]):e._e(),t("div",{staticClass:"clear"})],2)]):e._e(),1==e.orderPaymentData.is_virtual?t("div",{staticClass:"item-block"},[t("div",{staticClass:"block-text"},[e._v("购买虚拟类商品需填写您的手机号，以方便商家与您联系")]),t("el-form",{ref:"form",staticClass:"mobile-wrap",attrs:{size:"mini","label-width":"80px"}},[t("el-form-item",{attrs:{label:"手机号码"}},[t("el-input",{attrs:{placeholder:"请输入您的手机号码",maxlength:"11"},model:{value:e.orderCreateData.member_address.mobile,callback:function(t){e.$set(e.orderCreateData.member_address,"mobile",t)},expression:"orderCreateData.member_address.mobile"}})],1)],1)],1):e._e(),t("el-dialog",{attrs:{title:0==e.addressForm.id?"添加收货地址":"编辑收货地址",visible:e.dialogVisible,width:"32%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"form",attrs:{rules:e.addressRules,model:e.addressForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"姓名",prop:"name"}},[t("el-input",{attrs:{placeholder:"收货人姓名"},model:{value:e.addressForm.name,callback:function(t){e.$set(e.addressForm,"name",t)},expression:"addressForm.name"}})],1),t("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[t("el-input",{attrs:{maxlength:"11",placeholder:"收货人手机号"},model:{value:e.addressForm.mobile,callback:function(t){e.$set(e.addressForm,"mobile",t)},expression:"addressForm.mobile"}})],1),t("el-form-item",{attrs:{label:"电话"}},[t("el-input",{attrs:{placeholder:"收货人固定电话（选填）"},model:{value:e.addressForm.telephone,callback:function(t){e.$set(e.addressForm,"telephone",t)},expression:"addressForm.telephone"}})],1),t("el-form-item",{staticClass:"area",attrs:{label:"地区",prop:"area"}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:7}},[t("el-select",{ref:"province",attrs:{prop:"province",placeholder:"请选择省"},on:{change:function(t){return e.getAddress(1)}},model:{value:e.addressForm.province_id,callback:function(t){e.$set(e.addressForm,"province_id",t)},expression:"addressForm.province_id"}},[t("el-option",{attrs:{label:"请选择省",value:"0"}}),e._l(e.pickerValueArray,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1),t("el-col",{attrs:{span:7}},[t("el-select",{ref:"city",attrs:{prop:"city",placeholder:"请选择市"},on:{change:function(t){return e.getAddress(2)}},model:{value:e.addressForm.city_id,callback:function(t){e.$set(e.addressForm,"city_id",t)},expression:"addressForm.city_id"}},[t("el-option",{attrs:{label:"请选择市",value:"0"}}),e._l(e.cityArr,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1),t("el-col",{attrs:{span:7}},[t("el-select",{ref:"district",attrs:{prop:"district",placeholder:"请选择区/县"},model:{value:e.addressForm.district_id,callback:function(t){e.$set(e.addressForm,"district_id",t)},expression:"addressForm.district_id"}},[t("el-option",{attrs:{label:"请选择区/县",value:"0"}}),e._l(e.districtArr,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1)],1)],1),t("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[t("el-input",{attrs:{placeholder:"定位小区、街道、写字楼"},model:{value:e.addressForm.address,callback:function(t){e.$set(e.addressForm,"address",t)},expression:"addressForm.address"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addmemberAddress("form")}}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"添加发票信息",visible:e.invoiceVisible,width:"32%"},on:{"update:visible":function(t){e.invoiceVisible=t}}},[t("el-form",{ref:"invoiceForm",attrs:{model:e.invoiceForm,rules:e.invoiceRules,"label-width":"150px"}},[t("el-form-item",{attrs:{label:"发票类型",prop:"invoice_type"}},[t("el-radio-group",{model:{value:e.invoiceForm.invoice_type,callback:function(t){e.$set(e.invoiceForm,"invoice_type",t)},expression:"invoiceForm.invoice_type"}},e._l(e.paperData,(function(i,s){return t("el-radio",{key:s,attrs:{label:i.value}},[e._v(e._s(i.name))])})),1)],1),t("el-form-item",{attrs:{label:"发票抬头类型",prop:"invoice_title_type"}},[t("el-radio-group",{model:{value:e.invoiceForm.invoice_title_type,callback:function(t){e.$set(e.invoiceForm,"invoice_title_type",t)},expression:"invoiceForm.invoice_title_type"}},e._l(e.enterpriseData,(function(i,s){return t("el-radio",{key:s,attrs:{label:i.value}},[e._v(e._s(i.name))])})),1)],1),t("el-form-item",{attrs:{label:"请填写抬头名称",prop:"invoice_title"}},[t("el-input",{model:{value:e.invoiceForm.invoice_title,callback:function(t){e.$set(e.invoiceForm,"invoice_title",t)},expression:"invoiceForm.invoice_title"}})],1),2==e.invoiceForm.invoice_title_type?t("el-form-item",{attrs:{label:"请填写纳税人识别号",prop:"taxpayer_number"}},[t("el-input",{model:{value:e.invoiceForm.taxpayer_number,callback:function(t){e.$set(e.invoiceForm,"taxpayer_number",t)},expression:"invoiceForm.taxpayer_number"}})],1):e._e(),1==e.invoiceForm.invoice_type?t("el-form-item",{attrs:{label:"请填写发票邮寄地址",prop:"invoice_full_address"}},[t("el-input",{model:{value:e.invoiceForm.invoice_full_address,callback:function(t){e.$set(e.invoiceForm,"invoice_full_address",t)},expression:"invoiceForm.invoice_full_address"}})],1):e._e(),2==e.invoiceForm.invoice_type?t("el-form-item",{attrs:{label:"请填写接收邮箱",prop:"invoice_email"}},[t("el-input",{model:{value:e.invoiceForm.invoice_email,callback:function(t){e.$set(e.invoiceForm,"invoice_email",t)},expression:"invoiceForm.invoice_email"}})],1):e._e(),t("el-form-item",{attrs:{label:"发票内容",prop:"invoice_content"}},[t("el-radio-group",{model:{value:e.invoiceForm.invoice_content,callback:function(t){e.$set(e.invoiceForm,"invoice_content",t)},expression:"invoiceForm.invoice_content"}},[t("el-radio",{attrs:{label:"办公用品"}}),t("el-radio",{attrs:{label:"数码"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.invoiceVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addmemberInvoice("invoiceForm")}}},[e._v("确 定")])],1)],1),e.orderPaymentData.member_account.balance_total>0?t("div",{staticClass:"item-block"},[t("div",{staticClass:"block-text"},[e._v("是否使用余额")]),t("div",{staticClass:"pay-type-list"},[t("div",{staticClass:"pay-type-item",class:e.orderCreateData.is_balance?"":"active",on:{click:function(t){return e.useBalance(0)}}},[e._v("不使用余额")]),t("div",{staticClass:"pay-type-item",class:e.orderCreateData.is_balance?"active":"",on:{click:function(t){return e.useBalance(1)}}},[e._v("使用余额")]),t("div",{staticClass:"clear"})])]):e._e(),e._m(1),t("div",[t("div",{staticClass:"item-block"},[t("div",{staticClass:"goods-list"},[t("table",[t("tr",[t("td",{attrs:{colspan:"5"}},[t("router-link",{attrs:{to:"/shop-"+e.orderPaymentData.shop_goods_list.site_id,target:"_blank"}},[e._v(" "+e._s(e.orderPaymentData.shop_goods_list.site_name)+" ")])],1)])])])]),t("div",{staticClass:"item-block"},[t("div",{staticClass:"goods-list"},[t("table",e._l(e.orderPaymentData.shop_goods_list.goods_list,(function(i,s){return t("tr",{key:s},[t("td",{attrs:{width:"70%"}},[t("div",{staticClass:"goods-info"},[t("div",{staticClass:"goods-info-left"},[t("router-link",{attrs:{to:{path:"/sku-"+i.sku_id},target:"_blank"}},[t("img",{staticClass:"goods-img",attrs:{src:e.$img(i.sku_image,{size:"mid"})},on:{error:function(t){return e.imageError(s)}}})])],1),t("div",{staticClass:"goods-info-right"},[t("router-link",{attrs:{to:{path:"/sku-"+i.sku_id},target:"_blank"}},[t("div",{staticClass:"goods-name"},[e._v(e._s(i.sku_name))])])],1)])]),t("td",{staticClass:"goods-price",attrs:{width:"15%"}},[e._v("￥"+e._s(i.price))]),t("td",{staticClass:"goods-num",attrs:{width:"15%"}},[e._v(e._s(i.num))])])})),0),t("div",{staticClass:"goods-footer"},[t("div",{staticClass:"goods-footer-left"},[0==e.orderPaymentData.is_virtual?t("div",[t("div",{staticClass:"order-cell"},[t("div",{staticClass:"tit"},[e._v(" 配送方式 "),t("span",{staticClass:"ns-text-color"},["store"==e.orderPaymentData.delivery.delivery_type&&e.orderPaymentData.delivery.store_name?t("span",[e._v(" "+e._s(e.orderPaymentData.delivery.store_name)+" ")]):e._e()])]),e.orderPaymentData.shop_goods_list.express_type.length>0?t("div",e._l(e.orderPaymentData.shop_goods_list.express_type,(function(i,s){return"local"!=i.name?t("div",{key:s,staticClass:"express-item",class:e.orderCreateData.delivery.delivery_type==i.name?"active":"",on:{click:function(t){return e.selectDeliveryType(i)}}},[e._v(" "+e._s(i.title)+" ")]):e._e()})),0):0==e.memberAddress.length?t("div",[t("div",{staticClass:"box ns-text-color"},[e._v("请先添加收货地址")])]):t("div",[t("div",{staticClass:"box ns-text-color"},[e._v("商家未配置配送方式")])])])]):e._e(),e.orderPaymentData.shop_goods_list.coupon_list.length?t("div",[t("div",{staticClass:"order-cell"},[t("div",{staticClass:"tit"},[e._v("优惠券")]),e.orderPaymentData.coupon.coupon_id?t("div",[t("span",{staticClass:"ns-text-color",on:{click:function(t){return e.openSiteCoupon(e.orderPaymentData.shop_goods_list.coupon_list)}}},[e._v("已选择优惠券，已优惠")]),t("span",{staticClass:"ns-text-color",on:{click:function(t){return e.openSiteCoupon(e.orderPaymentData.shop_goods_list.coupon_list)}}},[t("span",{staticClass:"inline"},[e._v("￥")]),e._v(" "+e._s(e.orderPaymentData.coupon_money)+" ")])]):t("div",[t("div",{staticClass:"box ns-text-color",on:{click:function(t){return e.openSiteCoupon(e.orderPaymentData.shop_goods_list.coupon_list)}}},[e._v("不使用优惠券")])])])]):e._e(),e.orderPaymentData.shop_goods_list.promotion?t("div",[t("div",{staticClass:"order-cell"},[t("div",{staticClass:"tit"},[e._v("店铺优惠")]),e.orderPaymentData.shop_goods_list.promotion.manjian?t("div",{staticClass:"box text-overflow"},[t("span",{staticClass:"ns-text-color"},[e._v("满减")]),e._l(e.orderPaymentData.shop_goods_list.promotion.manjian,(function(i,s){return t("span",{key:s,staticClass:"ns-text-color"},[e._v(" "+e._s(i.discount_array.desc)+" ")])}))],2):e._e(),e.orderPaymentData.shop_goods_list.promotion.freeshipping?t("div",{staticClass:"box text-overflow"},[t("span",{staticClass:"ns-text-color"},[e._v("满额包邮")]),e.orderPaymentData.shop_goods_list.promotion.freeshipping.discount_array?t("span",{staticClass:"ns-text-color"},[e._v(" "+e._s(e.orderPaymentData.shop_goods_list.promotion.freeshipping.discount_array.desc)+" ")]):e._e()]):e._e()])]):e._e(),t("div",[t("div",{staticClass:"order-cell"},[t("div",{staticClass:"tit"},[e._v("活动优惠")]),t("div",{staticClass:"box text-overflow"},[t("span",{staticClass:"ns-text-color"},[e._v("组合套餐 "+e._s(e.orderPaymentData.bunding_info.bl_name)+" 优惠￥"+e._s(e._f("moneyFormat")(e.promotionMoney)))])])])])]),t("div",{staticClass:"goods-footer-right"},[t("div",[t("div",{staticClass:"order-cell"},[t("div",{staticClass:"tit"},[e._v("买家留言")]),t("div",{staticClass:"box"},[t("el-input",{staticClass:"buyer-message",attrs:{type:"textarea",placeholder:"留言前建议先与商家协调一致",maxlength:"140","show-word-limit":"",resize:"none"},on:{input:e.textarea},model:{value:e.orderCreateData.buyer_message,callback:function(t){e.$set(e.orderCreateData,"buyer_message",t)},expression:"orderCreateData.buyer_message"}})],1),t("span",{staticClass:"iconfont iconright"})])])]),t("div",{staticClass:"clear"}),1==e.orderPaymentData.shop_goods_list.invoice_status?t("div",{staticClass:"item-block"},[t("div",{staticClass:"block-text"},[e._v("发票")]),t("div",{staticClass:"pay-type-list"},[t("div",{staticClass:"pay-type-item",class:1==e.orderPaymentData.is_invoice?"":"active",on:{click:function(t){return e.isInvoice(0)}}},[e._v("不开票")]),t("div",{staticStyle:{display:"inline-block"},on:{click:e.editInvoice}},[t("div",{staticClass:"pay-type-item",class:1==e.orderPaymentData.is_invoice?"active":"",on:{click:function(t){return e.isInvoice(1)}}},[e._v(" 开票"),t("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-left":"5px"}})])]),t("div",{staticClass:"clear"})])]):e._e()])])])]),e.orderPaymentData&&e.orderPaymentData.platform_coupon_list&&e.orderPaymentData.platform_coupon_list.length>0?t("div",{staticClass:"item-block"},[t("div",{staticClass:"block-text"},[e._v("平台优惠券")]),t("div",{staticClass:"order-cell platform-coupon"},[e.orderCreateData.platform_coupon_id?t("div",[t("span",{staticClass:"ns-text-color",on:{click:e.openPlatformCoupon}},[e._v("已选择优惠券，已优惠")]),t("span",{staticClass:"ns-text-color",on:{click:e.openPlatformCoupon}},[t("span",{staticClass:"inline"},[e._v("￥")]),e._v(" "+e._s(e.orderPaymentData.platform_coupon_money)+" ")])]):t("div",[t("div",{staticClass:"box ns-text-color",on:{click:e.openPlatformCoupon}},[e._v("不使用优惠券")])])])]):e._e(),t("div",{staticClass:"item-block"},[t("div",{staticClass:"order-statistics"},[t("table",[t("tr",[t("td",{attrs:{align:"right"}},[e._v("商品金额：")]),t("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.goods_money)))])]),0==e.orderPaymentData.is_virtual?t("tr",[t("td",{attrs:{align:"right"}},[e._v("运费：")]),t("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.delivery_money)))])]):e._e(),e.orderPaymentData.invoice_money>0?t("tr",[t("td",{attrs:{align:"right"}},[e._v("税费：")]),t("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.invoice_money)))])]):e._e(),e.orderPaymentData.promotion_money>0?t("tr",[t("td",{attrs:{align:"right"}},[e._v("优惠：")]),t("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.promotion_money)))])]):e._e(),e.orderPaymentData.coupon_money>0?t("tr",[t("td",{attrs:{align:"right"}},[e._v("店铺优惠券：")]),t("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.coupon_money)))])]):e._e(),e.orderPaymentData.platform_coupon_money>0?t("tr",[t("td",{attrs:{align:"right"}},[e._v("平台优惠券：")]),t("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.platform_coupon_money)))])]):e._e(),e.orderPaymentData.balance_money>0?t("tr",[t("td",{attrs:{align:"right"}},[e._v("使用余额：")]),t("td",{attrs:{align:"left"}},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.balance_money)))])]):e._e()])]),t("div",{staticClass:"clear"})]),t("div",{staticClass:"item-block"},[t("div",{staticClass:"order-submit"},[t("div",{staticClass:"order-money"},[e._v(" 共"+e._s(e.orderPaymentData.goods_num)+"件，应付金额： "),t("div",{staticClass:"ns-text-color"},[e._v("￥"+e._s(e._f("moneyFormat")(e.orderPaymentData.pay_money)))])]),t("el-button",{staticClass:"el-button--primary",attrs:{type:"primary"},on:{click:e.orderCreate}},[e._v("订单结算")])],1),t("div",{staticClass:"clear"})]),t("el-dialog",{attrs:{title:"选择门店",visible:e.dialogStore,width:"50%"},on:{"update:visible":function(t){e.dialogStore=t}}},[t("el-table",{ref:"singleTable",staticClass:"cursor-pointer",attrs:{data:e.storeList,"highlight-current-row":""},on:{"row-click":e.selectStore}},[t("el-table-column",{attrs:{label:"",width:"55"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-radio",{attrs:{label:i.row},model:{value:e.storeRadio,callback:function(t){e.storeRadio=t},expression:"storeRadio"}},[t("i")])]}}],null,!1,3524537448)}),t("el-table-column",{attrs:{prop:"store_name",label:"名称",width:"160"}}),t("el-table-column",{attrs:{prop:"store_address",label:"地址"}}),t("el-table-column",{attrs:{prop:"open_date",label:"营业时间"}})],1)],1),t("el-dialog",{attrs:{title:"选择平台优惠券",visible:e.dialogPlatcoupon,width:"50%"},on:{"update:visible":function(t){e.dialogPlatcoupon=t},close:function(t){return e.savePlatformCoupon()}}},[t("el-table",{ref:"platformCouponTable",staticClass:"cursor-pointer",attrs:{data:e.orderPaymentData.platform_coupon_list,"highlight-current-row":""},on:{"row-click":e.selectPlatformCoupon}},[t("el-table-column",{attrs:{label:"",width:"55"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticClass:"disabled-selected-wrap"},[t("el-radio",{attrs:{label:i.row},model:{value:e.platformCouponRadio,callback:function(t){e.platformCouponRadio=t},expression:"platformCouponRadio"}},[t("i")])],1)]}}],null,!1,1762543642)}),t("el-table-column",{attrs:{prop:"platformcoupon_name",label:"名称",width:"200"}}),t("el-table-column",{attrs:{prop:"money",label:"优惠"}}),t("el-table-column",{attrs:{label:"使用"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.at_least>0?t("span",{staticClass:"ns-text-color-gray ns-font-size-sm"},[e._v("满"+e._s(i.row.at_least)+"可用")]):t("span",{staticClass:"ns-text-color-gray ns-font-size-sm"},[e._v("任意金额可用")])]}}],null,!1,2379210086)}),t("el-table-column",{attrs:{label:"期限"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(e.$util.timeStampTurnTime(i.row.end_time)))])]}}],null,!1,1700963242)})],1),t("br"),t("div",{staticClass:"align-right"},[t("el-button",{on:{click:function(t){e.dialogPlatcoupon=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogPlatcoupon=!1}}},[e._v("确认选择")])],1)],1),t("el-dialog",{attrs:{title:"选择优惠券",visible:e.dialogCoupon,width:"50%"},on:{"update:visible":function(t){e.dialogCoupon=t},close:function(t){return e.saveCoupon()}}},[t("el-table",{ref:"couponTable",staticClass:"cursor-pointer",attrs:{data:e.siteCoupon.data,"highlight-current-row":""},on:{"row-click":e.selectCoupon}},[t("el-table-column",{attrs:{label:"",width:"55"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticClass:"disabled-selected-wrap"},[t("el-radio",{attrs:{label:i.row},model:{value:e.couponRadio,callback:function(t){e.couponRadio=t},expression:"couponRadio"}},[t("i")])],1)]}}],null,!1,4020218309)}),t("el-table-column",{attrs:{prop:"coupon_name",label:"名称",width:"200"}}),t("el-table-column",{attrs:{label:"优惠"},scopedSlots:e._u([{key:"default",fn:function(i){return["reward"==i.row.type?t("span",[e._v(e._s(i.row.money))]):e._e(),"discount"==i.row.type?t("span",[e._v(e._s(i.row.discount)+" 折")]):e._e()]}}],null,!1,1573022624)}),t("el-table-column",{attrs:{prop:"use",label:"使用"}}),t("el-table-column",{attrs:{prop:"time",label:"期限"}})],1),t("br"),t("div",{staticClass:"align-right"},[t("el-button",{on:{click:function(t){e.dialogCoupon=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogCoupon=!1}}},[e._v("确认选择")])],1)],1),t("el-dialog",{attrs:{title:"送达时间",visible:e.deliveryTime,width:"400px"},on:{"update:visible":function(t){e.deliveryTime=t}}},[t("el-form",{ref:"ruleForm",attrs:{"status-icon":"","label-width":"100px"}},[t("el-form-item",{attrs:{label:"送达时间"}},[t("el-col",{attrs:{span:11}},[t("el-time-picker",{attrs:{format:"HH:mm","value-format":"HH:mm",placeholder:"选择时间",value:e.time,start:"09:01",end:"21:01"},on:{change:e.bindTimeChange},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1)],1),t("el-form-item",{attrs:{label:""}},[t("el-col",{attrs:{span:20}},[t("div",{staticClass:"align-right"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.deliveryTime=!1}}},[e._v("关闭")]),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.setDeliveryTime(e.siteDelivery.site_id)}}},[e._v("确认选择")])],1)])],1)],1)],1),t("el-dialog",{attrs:{title:"使用余额",visible:e.dialogpay,width:"350px"},on:{"update:visible":function(t){e.dialogpay=t}}},[0==e.orderPaymentData.member_account.is_pay_password?[t("p",[e._v("为了您的账户安全,请您先设置的支付密码")]),t("p",[e._v('可到"会员中心","账号安全","支付密码"中设置')]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogpay=!1}}},[e._v("暂不设置")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.setPayPassword}},[e._v("立即设置")])],1)]:t("el-form",{ref:"ruleForm",attrs:{"status-icon":"","label-width":"100px"}},[t("el-form-item",{staticClass:"pay-password-item",attrs:{label:"支付密码"}},[t("el-input",{staticClass:"pay-password hide-password",attrs:{type:"password",maxlength:6}}),t("el-input",{staticClass:"pay-password",attrs:{type:"password",maxlength:6},on:{input:e.input},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),t("p",{staticClass:"ns-text-color forget-password",on:{click:e.setPayPassword}},[e._v("忘记密码")])],1)],2)],1):e._e()},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"add-address"},[t("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加收货地址 ")])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"item-block"},[t("div",{staticClass:"goods-list"},[t("table",[t("tr",[t("td",{attrs:{width:"70%"}},[e._v("商品")]),t("td",{attrs:{width:"15%"}},[e._v("价格")]),t("td",{attrs:{width:"15%"}},[e._v("数量")])])])])])}],o=i("86bd"),r=(i("d9e2"),i("14d9"),i("b090")),n=i("69f9"),l=i("8f8b"),d=i("2f94"),c=i("2f62"),m={name:"combo_payment",components:{},data:()=>{var e=(e,t,i)=>{""===t?i(new Error("请输入手机号")):/^1[3|4|5|6|7|8|9][0-9]{9}$/.test(t)?i():i(new Error("手机号格式错误"))};return{dialogVisible:!1,invoiceVisible:!1,memberAddress:{},invoiceList:[],siteId:"",addressId:0,addressForm:{id:0,name:"",mobile:"",telephone:"",province_id:"",city_id:"",district_id:"",community_id:"",address:"",full_address:"",is_default:"",longitude:"",latitude:""},invoiceForm:{invoice_type:1,invoice_title_type:1,invoice_content:"",invoice_title:"",taxpayer_number:"",invoice_full_address:"",invoice_email:""},paperData:[{name:"纸质发票",value:1},{name:"电子发票",value:2}],enterpriseData:[{name:"个人",value:1},{name:"企业",value:2}],pickerValueArray:{},cityArr:{},districtArr:{},addressRules:{name:[{required:!0,message:"请输入收货人",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],mobile:[{required:!0,validator:e,trigger:"change"}],province:[{required:!0,message:"请选择省",trigger:"change"}],city:[{required:!0,message:"请选择市",trigger:"change"}],district:[{required:!0,message:"请选择区/县",trigger:"change"}],address:[{required:!0,message:"请输入详细地址",trigger:"change"}]},invoiceRules:{invoice_type:[{required:!0,message:"请选择发票类型",trigger:"change"}],invoice_title_type:[{required:!0,message:"请选择发票抬头类型",trigger:"change"}],invoice_content:[{required:!0,message:"请选择发票内容",trigger:"change"}],invoice_title:[{required:!0,message:"请填写抬头名称",trigger:"blur"}],taxpayer_number:[{required:!0,message:"请填写纳税人识别号",trigger:"blur"}],invoice_full_address:[{required:!0,message:"请填写发票邮寄地址",trigger:"blur"}],invoice_email:[{required:!0,message:"请填写发票接收邮箱",trigger:"blur"}]},isSend:!1,orderCreateData:{is_balance:0,pay_password:""},orderPaymentData:{goods_money:0,pay_money:0,shop_goods_list:{site_name:"",express_type:[],coupon_list:[]},bunding_info:{bl_name:""},member_account:{balance:0,is_pay_password:0},platform_coupon_list:[]},dialogCoupon:!1,siteCoupon:{site_id:0,data:[]},siteDelivery:{site_id:0,data:[]},dialogStore:!1,promotionInfo:!1,storeList:{},sitePromotion:[],isSub:!1,dialogpay:!1,password:"",fullscreenLoading:!0,deliveryTime:!1,timeTip:"选择配送时间",time:null,selectCouponId:0,addressShow:!1,storeRadio:!1,couponRadio:!1,dialogPlatcoupon:!1,platformCouponRadio:0}},computed:{...Object(c["b"])(["comboOrderCreateData","defaultGoodsImage","city"]),promotionMoney(){return this.orderPaymentData.bunding_info.goods_money-this.orderPaymentData.bunding_info.bl_price},themeStyle(){return"theme-"+this.$store.state.themeStyle}},mounted(){},created(){this.getMemberAddress(),this.getOrderPaymentData()},filters:{moneyFormat(e){return e||(e=0),parseFloat(e).toFixed(2)},promotion(e){let t="";return e&&Object.keys(e).forEach(i=>{t+=e[i].content+"　"}),t}},methods:{getMemberAddress(){Object(n["e"])({page_size:0}).then(e=>{const{code:t,message:i,data:s}=e;if(s&&s.list){let e=this;this.memberAddress=s.list,s.list.forEach((function(t){1==t.is_default&&(e.addressId=t.id)}))}}).catch(e=>{const{code:t,message:i,data:s}=e;this.$message.error(i)})},setMemberAddress(e){this.addressId=e,Object(n["n"])({id:e}).then(e=>{const{code:t,message:i,data:s}=e;this.orderCalculate()}).catch(e=>{const{code:t,message:i,data:s}=e;this.$message.error(i)})},deleteMemberAddress(e){Object(n["i"])({id:e}).then(e=>{const{code:t,message:i,data:s}=e;s?(this.$message({message:i,type:"success"}),this.getMemberAddress()):this.$message({message:i,type:"warning"})}).catch(e=>{this.$message.error(e.message)})},addAddressShow(){this.dialogVisible=!0,this.addressForm.id=0,this.addressForm.name="",this.addressForm.mobile="",this.addressForm.telephone="",this.addressForm.province_id="",this.addressForm.city_id="",this.addressForm.district_id="",this.addressForm.community_id="",this.addressForm.address="",this.addressForm.full_address="",this.addressForm.is_default="",this.addressForm.longitude="",this.addressForm.latitude="",this.cityArr={},this.districtArr={},this.getAddress(0)},getAddress(e){let t=0,i=this;switch(e){case 0:t=0;break;case 1:t=this.addressForm.province_id,i.cityArr={},i.districtArr={},this.addressForm.city_id="",this.addressForm.district_id="";break;case 2:t=this.addressForm.city_id,i.districtArr={},this.addressForm.district_id="";break}Object(d["a"])({pid:t}).then(t=>{const{code:s,message:a,data:o}=t;if(o)switch(e){case 0:i.pickerValueArray=o;break;case 1:i.cityArr=o;break;case 2:i.districtArr=o;break}}).catch(e=>{const{code:t,message:i,data:s}=e;this.$message.error(i)})},initAddress(e){let t=0,i=this;switch(e){case 0:t=0;break;case 1:t=this.addressForm.province_id,i.cityArr={},i.districtArr={};break;case 2:t=this.addressForm.city_id,i.districtArr={};break}Object(d["a"])({pid:t}).then(t=>{const{code:s,message:a,data:o}=t;if(o)switch(e){case 0:i.pickerValueArray=o;break;case 1:i.cityArr=o;break;case 2:i.districtArr=o;break}}).catch(e=>{const{code:t,message:i,data:s}=e;this.$message.error(i)})},addmemberAddress(e){this.$refs[e].validate(e=>{if(!e)return!1;if(this.isSend)return!1;if(this.addressForm.id){this.addressForm.full_address=this.$refs.province.selectedLabel+"-"+this.$refs.city.selectedLabel+"-"+this.$refs.district.selectedLabel;let e=this.addressForm;if(!e.province_id)return this.$message({message:"请选择省",type:"warning"}),!1;if(!e.city_id)return this.$message({message:"请选择市",type:"warning"}),!1;if(!e.district_id)return this.$message({message:"请选择区/县",type:"warning"}),!1;this.isSend=!0,this.setMemberAddress(e.id),e.url="edit",Object(n["m"])(e).then(e=>{const{code:t,message:i,data:s}=e;s?(this.$message({message:i,type:"success"}),this.dialogVisible=!1,this.getMemberAddress(),this.getOrderPaymentData()):this.$message({message:i,type:"warning"}),this.isSend=!1}).catch(e=>{const{code:t,message:i,data:s}=e;this.$message.error(i)})}else{this.addressForm.full_address=this.$refs.province.selectedLabel+"-"+this.$refs.city.selectedLabel+"-"+this.$refs.district.selectedLabel;let e={name:this.addressForm.name,mobile:this.addressForm.mobile,telephone:this.addressForm.telephone,province_id:this.addressForm.province_id,city_id:this.addressForm.city_id,district_id:this.addressForm.district_id,community_id:"",address:this.addressForm.address,full_address:this.addressForm.full_address,longitude:this.addressForm.longitude,latitude:this.addressForm.latitude,is_default:this.addressForm.is_default,url:"add"};if(!e.province_id||e.province_id<=0)return this.$message({message:"请选择省",type:"warning"}),!1;if(!e.city_id||e.city_id<=0)return this.$message({message:"请选择市",type:"warning"}),!1;if(!e.district_id||e.district_id<=0)return this.$message({message:"请选择区/县",type:"warning"}),!1;this.isSend=!0,Object(n["m"])(e).then(e=>{const{code:t,message:i,data:s}=e;s?(this.setMemberAddress(s),this.$message({message:i,type:"success"}),this.dialogVisible=!1,this.getMemberAddress(),this.getOrderPaymentData()):this.$message({message:i,type:"warning"}),this.isSend=!1}).catch(e=>{const{code:t,message:i,data:s}=e;this.$message.error(i)})}})},addmemberInvoice(e){this.invoiceList.invoice_type=this.invoiceForm.invoice_type,this.invoiceList.invoice_title_type=this.invoiceForm.invoice_title_type,this.invoiceList.invoice_content=this.invoiceForm.invoice_content,this.invoiceList.invoice_title=this.invoiceForm.invoice_title,this.invoiceList.taxpayer_number=this.invoiceForm.taxpayer_number,this.invoiceList.invoice_full_address=this.invoiceForm.invoice_full_address,this.invoiceList.invoice_email=this.invoiceForm.invoice_email,(1!=this.invoiceList.invoice_type||1!=this.invoiceList.invoice_title_type||""!=this.invoiceList.invoice_full_address&&""!=this.invoiceList.invoice_title&&""!=this.invoiceForm.invoice_content)&&(1!=this.invoiceList.invoice_type||2!=this.invoiceList.invoice_title_type||""!=this.invoiceList.invoice_full_address&&""!=this.invoiceList.invoice_title&&""!=this.invoiceList.taxpayer_number&&""!=this.invoiceForm.invoice_content)&&(2!=this.invoiceList.invoice_type||1!=this.invoiceList.invoice_title_type||""!=this.invoiceList.invoice_email&&""!=this.invoiceList.invoice_title&&""!=this.invoiceForm.invoice_content)&&(2!=this.invoiceList.invoice_type||2!=this.invoiceList.invoice_title_type||""!=this.invoiceList.invoice_email&&""!=this.invoiceList.invoice_title&&""!=this.invoiceList.taxpayer_number&&""!=this.invoiceForm.invoice_content)&&(this.orderPaymentData.shop_goods_list.invoice_type=this.invoiceForm.invoice_type,this.invoiceVisible=!1)},editInvoice(){this.invoiceVisible=!0},editAddress(e){Object(n["d"])({id:e}).then(e=>{const{code:t,message:i,data:s}=e;this.addressForm={id:s.id,name:s.name,mobile:s.mobile,telephone:s.telephone,province_id:s.province_id,city_id:"",district_id:"",community_id:"",address:s.address,full_address:s.full_address,is_default:s.is_default,longitude:s.longitude,latitude:s.latitude},this.initAddress(0),this.initAddress(1),this.addressForm.city_id=s.city_id,this.initAddress(2),this.addressForm.district_id=s.district_id,this.dialogVisible=!0}).catch(e=>{const{code:t,message:i,data:s}=e;this.$message.error(i)})},getOrderPaymentData(){this.orderCreateData=this.comboOrderCreateData,this.orderCreateData?(this.orderCreateData.web_city=this.city?this.city.id:0,Object(l["d"])(this.orderCreateData).then(e=>{const{code:t,message:i,data:s}=e;if(t>=0){this.orderPaymentData=e.data;let t=JSON.parse(JSON.stringify(s.shop_goods_list)),i={};Object.values(t).forEach((e,t)=>{this.invoiceList=i}),Object.values(this.invoiceList).forEach((e,t)=>{e.invoice_type=this.invoiceForm.invoice_type,e.invoice_title_type=this.invoiceForm.invoice_title_type,e.invoice_content=this.invoiceForm.invoice_content,e.invoice_title=this.invoiceForm.invoice_title,e.taxpayer_number=this.invoiceForm.taxpayer_number,e.invoice_full_address=this.invoiceForm.invoice_full_address,e.invoice_email=this.invoiceForm.invoice_email}),this.handlePaymentData()}else this.$message({message:"未获取到创建订单所需数据！",type:"warning",offset:225,duration:3e3,onClose:()=>(this.$router.go(-1),!1)})}).catch(e=>{const{code:t,message:i,data:s}=e;this.$message.error(i)})):this.$message({message:"未获取到创建订单所需数据！",type:"warning",offset:225,duration:3e3,onClose:()=>(this.$router.go(-1),!1)})},handlePaymentData(){this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.is_balance=0,this.orderCreateData.pay_password="";var e=this.orderPaymentData;this.platCouponList=e.platform_coupon_list,this.platCouponList.length>0&&(this.orderCreateData.platform_coupon_id=this.platCouponList[0].platformcoupon_id,this.selectPlatCouponId=this.platCouponList[0].platformcoupon_id,this.selectPlatCouponMoney=this.platCouponList[0].money);let t=(new Date).getHours().toString(),i=(new Date).getMinutes().toString();1==t.length&&(t="0"+t),1==i.length&&(i="0"+i);let s=t+":"+i;if(e.shop_goods_list.local_config&&(e.shop_goods_list.local_config.info&&1==e.shop_goods_list.local_config.info.time_is_open?(this.orderCreateData.delivery.showTimeBar=!0,this.orderCreateData.delivery.buyer_ask_delivery_time=s):this.orderCreateData.delivery.showTimeBar=!1),void 0!=e.shop_goods_list.express_type&&void 0!=e.shop_goods_list.express_type[0]){var a=e.shop_goods_list.express_type;this.orderCreateData.delivery.delivery_type=a[0].name,this.orderCreateData.delivery.delivery_type_name=a[0].title,this.orderCreateData.delivery.store_id=0,"store"==a[0].name&&void 0!=a[0].store_list[0]&&(this.orderCreateData.delivery.store_id=a[0].store_list[0].store_id)}if(void 0!=e.shop_goods_list.coupon_list&&void 0!=e.shop_goods_list.coupon_list[0]){var o=e.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=o[0].coupon_id,this.orderCreateData.coupon.coupon_money=o[0].money,this.selectCouponId=o[0].coupon_id}Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate()},orderCalculate(){this.fullscreenLoading=!0;let e=this.orderPaymentData.shop_goods_list.site_id;var t={};t[e]=this.orderCreateData.delivery;var i={};i[e]=this.orderCreateData.coupon;var s={};s[e]=this.orderCreateData.buyer_message;var a=this.$util.deepClone(this.orderCreateData);a.delivery=JSON.stringify(t),a.coupon=JSON.stringify(i),a.buyer_message=JSON.stringify(s),a.member_address=JSON.stringify(a.member_address),Object(l["a"])(a).then(e=>{const{code:t,message:i,data:s}=e;t>=0?(this.orderPaymentData.delivery_money=e.data.delivery_money,this.orderPaymentData.coupon_money=e.data.coupon_money,this.orderPaymentData.invoice_money=e.data.invoice_money,this.orderPaymentData.promotion_money=e.data.promotion_money,this.orderPaymentData.order_money=e.data.order_money,this.orderPaymentData.balance_money=e.data.balance_money,this.orderPaymentData.pay_money=e.data.pay_money,this.orderPaymentData.goods_money=e.data.goods_money,this.orderPaymentData.platform_coupon_money=e.data.platform_coupon_money,this.fullscreenLoading=!1):this.$message({message:i,type:"warning",offset:225,duration:3e3,onClose:()=>(this.$router.go(-1),!1)})}).catch(e=>{const{code:t,message:i,data:s}=e;this.$message.error(i),this.fullscreenLoading=!1})},selectDeliveryType(e){this.orderCreateData.delivery.delivery_type=e.name,this.orderCreateData.delivery.delivery_type_name=e.title,"store"==e.name?(e.store_list.forEach((function(t,i){e.store_list[i]["store_address"]=t.full_address+t.address})),void 0!=e.store_list[0]&&(this.orderCreateData.delivery.store_id=e.store_list[0].store_id),this.dialogStore=!0,this.storeList=e.store_list):"local"==e.name&&(this.deliveryTime=!0),Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate()},selectStore(e){if(!e)return;let t=e.store_id;this.dialogStore=!1,this.orderCreateData.delivery[this.siteDelivery.site_id].store_id=t,this.orderCreateData.delivery[this.siteDelivery.site_id].store_name=e.store_name,Object.assign(this.orderPaymentData,this.orderCreateData),this.storeRadio=e,this.orderCalculate(),this.$forceUpdate()},openPlatformCoupon(){let e=0,t=this;this.dialogPlatcoupon=!0,this.orderPaymentData.platform_coupon_list.forEach((function(i,s){i.platformcoupon_id==t.orderCreateData.platform_coupon_id&&(e=i)})),setTimeout((function(){t.setPlatformCurrent(e),t.platformCouponRadio=e}),50)},setPlatformCurrent(e){this.$refs.platformCouponTable.setCurrentRow(e),void 0==e&&this.orderCalculate()},savePlatformCoupon(){this.dialogPlatcoupon=!1,this.orderCalculate()},selectPlatformCoupon(e){e?this.orderCreateData.platform_coupon_id!=e.platformcoupon_id?(this.orderPaymentData.platform_coupon_id=e.platformcoupon_id,this.orderCreateData.platform_coupon_id=e.platformcoupon_id,this.orderPaymentData.platform_coupon_money=e.money,this.orderCreateData.platform_coupon_money=e.money,this.platformCouponRadio=e):(this.platformCouponRadio="",this.orderPaymentData.platform_coupon_id=0,this.orderCreateData.platform_coupon_id=0,this.orderPaymentData.platform_coupon_money="0.00",this.orderCreateData.platform_coupon_money="0.00"):(this.orderPaymentData.platform_coupon_id=0,this.orderCreateData.platform_coupon_id=0,this.orderPaymentData.platform_coupon_money="0.00",this.orderCreateData.platform_coupon_money="0.00",this.platformCouponRadio=""),Object.assign(this.orderPaymentData,this.orderCreateData),this.$forceUpdate()},openSiteCoupon(e){this.tempData={coupon:this.$util.deepClone(this.orderPaymentData.coupon)},this.selectCouponId=this.orderCreateData.coupon.coupon_id;let t=0,i=this;e.forEach((function(s,a){s.at_least>0?e[a]["use"]="满"+s.at_least+"可用":e[a]["use"]="任意金额可用",e[a]["time"]=timeStampTurnTime(s.end_time),s.coupon_id==i.selectCouponId&&(t=s)})),this.siteCoupon.data=e,this.dialogCoupon=!0,setTimeout((function(){i.setCurrent(t),i.couponRadio=t}),50)},selectCoupon(e){e&&this.orderCreateData.coupon.coupon_id!=e.coupon_id?(this.orderCreateData.coupon.coupon_id=e.coupon_id,this.orderCreateData.coupon.coupon_money=e.money,this.couponRadio=e):(this.orderCreateData.coupon.coupon_id=0,this.orderCreateData.coupon.coupon_money="0.00",this.couponRadio=""),Object.assign(this.orderPaymentData,this.orderCreateData),this.$forceUpdate()},setCurrent(e){this.$refs.couponTable.setCurrentRow(e),void 0==e&&(this.orderCreateData.coupon.coupon_id=0,this.orderCreateData.coupon.coupon_money="0.00",this.couponRadio="",this.orderCalculate())},saveCoupon(e){this.dialogCoupon=!1,this.orderCalculate()},openSitePromotion(e){this.sitePromotion=e,this.promotionInfo?this.promotionInfo=!1:this.promotionInfo=!0},useBalance(e){0==e?this.orderCreateData.is_balance=0:1==e&&(this.orderCreateData.is_balance=1),this.orderCalculate(),this.$forceUpdate()},isInvoice(e,t){0==e?this.orderPaymentData.is_invoice=0:1==e&&(this.orderPaymentData.is_invoice=1),this.orderCalculate(),this.$forceUpdate()},orderCreate(){if(this.verify()){if(this.isSub)return;this.isSub=!0;var e=this.$loading({lock:!0,text:"订单提交中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});let o=this.orderPaymentData.shop_goods_list.site_id;var t={};t[o]=this.orderCreateData.delivery;var i={};i[o]=this.orderCreateData.coupon;var s={};s[o]=this.orderCreateData.buyer_message;var a=this.$util.deepClone(this.orderCreateData);a.delivery=JSON.stringify(t),a.coupon=JSON.stringify(i),a.buyer_message=JSON.stringify(s),a.member_address=JSON.stringify(a.member_address),a.invoice=JSON.stringify(this.invoiceList),Object(l["c"])(a).then(t=>{const{code:i,message:s,data:a}=t;e.close(),i>=0?(this.$store.dispatch("order/removeComboOrderCreateData",""),0==this.orderPaymentData.pay_money?this.$router.push({path:"/result",query:{code:a}}):this.$router.push({path:"/pay",query:{code:a}})):this.$message({message:s,type:"warning"})}).catch(t=>{e.close(),this.isSub=!1;const{code:i,message:s,data:a}=t;this.$message.error(s)})}},verify(){return this.orderPaymentData.member_address?"{}"==JSON.stringify(this.orderCreateData.delivery)?(this.$message({message:"店铺未设置配送方式",type:"warning"}),!1):"store"!=this.orderCreateData.delivery.delivery_type||0!=this.orderCreateData.delivery.store_id||(this.$message({message:"店铺没有可提货的门店,请选择其他配送方式",type:"warning"}),!1):(this.$message({message:"请先选择您的收货地址",type:"warning"}),!1)},input(){if(6==this.password.length){var e=this.$loading({lock:!0,text:"支付中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(r["b"])({pay_password:this.password}).then(t=>{const{code:i,message:s,data:a}=t;e.close(),i>=0?(this.orderCreateData.pay_password=this.password,this.orderCreate(),this.dialogpay=!1):this.$message({message:s,type:"warning"})}).catch(t=>{e.close();const{code:i,message:s,data:a}=t;this.$message.error(s)})}},textarea(){this.$forceUpdate()},bindTimeChange(e){this.time=e,this.orderCreateData.delivery.buyer_ask_delivery_time=this.time},setDeliveryTime(){this.deliveryTime=!1,this.orderCreateData.delivery.buyer_ask_delivery_time=this.time},imageError(e){this.orderPaymentData.shop_goods_list.goods_list[e].sku_image=this.defaultGoodsImage},setPayPassword(){this.$router.pushToTab("/member/security")}}},u={name:"combo_payment",components:{PicZoom:o["a"]},mixins:[m]},h=u,p=(i("d1b7"),i("2877")),_=Object(p["a"])(h,s,a,!1,null,"aa9feb16",null);t["default"]=_.exports},4037:function(e,t,i){"use strict";i("7cf1")},"5c03":function(e,t,i){},"7cf1":function(e,t,i){},"86bd":function(e,t,i){"use strict";var s=function(){var e=this,t=e._self._c;return t("div",{ref:e.id,staticClass:"magnifier-box",class:e.vertical?"vertical":"",on:{mousemove:e.mousemove,mouseover:e.mouseover,mouseleave:e.mouseleave}},[t("img",{directives:[{name:"show",rawName:"v-show",value:e.showImg,expression:"showImg"}],attrs:{src:e.imgUrl,alt:""}}),t("div",{staticClass:"mouse-cover"}),e.showEidt?t("div",{staticClass:"edit-wrap"},[t("span",{staticClass:"rotate-left",on:{click:function(t){return e.rotate("left")}}}),t("span",{staticClass:"rotate-right",on:{click:function(t){return e.rotate("right")}}})]):e._e()])},a=[],o={props:{scale:{type:Number,default:2.5},url:{type:String,required:!0},bigUrl:{type:String,default:null},scroll:{type:Boolean,default:!1},showEidt:{type:Boolean,default:!1}},data(){return{id:null,cover:null,imgbox:null,imgwrap:null,orginUrl:null,bigImgUrl:null,bigOrginUrl:null,imgUrl:null,img:null,canvas:null,ctx:null,rectTimesX:0,rectTimesY:0,imgTimesX:0,imgTimesY:0,init:!1,step:0,bigStep:0,vertical:!1,showImg:!0}},created(){var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",t=e.length,i="";for(let s=0;s<10;s++)i+=e.charAt(Math.floor(Math.random()*t));this.id=i,this.imgUrl=this.url,this.orginUrl=this.url,this.bigImgUrl=this.bigUrl,this.bigOrginUrl=this.bigUrl},watch:{url:function(e){this.imgUrl=e,this.orginUrl=e,this.initTime()},bigUrl:function(){this.bigImgUrl=bigUrl,this.bigOrginUrl=bigUrl,this.initTime()}},mounted(){this.$nextTick(()=>{this.initTime()})},methods:{initTime(){this.init=!1;let e,t=this.$refs[this.id];this.imgbox=t,this.cover=t.querySelector(".mouse-cover"),this.cover.style.width=this.imgbox.offsetWidth/this.scale+"px",this.cover.style.height=this.imgbox.offsetHeight/this.scale+"px",this.cover.style.left="-100%",this.cover.style.top="-100%",this.imgwrap=t.querySelector("img"),e=this.bigImgUrl?this.bigImgUrl:this.imgUrl,this.img=new Image,this.img.src=e,this.img.onload=()=>{this.rectTimesX=this.imgbox.offsetWidth/this.scale/this.imgwrap.offsetWidth,this.rectTimesY=this.imgbox.offsetHeight/this.scale/this.imgwrap.offsetHeight,this.imgTimesX=this.img.width/this.imgwrap.offsetWidth,this.imgTimesY=this.img.height/this.imgwrap.offsetHeight,this.vertical=this.img.width<this.img.height,this.init=!0},this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.canvas=document.createElement("canvas"),this.canvas.className="mouse-cover-canvas",this.canvas.style.position="absolute",this.canvas.style.left=this.imgbox.offsetLeft+this.imgbox.offsetWidth+10+"px",this.canvas.style.top=this.imgbox.offsetTop+"px",this.canvas.style.border="1px solid #eee",this.canvas.style.zIndex="99999",this.canvas.height=this.imgbox.offsetHeight,this.canvas.width=this.imgbox.offsetWidth,this.canvas.style.display="none",document.body.append(this.canvas),this.ctx=this.canvas.getContext("2d"),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},initBox(){this.showImg=!1,this.canvas.style.display="none";let e,t=this.$refs[this.id];e=this.bigImgUrl?this.bigImgUrl:this.imgUrl,this.img=new Image,this.img.src=e,this.img.onload=()=>{this.vertical=this.img.width<this.img.height,this.showImg=!0;t.querySelector("img");setTimeout(()=>{this.rectTimesX=this.imgbox.offsetWidth/this.scale/t.querySelector("img").offsetWidth,this.rectTimesY=this.imgbox.offsetHeight/this.scale/t.querySelector("img").offsetHeight},20)}},mousemove(e){if(!this.init)return!1;let t=this;function i(e){var t=null,i=null,s=e.offsetParent;t+=e.offsetLeft,i+=e.offsetTop;while(s)-1===navigator.userAgent.indexOf("MSIE 8.0")&&(t+=s.clientLeft,i+=s.clientTop),t+=s.offsetLeft,i+=s.offsetTop,s=s.offsetParent;return{left:t,top:i}}function s(e){return{x:e.clientX-t.cover.offsetWidth/2,y:e.clientY-t.cover.offsetHeight/2}}let a=e||event,o=s(a),r=i(this.imgwrap),n={minX:r.left,maxX:r.left+this.imgwrap.offsetWidth-this.cover.offsetWidth,minY:r.top-document.documentElement.scrollTop,maxY:r.top-document.documentElement.scrollTop+this.imgwrap.offsetHeight-this.cover.offsetHeight};o.x>n.maxX&&(o.x=n.maxX),o.x<n.minX&&(o.x=n.minX),o.y>n.maxY&&(o.y=n.maxY),o.y<n.minY&&(o.y=n.minY),this.cover.style.left=o.x+"px",this.cover.style.top=o.y+"px",this.ctx.clearRect(0,0,this.imgwrap.offsetWidth,this.imgwrap.offsetHeight);let l=o.x-(r.left-document.documentElement.scrollLeft),d=o.y-(r.top-document.documentElement.scrollTop);this.ctx.drawImage(this.img,l*this.imgTimesX,d*this.imgTimesY,this.img.width*this.rectTimesX,this.img.height*this.rectTimesY,0,0,this.imgbox.offsetWidth,this.imgbox.offsetHeight)},mouseover(e){if(!this.init)return!1;e=e||event,this.scroll||(e.currentTarget.addEventListener("mousewheel",(function(e){e.preventDefault()}),!1),e.currentTarget.addEventListener("DOMMouseScroll",(function(e){e.preventDefault()}),!1)),this.cover.style.display="block",this.canvas.style.display="block"},mouseleave(){if(!this.init)return!1;this.cover.style.display="none",this.canvas.style.display="none"},rotate(e){var t=new Image;if(t.crossOrigin="Anonymous",t.src=this.orginUrl,t.onload=()=>{this.rotateImg(t,e,this.step)},this.bigOrginUrl){var i=new Image;t.crossOrigin="Anonymous",i.src=this.bigOrginUrl,i.onload=()=>{this.rotateImg(i,e,this.bigStep,!0)}}},rotateImg(e,t,i,s=!1){var a=0,o=3;if(null!=e){var r=e.height,n=e.width;null==i&&(i=a),"right"==t?(i++,i>o&&(i=a)):(i--,i<a&&(i=o));var l=document.createElement("canvas"),d=90*i*Math.PI/180,c=l.getContext("2d");switch(l.width=r,l.height=n,c.rotate(d),c.drawImage(e,0,-r),i){case 0:l.width=n,l.height=r,c.drawImage(e,0,0);break;case 1:l.width=r,l.height=n,c.rotate(d),c.drawImage(e,0,-r);break;case 2:l.width=n,l.height=r,c.rotate(d),c.drawImage(e,-n,-r);break;case 3:l.width=r,l.height=n,c.rotate(d),c.drawImage(e,-n,0);break}var m=l.toDataURL();s?(this.bigImgUrl=m,this.bigStep=i,this.initBox()):(this.imgUrl=m,this.step=i,this.$nextTick(()=>{this.initBox()}))}}}},r=o,n=(i("4037"),i("2877")),l=Object(n["a"])(r,s,a,!1,null,"69c01ff0",null);t["a"]=l.exports},"8f8b":function(e,t,i){"use strict";i.d(t,"d",(function(){return a})),i.d(t,"a",(function(){return o})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return n}));var s=i("751a");function a(e){return Object(s["a"])({url:"/bundling/api/ordercreate/payment",data:e,forceLogin:!0})}function o(e){return Object(s["a"])({url:"/bundling/api/ordercreate/calculate",data:e,forceLogin:!0})}function r(e){return Object(s["a"])({url:"/bundling/api/ordercreate/create",data:e,forceLogin:!0})}function n(e){return Object(s["a"])({url:"/bundling/api/bundling/detail",data:e})}},b090:function(e,t,i){"use strict";i.d(t,"d",(function(){return a})),i.d(t,"a",(function(){return o})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return n}));var s=i("751a");function a(e){return Object(s["a"])({url:"/api/ordercreate/payment",data:e,forceLogin:!0})}function o(e){return Object(s["a"])({url:"/api/ordercreate/calculate",data:e,forceLogin:!0})}function r(e){return Object(s["a"])({url:"/api/ordercreate/create",data:e,forceLogin:!0})}function n(e){return Object(s["a"])({url:"/api/member/checkpaypassword",data:e,forceLogin:!0})}},d1b7:function(e,t,i){"use strict";i("5c03")}}]);
//# sourceMappingURL=chunk-3a8717e4.85aa5f9f.js.map