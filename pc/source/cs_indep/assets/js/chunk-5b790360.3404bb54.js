(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b790360"],{"0fc1":function(e,t,a){"use strict";a("7e05")},"7e05":function(e,t,a){},a135:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingAd,expression:"loadingAd"}],staticClass:"ns-login-wrap",style:{background:e.backgroundColor}},[a("div",{staticClass:"el-row-wrap el-row-wrap-login",staticStyle:{position:"relative"}},[a("el-col",[a("el-carousel",{staticClass:"ns-login-bg",attrs:{height:"530px"},on:{change:e.handleChange}},e._l(e.adList,(function(t){return a("el-carousel-item",{key:t.adv_id},[a("el-image",{staticStyle:{height:"530px",width:"100%"},attrs:{src:e.$img(t.adv_image),fit:"cover"},on:{click:function(a){return e.$router.pushToTab(t.adv_url.url)}}})],1)})),1)],1),a("el-row",{staticStyle:{position:"absolute",right:"360px","z-index":"999"}},[a("el-col",{staticClass:"ns-login-form",attrs:{span:11}},[a("div",{staticClass:"grid-content bg-purple login_tab"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"账号登录",name:"first"}},["first"==e.activeName?a("el-form",{ref:"ruleForm",attrs:{model:e.formData,rules:e.accountRules}},[a("el-form-item",{attrs:{prop:"account"}},[a("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.formData.account,callback:function(t){e.$set(e.formData,"account",t)},expression:"formData.account"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"iconfont iconzhanghao"})])],2)],1),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入登录密码"},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"iconfont iconmima"})])],2)],1),1==e.shop_pc_reception_login?a("el-form-item",{attrs:{prop:"vercode"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入验证码",maxlength:"4"},model:{value:e.formData.vercode,callback:function(t){e.$set(e.formData,"vercode",t)},expression:"formData.vercode"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"iconfont iconyanzhengma"})]),a("template",{slot:"append"},[a("img",{staticClass:"captcha",attrs:{src:e.captcha.img,mode:""},on:{click:e.getCaptcha}})])],2)],1):e._e(),a("el-form-item",[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-checkbox",{model:{value:e.formData.checked,callback:function(t){e.$set(e.formData,"checked",t)},expression:"formData.checked"}},[e._v("七天自动登录")])],1),a("el-col",{staticClass:"ns-forget-pass",attrs:{span:12}},[a("router-link",{attrs:{to:"/find_pass"}},[e._v("忘记密码?")])],1)],1)],1),a("el-form-item",[a("el-button",{staticClass:"rule-button",attrs:{type:"primary"},on:{click:function(t){return e.accountLogin("ruleForm")}}},[e._v(" 登录")])],1),a("el-form-item",[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"bg-purple-light"},[e._v("没有账号？"),a("router-link",{staticClass:"register",attrs:{to:"/register"}},[e._v("立即注册")])],1)])],1)],1)],1):e._e()],1),e.registerConfig.register&&-1!=e.registerConfig.register.indexOf("mobile")?a("el-tab-pane",{attrs:{label:"手机动态码登录",name:"second"}},["second"==e.activeName?a("el-form",{ref:"mobileRuleForm",staticClass:"ns-login-mobile",attrs:{model:e.formData,rules:e.mobileRules}},[a("el-form-item",{attrs:{prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.formData.mobile,callback:function(t){e.$set(e.formData,"mobile",t)},expression:"formData.mobile"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"iconfont iconshouji-copy"})])],2)],1),a("el-form-item",{attrs:{prop:"vercode"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入验证码",maxlength:"4"},model:{value:e.formData.vercode,callback:function(t){e.$set(e.formData,"vercode",t)},expression:"formData.vercode"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"iconfont iconyanzhengma"})]),a("template",{slot:"append"},[a("img",{staticClass:"captcha",attrs:{src:e.captcha.img,mode:""},on:{click:e.getCaptcha}})])],2)],1),a("el-form-item",{attrs:{prop:"dynacode"}},[a("el-input",{attrs:{maxlength:"4",placeholder:"请输入短信动态码"},model:{value:e.formData.dynacode,callback:function(t){e.$set(e.formData,"dynacode",t)},expression:"formData.dynacode"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"iconfont icondongtaima"})]),a("template",{slot:"append"},[a("div",{staticClass:"dynacode",class:120==e.dynacodeData.seconds?"ns-text-color":"ns-text-color-gray",on:{click:function(t){return e.sendMobileCode("mobileRuleForm")}}},[e._v(" "+e._s(e.dynacodeData.codeText)+" ")])])],2)],1),a("el-form-item",[a("el-button",{staticClass:"rule-button",attrs:{type:"primary"},on:{click:function(t){return e.mobileLogin("mobileRuleForm")}}},[e._v("登录")])],1),a("el-form-item",[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"bg-purple-light"},[a("router-link",{attrs:{to:"/register"}},[a("p",{staticClass:"register"},[e._v("立即注册")])]),a("i",{staticClass:"iconfont iconarrow-right"})],1)])],1)],1)],1):e._e()],1):e._e()],1)],1)])],1)],1)])},r=[],i=(a("ac1f"),a("5319"),a("7401")),c=a("37cb"),s={data:function(){var e=function(e,t,a){if(!t)return a(new Error("手机号不能为空"));var o=/^1[3|4|5|6|7|8|9][0-9]{9}$/;o.test(t)?a():a(new Error("请输入正确的手机号"))};return{loginMode:"account",activeName:"first",formData:{account:"",password:"",vercode:"",mobile:"",dynacode:"",key:"",checked:!1,autoLoginRange:7},captcha:{id:"",img:""},dynacodeData:{seconds:120,timer:null,codeText:"获取动态码",isSend:!1},isSub:!1,registerConfig:{is_enable:1},accountRules:{account:[{required:!0,message:"请输入登录账号",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"}],vercode:[{required:!0,message:"请输入验证码",trigger:"blur"}]},mobileRules:{mobile:[{required:!0,validator:e,trigger:"blur"}],vercode:[{required:!0,message:"请输入验证码",trigger:"blur"}],dynacode:[{required:!0,message:"请输入短信动态码",trigger:"blur"}]},codeRules:{mobile:[{required:!0,validator:e,trigger:"blur"}],vercode:[{required:!0,message:"请输入验证码",trigger:"blur"}]},loadingAd:!0,adList:[],shop_pc_reception_login:0,backgroundColor:""}},created:function(){this.getAdList(),this.getCaptcha(),this.getRegisterConfig(),this.getCaptchaConfig();var e=this;document.onkeypress=function(t){var a=document.all?event.keyCode:t.which;if(13==a)return"first"==e.activeName?e.accountLogin("ruleForm"):e.mobileLogin("mobileRuleForm"),!1}},watch:{"dynacodeData.seconds":{handler:function(e,t){0==e&&(clearInterval(this.dynacodeData.timer),this.dynacodeData={seconds:120,timer:null,codeText:"获取动态码",isSend:!1})},immediate:!0,deep:!0}},methods:{getAdList:function(){var e=this;Object(c["a"])({keyword:"NS_PC_LOGIN"}).then((function(t){if(0==t.code&&t.data.adv_list){e.adList=t.data.adv_list,console.log(e.adList,"0");for(var a=0;a<e.adList.length;a++)e.adList[a].adv_url&&(e.adList[a].adv_url=JSON.parse(e.adList[a].adv_url));e.backgroundColor=e.adList[0].background}e.loadingAd=!1})).catch((function(t){e.loadingAd=!1}))},handleClick:function(e,t){"first"==this.activeName?this.loginMode="account":this.loginMode="mobile"},handleChange:function(e,t){this.backgroundColor=this.adList[e].background},accountLogin:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var a={username:t.formData.account,password:t.formData.password};""!=t.captcha.id&&(a.captcha_id=t.captcha.id,a.captcha_code=t.formData.vercode),t.formData.checked&&(a.autoLoginRange=t.formData.autoLoginRange),t.isSub||(t.isSub=!0,t.$store.dispatch("member/login",a).then((function(e){if(e.code>=0)if(t.$message({message:"登录成功！",type:"success"}),t.$route.query.redirect){t.$route.query.redirect,t.$route.query;t.$router.push(t.$route.query.redirect)}else t.$router.push({name:"member"});else t.isSub=!1,t.getCaptcha(),t.$message({message:e.message,type:"warning"})})).catch((function(e){t.isSub=!1,t.$message.error(e.message),t.getCaptcha()})))}))},mobileLogin:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var a={mobile:t.formData.mobile,key:t.formData.key,code:t.formData.dynacode};""!=t.captcha.id&&(a.captcha_id=t.captcha.id,a.captcha_code=t.formData.vercode),t.isSub||(t.isSub=!0,t.$store.dispatch("member/mobile_login",a).then((function(e){e.code>=0?(t.$message({message:"登录成功！",type:"success"}),t.$route.query.redirect?t.$router.push(t.$route.query.redirect):t.$router.push({name:"member"})):(t.isSub=!1,t.getCaptcha(),t.$message({message:e.message,type:"warning"}))})).catch((function(e){t.isSub=!1,t.$message.error(e.message),t.getCaptcha()})))}))},getRegisterConfig:function(){var e=this;Object(i["f"])().then((function(t){t.code>=0&&(e.registerConfig=t.data.value,-1!=e.registerConfig.register.indexOf("username")?e.loginMode="account":e.loginMode="mobile")})).catch((function(e){console.log(e.message)}))},getCaptcha:function(){var e=this;Object(c["b"])({captcha_id:this.captcha.id}).then((function(t){t.code>=0&&(e.captcha.id=t.data.id,e.captcha.img=t.data.img,e.captcha.img=e.captcha.img.replace(/\r\n/g,""))})).catch((function(t){e.$message.error(t.message)}))},getCaptchaConfig:function(){var e=this;Object(c["c"])().then((function(t){t.code>=0&&(e.shop_pc_reception_login=t.data.value.shop_pc_reception_login)})).catch((function(t){e.$message.error(t.message)}))},sendMobileCode:function(e){var t=this;120==this.dynacodeData.seconds&&(this.$refs[e].clearValidate("dynacode"),this.$refs[e].validateField("mobile",(function(e){if(e)return!1})),this.$refs[e].validateField("vercode",(function(e){if(e)return!1;Object(i["b"])({mobile:t.formData.mobile,captcha_id:t.captcha.id,captcha_code:t.formData.vercode}).then((function(e){e.code>=0&&(t.formData.key=e.data.key,120==t.dynacodeData.seconds&&null==t.dynacodeData.timer&&(t.dynacodeData.timer=setInterval((function(){t.dynacodeData.seconds--,t.dynacodeData.codeText=t.dynacodeData.seconds+"s后可重新获取"}),1e3)))})).catch((function(e){t.$message.error(e.message)}))})))}}},n={name:"login",mixins:[s]},l=n,d=(a("0fc1"),a("c6e2"),a("2877")),u=Object(d["a"])(l,o,r,!1,null,"4286b6ba",null);t["default"]=u.exports},c6e2:function(e,t,a){"use strict";a("d4cb")},d4cb:function(e,t,a){}}]);
//# sourceMappingURL=chunk-5b790360.3404bb54.js.map