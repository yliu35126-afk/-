{"version":3,"sources":["webpack:///./src/views/goods/coupon.vue?57bf","webpack:///./src/views/goods/coupon.vue","webpack:///src/views/goods/coupon.vue","webpack:///./src/views/goods/coupon.vue?1a84","webpack:///./src/views/goods/coupon.vue?6510","webpack:///./src/api/coupon.js"],"names":["render","_vm","this","_c","_self","staticClass","_m","on","myCoupon","_v","directives","name","rawName","value","loadingAd","expression","attrs","_l","adList","item","key","adv_id","$img","adv_image","$event","$router","pushToTab","adv_url","url","handleClick","model","activeName","callback","$$v","loading","couponList","index","discount","_s","money","coupon_name","platformcoupon_name","site_name","_e","at_least","validity_type","fixed_term","$timeStampTurnTime","end_time","couponTap","useState","length","total","currentPage","pageSize","handlePageSizeChange","handleCurrentPageChange","staticRenderFns","components","data","couponBtnSwitch","created","addonIsExit","coupon","$message","message","type","duration","onClose","$route","push","getAdList","getCanReceiveCouponQuery","computed","mapGetters","watch","methods","keyword","then","res","adv_list","i","JSON","parse","catch","err","tab","event","page","page_size","list","count","forEach","v","error","size","receiveCoupon","toGoodsList","site_id","coupon_type_id","platformcoupon_type_id","msg","code","is_exist","$forceUpdate","goods_type","path","query","couponId","use_scenario","platformcouponTypeId","component","couponTypeList","params","http","couponReceive","forceLogin"],"mappings":"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","file":"assets/js/chunk-152b89fb.11f4d770.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/sass-resources-loader/lib/loader.js??ref--9-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./coupon.vue?vue&type=style&index=0&id=568b56a8&prod&lang=scss&scoped=true\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"ns-coupon\"},[_c('div',{staticClass:\"ns-coupon-info\"},[_c('div',{staticClass:\"ns-coupon-wrap\"},[_vm._m(0),_vm._m(1),_c('el-button',{on:{\"click\":_vm.myCoupon}},[_vm._v(\"我的优惠券\")])],1),_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loadingAd),expression:\"loadingAd\"}],staticClass:\"ns-coupon-img\"},[_c('el-carousel',{attrs:{\"height\":\"406px\"}},_vm._l((_vm.adList),function(item){return _c('el-carousel-item',{key:item.adv_id},[_c('el-image',{attrs:{\"src\":_vm.$img(item.adv_image),\"fit\":\"cover\"},on:{\"click\":function($event){return _vm.$router.pushToTab(item.adv_url.url)}}})],1)}),1)],1)]),_c('el-tabs',{on:{\"tab-click\":_vm.handleClick},model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('el-tab-pane',{attrs:{\"label\":\"店铺优惠券\",\"name\":\"first\"}}),_c('el-tab-pane',{attrs:{\"label\":\"平台优惠券\",\"name\":\"second\"}}),_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}]},[_c('ul',{staticClass:\"ns-coupon-list\"},_vm._l((_vm.couponList),function(item,index){return _c('li',{key:index,staticClass:\"ns-bg-color ns-coupon-li\"},[_c('div',{staticClass:\"describe\"},[[(!item.discount || item.discount == '0.00')?_c('span',[_vm._v(\"￥\"+_vm._s(item.money))]):_c('span',[_vm._v(_vm._s(item.discount)+\"折\")])],_c('span',[_vm._v(_vm._s(_vm.activeName == 'first' ? item.coupon_name : item.platformcoupon_name))]),(_vm.activeName == 'first')?_c('span',[_vm._v(\"使用店铺：\"+_vm._s(item.site_name))]):_vm._e(),[(item.at_least == '0.00')?_c('span',[_vm._v(\"无门槛优惠券\")]):_c('span',[_vm._v(\"满\"+_vm._s(item.at_least)+\"可使用\")])],[(item.validity_type)?_c('span',{staticClass:\"coupon-wrap-time\"},[_vm._v(\"领取之日起\"+_vm._s(item.fixed_term)+\"日内有效\")]):_c('span',{staticClass:\"coupon-wrap-time\"},[_vm._v(\"有效期至\"+_vm._s(_vm.$timeStampTurnTime(item.end_time)))])]],2),_c('div',{staticClass:\"receive\"},[_c('a',{staticClass:\"ns-text-color\",on:{\"click\":function($event){return _vm.couponTap(item, index)}}},[(item.useState == 0)?_c('span',[_vm._v(\"立即领取\")]):_c('span',[_vm._v(\"去使用\")])])])])}),0),(_vm.couponList.length <= 0)?_c('div',{staticClass:\"empty-wrap\"},[_c('div',{staticClass:\"ns-text-align\"},[_vm._v(\"暂无优惠券\")])]):_vm._e(),_c('div',{staticClass:\"pager\"},[_c('el-pagination',{attrs:{\"background\":\"\",\"pager-count\":5,\"total\":_vm.total,\"prev-text\":\"上一页\",\"next-text\":\"下一页\",\"current-page\":_vm.currentPage,\"page-size\":_vm.pageSize,\"hide-on-single-page\":\"\"},on:{\"update:currentPage\":function($event){_vm.currentPage=$event},\"update:current-page\":function($event){_vm.currentPage=$event},\"update:pageSize\":function($event){_vm.pageSize=$event},\"update:page-size\":function($event){_vm.pageSize=$event},\"size-change\":_vm.handlePageSizeChange,\"current-change\":_vm.handleCurrentPageChange}})],1)])],1)],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"coupon-name\"},[_c('span',{staticClass:\"ns-text-color\"},[_vm._v(\"优惠券中心\")]),_c('span',{staticClass:\"ns-text-color-gray text12\"},[_vm._v(\"省钱更多，领券更多\")])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('ul',{staticClass:\"coupon-type clear-float\"},[_c('li',[_c('i'),_c('span',[_vm._v(\"限时抢券\")])]),_c('li',[_c('i'),_c('span',[_vm._v(\"叠加使用\")])]),_c('li',[_c('i'),_c('span',[_vm._v(\"种类多样\")])])])\n}]\n\nexport { render, staticRenderFns }","<template>\r\n\t<div class=\"ns-coupon\">\r\n\t\t<div class=\"ns-coupon-info\">\r\n\t\t\t<div class=\"ns-coupon-wrap\">\r\n\t\t\t\t<div class=\"coupon-name\">\r\n\t\t\t\t\t<span class=\"ns-text-color\">优惠券中心</span>\r\n\t\t\t\t\t<span class=\"ns-text-color-gray text12\">省钱更多，领券更多</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<ul class=\"coupon-type clear-float\">\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<i></i>\r\n\t\t\t\t\t\t<span>限时抢券</span>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<i></i>\r\n\t\t\t\t\t\t<span>叠加使用</span>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<i></i>\r\n\t\t\t\t\t\t<span>种类多样</span>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t\t<el-button @click=\"myCoupon\">我的优惠券</el-button>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"ns-coupon-img\" v-loading=\"loadingAd\">\r\n\t\t\t\t<el-carousel height=\"406px\">\r\n\t\t\t\t\t<el-carousel-item v-for=\"item in adList\" :key=\"item.adv_id\">\r\n\t\t\t\t\t\t<el-image :src=\"$img(item.adv_image)\" fit=\"cover\" @click=\"$router.pushToTab(item.adv_url.url)\" />\r\n\t\t\t\t\t</el-carousel-item>\r\n\t\t\t\t</el-carousel>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\r\n\t\t\t<el-tab-pane label=\"店铺优惠券\" name=\"first\"></el-tab-pane>\r\n\t\t\t<el-tab-pane label=\"平台优惠券\" name=\"second\"></el-tab-pane>\r\n\r\n\t\t\t<div v-loading=\"loading\">\r\n\t\t\t\t<ul class=\"ns-coupon-list\">\r\n\t\t\t\t\t<li class=\"ns-bg-color ns-coupon-li\" v-for=\"(item, index) in couponList\" :key=\"index\">\r\n\t\t\t\t\t\t<div class=\"describe\">\r\n\t\t\t\t\t\t\t<template>\r\n\t\t\t\t\t\t\t\t<span v-if=\"!item.discount || item.discount == '0.00'\">￥{{ item.money }}</span>\r\n\t\t\t\t\t\t\t\t<span v-else>{{ item.discount }}折</span>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<span>{{ activeName == 'first' ? item.coupon_name : item.platformcoupon_name }}</span>\r\n\t\t\t\t\t\t\t<span v-if=\"activeName == 'first'\">使用店铺：{{ item.site_name }}</span>\r\n\t\t\t\t\t\t\t<template>\r\n\t\t\t\t\t\t\t\t<span v-if=\"item.at_least == '0.00'\">无门槛优惠券</span>\r\n\t\t\t\t\t\t\t\t<span v-else>满{{ item.at_least }}可使用</span>\r\n\t\t\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t\t\t<template>\r\n\t\t\t\t\t\t\t\t<span class=\"coupon-wrap-time\" v-if=\"item.validity_type\">领取之日起{{ item.fixed_term }}日内有效</span>\r\n\t\t\t\t\t\t\t\t<span class=\"coupon-wrap-time\" v-else>有效期至{{ $timeStampTurnTime(item.end_time) }}</span>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"receive\">\r\n\t\t\t\t\t\t\t<!-- 如果限领数为0 或者 领取数小于最大领取数 -->\r\n\t\t\t\t\t\t\t<a class=\"ns-text-color\" @click=\"couponTap(item, index)\">\r\n\t\t\t\t\t\t\t\t<span v-if=\"item.useState == 0\">立即领取</span>\r\n\t\t\t\t\t\t\t\t<span v-else>去使用</span>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t\t\r\n\t\t\t\t<div class=\"empty-wrap\" v-if=\"couponList.length <= 0\">\r\n\t\t\t\t\t<div class=\"ns-text-align\">暂无优惠券</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"pager\">\r\n\t\t\t\t\t<el-pagination\r\n\t\t\t\t\t\tbackground \r\n\t\t\t\t\t\t:pager-count=\"5\" \r\n\t\t\t\t\t\t:total=\"total\" \r\n\t\t\t\t\t\tprev-text=\"上一页\" \r\n\t\t\t\t\t\tnext-text=\"下一页\" \r\n\t\t\t\t\t\t:current-page.sync=\"currentPage\" \r\n\t\t\t\t\t\t:page-size.sync=\"pageSize\" \r\n\t\t\t\t\t\t@size-change=\"handlePageSizeChange\" \r\n\t\t\t\t\t\t@current-change=\"handleCurrentPageChange\" \r\n\t\t\t\t\t\thide-on-single-page\r\n\t\t\t\t\t></el-pagination>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</el-tabs>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { couponList, receiveCoupon } from '@/api/coupon';\r\nimport { mapGetters } from 'vuex';\r\nimport { adList } from '@/api/website';\r\n\r\nexport default {\r\n\tname: 'coupon',\r\n\tcomponents: {},\r\n\tdata: () => {\r\n\t\treturn {\r\n\t\t\tcouponList: [],\r\n\t\t\ttotal: 0,\r\n\t\t\tcurrentPage: 1,\r\n\t\t\tpageSize: 9,\r\n\t\t\tcouponBtnSwitch: false,\r\n\t\t\tactiveName: 'first',\r\n\t\t\tloading: true,\r\n\t\t\tloadingAd: true,\r\n\t\t\tadList: []\r\n\t\t};\r\n\t},\r\n\tcreated() {\r\n\t\tif (this.addonIsExit && this.addonIsExit.coupon != 1) {\r\n\t\t\tthis.$message({\r\n\t\t\t\tmessage: '优惠券插件未安装',\r\n\t\t\t\ttype: 'warning',\r\n\t\t\t\tduration: 2000,\r\n\t\t\t\tonClose: () => {\r\n\t\t\t\t\tthis.$route.push('/');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.getAdList();\r\n\t\t\tthis.getCanReceiveCouponQuery();\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['addonIsExit'])\r\n\t},\r\n\twatch: {\r\n\t\taddonIsExit() {\r\n\t\t\tif (this.addonIsExit.coupon != 1) {\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\tmessage: '优惠券插件未安装',\r\n\t\t\t\t\ttype: 'warning',\r\n\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\tonClose: () => {\r\n\t\t\t\t\t\tthis.$route.push('/');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tgetAdList() {\r\n\t\t\tadList({ keyword: 'NS_PC_COUPON' })\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tthis.adList = res.data.adv_list;\r\n\t\t\t\t\tfor (let i = 0; i < this.adList.length; i++) {\r\n\t\t\t\t\t\tif (this.adList[i].adv_url) this.adList[i].adv_url = JSON.parse(this.adList[i].adv_url);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.loadingAd = false;\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tthis.loadingAd = false;\r\n\t\t\t\t});\r\n\t\t},\r\n\t\thandleClick(tab, event) {\r\n\t\t\tthis.loading = true;\r\n\t\t\t(this.currentPage = 1), this.getCanReceiveCouponQuery();\r\n\t\t},\r\n\t\t/**\r\n\t\t * 我的优惠券\r\n\t\t */\r\n\t\tmyCoupon() {\r\n\t\t\tthis.$router.pushToTab('/member/my_coupon');\r\n\t\t},\r\n\t\t/**\r\n\t\t * 获取优惠券列表\r\n\t\t */\r\n\t\tgetCanReceiveCouponQuery() {\r\n\t\t\tcouponList({\r\n\t\t\t\tpage: this.currentPage,\r\n\t\t\t\tpage_size: this.pageSize,\r\n\t\t\t\tactiveName: this.activeName\r\n\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tthis.couponList = res.data.list;\r\n\t\t\t\t\tthis.total = res.data.count;\r\n\t\t\t\t\tthis.couponList.forEach(v => {\r\n\t\t\t\t\t\tv.useState = 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t\tthis.$message.error(err.message);\r\n\t\t\t\t});\r\n\t\t},\r\n\t\thandlePageSizeChange(size) {\r\n\t\t\tthis.pageSize = size;\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.getCanReceiveCouponQuery();\r\n\t\t},\r\n\t\thandleCurrentPageChange(page) {\r\n\t\t\tthis.currentPage = page;\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.getCanReceiveCouponQuery();\r\n\t\t},\r\n\t\t/**\r\n\t\t * 点击优惠券\r\n\t\t */\r\n\t\tcouponTap(item, index) {\r\n\t\t\tif (item.useState == 0) this.receiveCoupon(item, index);\r\n\t\t\telse this.toGoodsList(item);\r\n\t\t},\r\n\t\t/**\r\n\t\t * 领取优惠券\r\n\t\t */\r\n\t\treceiveCoupon(item, index) {\r\n\t\t\tif (this.couponBtnSwitch) return;\r\n\t\t\tthis.couponBtnSwitch = true;\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tsite_id: item.site_id,\r\n\t\t\t\tactiveName: this.activeName\r\n\t\t\t};\r\n\t\t\tif (this.activeName == 'first') {\r\n\t\t\t\tdata.coupon_type_id = item.coupon_type_id;\r\n\t\t\t} else {\r\n\t\t\t\tdata.platformcoupon_type_id = item.platformcoupon_type_id;\r\n\t\t\t}\r\n\r\n\t\t\treceiveCoupon(data)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tvar data = res.data;\r\n\t\t\t\t\tlet msg = res.message;\r\n\t\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\t\tmsg = '领取成功';\r\n\t\t\t\t\t\tthis.$message({ message: msg, type: 'success' });\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message({ message: msg, type: 'warning' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet list = this.couponList;\r\n\t\t\t\t\tif (res.data.is_exist == 1) {\r\n\t\t\t\t\t\tfor (let i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\tif (this.activeName == 'first') {\r\n\t\t\t\t\t\t\t\tif (list[i].coupon_type_id == item.coupon_type_id) {\r\n\t\t\t\t\t\t\t\t\tlist[i].useState = 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (list[i].platformcoupon_type_id == item.platformcoupon_type_id) {\r\n\t\t\t\t\t\t\t\t\tlist[i].useState = 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tfor (let i = 0; i < list.length; i++) {\r\n\t\t\t\t\t\t\tif (this.activeName == 'first') {\r\n\t\t\t\t\t\t\t\tif (list[i].coupon_type_id == item.coupon_type_id) {\r\n\t\t\t\t\t\t\t\t\tlist[i].useState = 2;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (list[i].platformcoupon_type_id == item.platformcoupon_type_id) {\r\n\t\t\t\t\t\t\t\t\tlist[i].useState = 2;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.couponBtnSwitch = false;\r\n\t\t\t\t\tthis.$forceUpdate();\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tif (err.message == 'token不存在') {\r\n\t\t\t\t\t\tthis.$router.pushToTab('/login')\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message.error(err.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.couponBtnSwitch = false;\r\n\t\t\t\t});\r\n\t\t},\r\n\t\t/**\r\n\t\t * 去购买\r\n\t\t */\r\n\t\ttoGoodsList(item) {\r\n\t\t\tif (this.activeName == 'first') {\r\n\t\t\t\tif (item.goods_type != 1) {\r\n\t\t\t\t\tthis.$router.push({ path: '/shop_list', query: { site_id: item.site_id, couponId: item.coupon_type_id } });\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$router.push({ path: '/shop_list', query: { site_id: item.site_id } });\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (item.use_scenario != 1) {\r\n\t\t\t\t\tthis.$router.push({ path: '/list', query: { platformcouponTypeId: item.platformcoupon_type_id } });\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$router.push('/list');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.empty-wrap {\r\n\tmargin-top: 20px;\r\n}\r\n\r\n.ns-coupon {\r\n\twidth: 100%;\r\n\tpadding: 20px;\r\n\tbox-sizing: border-box;\r\n}\r\n\r\n.ns-coupon-info {\r\n\tbackground: url(../../assets/images/coupon-bg.png) no-repeat;\r\n\tbackground-size: cover;\r\n\twidth: 100%;\r\n\theight: 450px;\r\n\tdisplay: flex;\r\n\r\n\t.ns-coupon-wrap {\r\n\t\twidth: 320px;\r\n\t\tpadding: 20px;\r\n\t\tbox-sizing: border-box;\r\n\t\ttext-align: center;\r\n\r\n\t\t.coupon-name {\r\n\t\t\tmargin: 45px 0 50px;\r\n\r\n\t\t\tspan:nth-child(1) {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tline-height: 45px;\r\n\t\t\t\tfont-size: 30px;\r\n\t\t\t}\r\n\r\n\t\t\t.ns-text-color-gray {\r\n\t\t\t\tcolor: #898989 !important;\r\n\t\t\t}\r\n\t\t\t.text12 {\r\n\t\t\t\tfont-size: 12px;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.coupon-type {\r\n\t\t\tmargin-left: 20px;\r\n\t\t\tli {\r\n\t\t\t\tfloat: left;\r\n\t\t\t\twidth: 80px;\r\n\t\t\t\theight: 100px;\r\n\r\n\t\t\t\ti {\r\n\t\t\t\t\tdisplay: block;\r\n\t\t\t\t\twidth: 50px;\r\n\t\t\t\t\theight: 50px;\r\n\t\t\t\t\tmargin: 8px auto;\r\n\t\t\t\t}\r\n\t\t\t\t&:nth-child(1) i {\r\n\t\t\t\t\tbackground: url(../../assets/images/limited_time.png) no-repeat center;\r\n\t\t\t\t}\r\n\t\t\t\t&:nth-child(2) i {\r\n\t\t\t\t\tbackground: url(../../assets/images/superposition.png) no-repeat center;\r\n\t\t\t\t}\r\n\t\t\t\t&:nth-child(3) i {\r\n\t\t\t\t\tbackground: url(../../assets/images/coupon_type.png) no-repeat center;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t.el-button {\r\n\t\t\twidth: 200px;\r\n\t\t\tbackground-color: $base-color;\r\n\t\t\tcolor: #fff;\r\n\t\t\tmargin-top: 70px;\r\n\t\t\tfont-size: 18px;\r\n\t\t}\r\n\t}\r\n\r\n\t.ns-coupon-img {\r\n\t\twidth: 850px;\r\n\t\tpadding: 20px;\r\n\t\tbox-sizing: border-box;\r\n\r\n\t\timg {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 100%;\r\n\t\t}\r\n\r\n\t\t.el-carousel__item:nth-child(2n) {\r\n\t\t\tbackground-color: #99a9bf;\r\n\t\t}\r\n\r\n\t\t.el-carousel__item:nth-child(2n + 1) {\r\n\t\t\tbackground-color: #d3dce6;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.el-tabs {\r\n\tmargin-top: 20px;\r\n}\r\n\r\n.ns-coupon-list {\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\tpadding: 0 20px;\r\n\t.ns-coupon-li {\r\n\t\tbackground: url(../../assets/images/list_bj.png) no-repeat;\r\n\t\twidth: 32%;\r\n\t\theight: 169px;\r\n\t\tmargin-bottom: 20px;\r\n\t\tmargin-right: 2%;\r\n\t\tbackground-size: cover;\r\n\r\n\t\t.describe {\r\n\t\t\tfloat: left;\r\n\t\t\twidth: 250px;\r\n\t\t\theight: inherit;\r\n\t\t\ttext-align: center;\r\n\t\t\tcolor: #fff;\r\n\t\t\tspan {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\t\t\tspan:nth-child(1) {\r\n\t\t\t\tfont-size: 40px;\r\n\t\t\t\tmargin-top: 20px;\r\n\t\t\t\tmargin-bottom: 3px;\r\n\t\t\t\tline-height: 50px;\r\n\t\t\t}\r\n\t\t\tspan:nth-child(3),\r\n\t\t\tspan:nth-child(4),\r\n\t\t\tspan:nth-child(5) {\r\n\t\t\t\tfont-size: 12px;\r\n\t\t\t\tmargin-left: 15px;\r\n\t\t\t\tline-height: 20px;\r\n\t\t\t}\r\n\t\t}\r\n\t\t.receive {\r\n\t\t\tfloat: right;\r\n\t\t\twidth: 95px;\r\n\t\t\theight: inherit;\r\n\t\t\ttext-align: center;\r\n\t\t\ta {\r\n\t\t\t\tdisplay: inline-block;\r\n\t\t\t\twidth: 30px;\r\n\t\t\t\theight: 120px;\r\n\t\t\t\tline-height: 120px;\r\n\t\t\t\tpadding: 0 5px;\r\n\t\t\t\tmargin-top: 25px;\r\n\t\t\t\tbackground-color: #fff;\r\n\t\t\t\tborder-radius: 15px;\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\tspan {\r\n\t\t\t\t\tdisplay: inline-block;\r\n\t\t\t\t\tline-height: 20px;\r\n\t\t\t\t\tvertical-align: middle;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t&:nth-child(3n) {\r\n\t\t\tmargin-right: 0;\r\n\t\t}\r\n\t}\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./coupon.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./coupon.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./coupon.vue?vue&type=template&id=568b56a8&scoped=true\"\nimport script from \"./coupon.vue?vue&type=script&lang=js\"\nexport * from \"./coupon.vue?vue&type=script&lang=js\"\nimport style0 from \"./coupon.vue?vue&type=style&index=0&id=568b56a8&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"568b56a8\",\n  null\n  \n)\n\nexport default component.exports","import http from \"../utils/http\"\r\n\r\n/**\r\n * 优惠券类型列表\r\n * @param {object} params\r\n */\r\nexport function couponTypeList(params) {\r\n    return http({\r\n        url: \"/coupon/api/coupon/typelists\",\r\n        data: params\r\n    })\r\n}\r\n\r\n/**\r\n * 领取优惠券\r\n * @param {object} params\r\n */\r\nexport function couponReceive(params) {\r\n    return http({\r\n        url: \"/coupon/api/coupon/receive\",\r\n        data: params,\r\n        forceLogin: true\r\n    })\r\n}\r\n\r\n/**\r\n * 领券中心优惠券列表\r\n */\r\nexport function couponList(params) {\r\n    let url = \"\"\r\n    if (params.activeName == \"first\") {\r\n        url = \"/coupon/api/coupon/typepagelists\"\r\n    } else {\r\n        url = \"/platformcoupon/api/platformcoupon/typepagelists\"\r\n    }\r\n    return http({\r\n        url: url,\r\n        data: params\r\n    })\r\n}\r\n\r\n/**\r\n * 领取优惠券店铺端\r\n */\r\nexport function receiveCoupon(params) {\r\n    let url = \"\"\r\n    if (params.activeName == \"first\") {\r\n        url = \"/coupon/api/coupon/receive\"\r\n    } else {\r\n        url = \"/platformcoupon/api/platformcoupon/receive\"\r\n    }\r\n    return http({\r\n        url: url,\r\n        data: params,\r\n        forceLogin: true\r\n    })\r\n}\r\n"],"sourceRoot":""}